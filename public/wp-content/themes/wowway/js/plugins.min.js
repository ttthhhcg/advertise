$ = jQuery.noConflict();
/*!
 * MediaElement.js
 * HTML5 <video> and <audio> shim and player
 * http://mediaelementjs.com/
 *
 * Creates a JavaScript object that mimics HTML5 MediaElement API
 * for browsers that don't understand HTML5 or can't play the provided codec
 * Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
 *
 * Copyright 2010-2012, John Dyer (http://j.hn)
 * License: MIT
 *
 */
var mejs = mejs || {};
mejs.version = "2.10.3";
mejs.meIndex = 0;
mejs.plugins = {
    silverlight: [{
        version: [3, 0],
        types: ["video/mp4", "video/m4v", "video/mov", "video/wmv", "audio/wma", "audio/m4a", "audio/mp3", "audio/wav", "audio/mpeg"]
    }],
    flash: [{
        version: [9, 0, 124],
        types: ["video/mp4", "video/m4v", "video/mov", "video/flv", "video/rtmp", "video/x-flv", "audio/flv", "audio/x-flv", "audio/mp3", "audio/m4a", "audio/mpeg", "video/youtube", "video/x-youtube"]
    }],
    youtube: [{
        version: null,
        types: ["video/youtube", "video/x-youtube"]
    }],
    vimeo: [{
        version: null,
        types: ["video/vimeo", "video/x-vimeo"]
    }]
};
mejs.Utility = {
    encodeUrl: function (a) {
        return encodeURIComponent(a)
    },
    escapeHTML: function (a) {
        return a.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")
    },
    absolutizeUrl: function (a) {
        var b = document.createElement("div");
        b.innerHTML = '<a href="' + this.escapeHTML(a) + '">x</a>';
        return b.firstChild.href
    },
    getScriptPath: function (a) {
        for (var b = 0, c, d = "", e = "", g, f = document.getElementsByTagName("script"), h = f.length, l = a.length; b < h; b++) {
            g = f[b].src;
            for (c = 0; c < l; c++) {
                e = a[c];
                if (g.indexOf(e) > -1) {
                    d = g.substring(0, g.indexOf(e));
                    break
                }
            }
            if (d !== "") break
        }
        return d
    },
    secondsToTimeCode: function (a, b, c, d) {
        if (typeof c == "undefined") c = false;
        else if (typeof d == "undefined") d = 25;
        var e = Math.floor(a / 3600) % 24,
            g = Math.floor(a / 60) % 60,
            f = Math.floor(a % 60);
        a = Math.floor((a % 1 * d).toFixed(3));
        return (b || e > 0 ? (e < 10 ? "0" + e : e) + ":" : "") + (g < 10 ? "0" + g : g) + ":" + (f < 10 ? "0" + f : f) + (c ? ":" + (a < 10 ? "0" + a : a) : "")
    },
    timeCodeToSeconds: function (a, b, c, d) {
        if (typeof c == "undefined") c = false;
        else if (typeof d == "undefined") d = 25;
        a = a.split(":");
        b = parseInt(a[0],
            10);
        var e = parseInt(a[1], 10),
            g = parseInt(a[2], 10),
            f = 0,
            h = 0;
        if (c) f = parseInt(a[3]) / d;
        return h = b * 3600 + e * 60 + g + f
    },
    convertSMPTEtoSeconds: function (a) {
        if (typeof a != "string") return false;
        a = a.replace(",", ".");
        var b = 0,
            c = a.indexOf(".") != -1 ? a.split(".")[1].length : 0,
            d = 1;
        a = a.split(":").reverse();
        for (var e = 0; e < a.length; e++) {
            d = 1;
            if (e > 0) d = Math.pow(60, e);
            b += Number(a[e]) * d
        }
        return Number(b.toFixed(c))
    },
    removeSwf: function (a) {
        var b = document.getElementById(a);
        if (b && b.nodeName == "OBJECT")
            if (mejs.MediaFeatures.isIE) {
                b.style.display =
                    "none";
                (function () {
                    b.readyState == 4 ? mejs.Utility.removeObjectInIE(a) : setTimeout(arguments.callee, 10)
                })()
            } else b.parentNode.removeChild(b)
    },
    removeObjectInIE: function (a) {
        if (a = document.getElementById(a)) {
            for (var b in a)
                if (typeof a[b] == "function") a[b] = null;
            a.parentNode.removeChild(a)
        }
    }
};
mejs.PluginDetector = {
    hasPluginVersion: function (a, b) {
        var c = this.plugins[a];
        b[1] = b[1] || 0;
        b[2] = b[2] || 0;
        return c[0] > b[0] || c[0] == b[0] && c[1] > b[1] || c[0] == b[0] && c[1] == b[1] && c[2] >= b[2] ? true : false
    },
    nav: window.navigator,
    ua: window.navigator.userAgent.toLowerCase(),
    plugins: [],
    addPlugin: function (a, b, c, d, e) {
        this.plugins[a] = this.detectPlugin(b, c, d, e)
    },
    detectPlugin: function (a, b, c, d) {
        var e = [0, 0, 0],
            g;
        if (typeof this.nav.plugins != "undefined" && typeof this.nav.plugins[a] == "object") {
            if ((c = this.nav.plugins[a].description) && !(typeof this.nav.mimeTypes != "undefined" && this.nav.mimeTypes[b] && !this.nav.mimeTypes[b].enabledPlugin)) {
                e = c.replace(a, "").replace(/^\s+/, "").replace(/\sr/gi, ".").split(".");
                for (a = 0; a < e.length; a++) e[a] = parseInt(e[a].match(/\d+/), 10)
            }
        } else if (typeof window.ActiveXObject != "undefined") try {
            if (g = new ActiveXObject(c)) e = d(g)
        } catch (f) {}
        return e
    }
};
mejs.PluginDetector.addPlugin("flash", "Shockwave Flash", "application/x-shockwave-flash", "ShockwaveFlash.ShockwaveFlash", function (a) {
    var b = [];
    if (a = a.GetVariable("$version")) {
        a = a.split(" ")[1].split(",");
        b = [parseInt(a[0], 10), parseInt(a[1], 10), parseInt(a[2], 10)]
    }
    return b
});
mejs.PluginDetector.addPlugin("silverlight", "Silverlight Plug-In", "application/x-silverlight-2", "AgControl.AgControl", function (a) {
    var b = [0, 0, 0, 0],
        c = function (d, e, g, f) {
            for (; d.isVersionSupported(e[0] + "." + e[1] + "." + e[2] + "." + e[3]);) e[g] += f;
            e[g] -= f
        };
    c(a, b, 0, 1);
    c(a, b, 1, 1);
    c(a, b, 2, 1E4);
    c(a, b, 2, 1E3);
    c(a, b, 2, 100);
    c(a, b, 2, 10);
    c(a, b, 2, 1);
    c(a, b, 3, 1);
    return b
});
mejs.MediaFeatures = {
    init: function () {
        var a = this,
            b = document,
            c = mejs.PluginDetector.nav,
            d = mejs.PluginDetector.ua.toLowerCase(),
            e, g = ["source", "track", "audio", "video"];
        a.isiPad = d.match(/ipad/i) !== null;
        a.isiPhone = d.match(/iphone/i) !== null;
        a.isiOS = a.isiPhone || a.isiPad;
        a.isAndroid = d.match(/android/i) !== null;
        a.isBustedAndroid = d.match(/android 2\.[12]/) !== null;
        a.isIE = c.appName.toLowerCase().indexOf("microsoft") != -1;
        a.isChrome = d.match(/chrome/gi) !== null;
        a.isFirefox = d.match(/firefox/gi) !== null;
        a.isWebkit = d.match(/webkit/gi) !==
            null;
        a.isGecko = d.match(/gecko/gi) !== null && !a.isWebkit;
        a.isOpera = d.match(/opera/gi) !== null;
        a.hasTouch = "ontouchstart" in window;
        a.svg = !! document.createElementNS && !! document.createElementNS("http://www.w3.org/2000/svg", "svg").createSVGRect;
        for (c = 0; c < g.length; c++) e = document.createElement(g[c]);
        a.supportsMediaTag = typeof e.canPlayType !== "undefined" || a.isBustedAndroid;
        a.hasSemiNativeFullScreen = typeof e.webkitEnterFullscreen !== "undefined";
        a.hasWebkitNativeFullScreen = typeof e.webkitRequestFullScreen !== "undefined";
        a.hasMozNativeFullScreen = typeof e.mozRequestFullScreen !== "undefined";
        a.hasTrueNativeFullScreen = a.hasWebkitNativeFullScreen || a.hasMozNativeFullScreen;
        a.nativeFullScreenEnabled = a.hasTrueNativeFullScreen;
        if (a.hasMozNativeFullScreen) a.nativeFullScreenEnabled = e.mozFullScreenEnabled;
        if (this.isChrome) a.hasSemiNativeFullScreen = false;
        if (a.hasTrueNativeFullScreen) {
            a.fullScreenEventName = a.hasWebkitNativeFullScreen ? "webkitfullscreenchange" : "mozfullscreenchange";
            a.isFullScreen = function () {
                if (e.mozRequestFullScreen) return b.mozFullScreen;
                else if (e.webkitRequestFullScreen) return b.webkitIsFullScreen
            };
            a.requestFullScreen = function (f) {
                if (a.hasWebkitNativeFullScreen) f.webkitRequestFullScreen();
                else a.hasMozNativeFullScreen && f.mozRequestFullScreen()
            };
            a.cancelFullScreen = function () {
                if (a.hasWebkitNativeFullScreen) document.webkitCancelFullScreen();
                else a.hasMozNativeFullScreen && document.mozCancelFullScreen()
            }
        }
        if (a.hasSemiNativeFullScreen && d.match(/mac os x 10_5/i)) {
            a.hasNativeFullScreen = false;
            a.hasSemiNativeFullScreen = false
        }
    }
};
mejs.MediaFeatures.init();
mejs.HtmlMediaElement = {
    pluginType: "native",
    isFullScreen: false,
    setCurrentTime: function (a) {
        this.currentTime = a
    },
    setMuted: function (a) {
        this.muted = a
    },
    setVolume: function (a) {
        this.volume = a
    },
    stop: function () {
        this.pause()
    },
    setSrc: function (a) {
        for (var b = this.getElementsByTagName("source"); b.length > 0;) this.removeChild(b[0]);
        if (typeof a == "string") this.src = a;
        else {
            var c;
            for (b = 0; b < a.length; b++) {
                c = a[b];
                if (this.canPlayType(c.type)) {
                    this.src = c.src;
                    break
                }
            }
        }
    },
    setVideoSize: function (a, b) {
        this.width = a;
        this.height = b
    }
};
mejs.PluginMediaElement = function (a, b, c) {
    this.id = a;
    this.pluginType = b;
    this.src = c;
    this.events = {};
    this.attributes = {}
};
mejs.PluginMediaElement.prototype = {
    pluginElement: null,
    pluginType: "",
    isFullScreen: false,
    playbackRate: -1,
    defaultPlaybackRate: -1,
    seekable: [],
    played: [],
    paused: true,
    ended: false,
    seeking: false,
    duration: 0,
    error: null,
    tagName: "",
    muted: false,
    volume: 1,
    currentTime: 0,
    play: function () {
        if (this.pluginApi != null) {
            this.pluginType == "youtube" ? this.pluginApi.playVideo() : this.pluginApi.playMedia();
            this.paused = false
        }
    },
    load: function () {
        if (this.pluginApi != null) {
            this.pluginType != "youtube" && this.pluginApi.loadMedia();
            this.paused =
                false
        }
    },
    pause: function () {
        if (this.pluginApi != null) {
            this.pluginType == "youtube" ? this.pluginApi.pauseVideo() : this.pluginApi.pauseMedia();
            this.paused = true
        }
    },
    stop: function () {
        if (this.pluginApi != null) {
            this.pluginType == "youtube" ? this.pluginApi.stopVideo() : this.pluginApi.stopMedia();
            this.paused = true
        }
    },
    canPlayType: function (a) {
        var b, c, d, e = mejs.plugins[this.pluginType];
        for (b = 0; b < e.length; b++) {
            d = e[b];
            if (mejs.PluginDetector.hasPluginVersion(this.pluginType, d.version))
                for (c = 0; c < d.types.length; c++)
                    if (a == d.types[c]) return true
        }
        return false
    },
    positionFullscreenButton: function (a, b, c) {
        this.pluginApi != null && this.pluginApi.positionFullscreenButton && this.pluginApi.positionFullscreenButton(a, b, c)
    },
    hideFullscreenButton: function () {
        this.pluginApi != null && this.pluginApi.hideFullscreenButton && this.pluginApi.hideFullscreenButton()
    },
    setSrc: function (a) {
        if (typeof a == "string") {
            this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(a));
            this.src = mejs.Utility.absolutizeUrl(a)
        } else {
            var b, c;
            for (b = 0; b < a.length; b++) {
                c = a[b];
                if (this.canPlayType(c.type)) {
                    this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(c.src));
                    this.src = mejs.Utility.absolutizeUrl(a);
                    break
                }
            }
        }
    },
    setCurrentTime: function (a) {
        if (this.pluginApi != null) {
            this.pluginType == "youtube" ? this.pluginApi.seekTo(a) : this.pluginApi.setCurrentTime(a);
            this.currentTime = a
        }
    },
    setVolume: function (a) {
        if (this.pluginApi != null) {
            this.pluginType == "youtube" ? this.pluginApi.setVolume(a * 100) : this.pluginApi.setVolume(a);
            this.volume = a
        }
    },
    setMuted: function (a) {
        if (this.pluginApi != null) {
            if (this.pluginType == "youtube") {
                a ? this.pluginApi.mute() : this.pluginApi.unMute();
                this.muted = a;
                this.dispatchEvent("volumechange")
            } else this.pluginApi.setMuted(a);
            this.muted = a
        }
    },
    setVideoSize: function (a, b) {
        if (this.pluginElement.style) {
            this.pluginElement.style.width = a + "px";
            this.pluginElement.style.height = b + "px"
        }
        this.pluginApi != null && this.pluginApi.setVideoSize && this.pluginApi.setVideoSize(a, b)
    },
    setFullscreen: function (a) {
        this.pluginApi != null && this.pluginApi.setFullscreen && this.pluginApi.setFullscreen(a)
    },
    enterFullScreen: function () {
        this.pluginApi != null && this.pluginApi.setFullscreen && this.setFullscreen(true)
    },
    exitFullScreen: function () {
        this.pluginApi != null && this.pluginApi.setFullscreen &&
            this.setFullscreen(false)
    },
    addEventListener: function (a, b) {
        this.events[a] = this.events[a] || [];
        this.events[a].push(b)
    },
    removeEventListener: function (a, b) {
        if (!a) {
            this.events = {};
            return true
        }
        var c = this.events[a];
        if (!c) return true;
        if (!b) {
            this.events[a] = [];
            return true
        }
        for (i = 0; i < c.length; i++)
            if (c[i] === b) {
                this.events[a].splice(i, 1);
                return true
            }
        return false
    },
    dispatchEvent: function (a) {
        var b, c, d = this.events[a];
        if (d) {
            c = Array.prototype.slice.call(arguments, 1);
            for (b = 0; b < d.length; b++) d[b].apply(null, c)
        }
    },
    hasAttribute: function (a) {
        return a in
            this.attributes
    },
    removeAttribute: function (a) {
        delete this.attributes[a]
    },
    getAttribute: function (a) {
        if (this.hasAttribute(a)) return this.attributes[a];
        return ""
    },
    setAttribute: function (a, b) {
        this.attributes[a] = b
    },
    remove: function () {
        mejs.Utility.removeSwf(this.pluginElement.id)
    }
};
mejs.MediaPluginBridge = {
    pluginMediaElements: {},
    htmlMediaElements: {},
    registerPluginElement: function (a, b, c) {
        this.pluginMediaElements[a] = b;
        this.htmlMediaElements[a] = c
    },
    initPlugin: function (a) {
        var b = this.pluginMediaElements[a],
            c = this.htmlMediaElements[a];
        if (b) {
            switch (b.pluginType) {
            case "flash":
                b.pluginElement = b.pluginApi = document.getElementById(a);
                break;
            case "silverlight":
                b.pluginElement = document.getElementById(b.id);
                b.pluginApi = b.pluginElement.Content.MediaElementJS
            }
            b.pluginApi != null && b.success && b.success(b,
                c)
        }
    },
    fireEvent: function (a, b, c) {
        var d, e;
        a = this.pluginMediaElements[a];
        b = {
            type: b,
            target: a
        };
        for (d in c) {
            a[d] = c[d];
            b[d] = c[d]
        }
        e = c.bufferedTime || 0;
        b.target.buffered = b.buffered = {
            start: function () {
                return 0
            },
            end: function () {
                return e
            },
            length: 1
        };
        a.dispatchEvent(b.type, b)
    }
};
mejs.MediaElementDefaults = {
    mode: "auto",
    plugins: ["flash", "silverlight", "youtube", "vimeo"],
    enablePluginDebug: false,
    type: "",
    pluginPath: mejs.Utility.getScriptPath(["mediaelement.js", "mediaelement.min.html", "mediaelement-and-player.html", "mediaelement-and-player.min.js"]),
    flashName: "flashmediaelement.swf",
    flashStreamer: "",
    enablePluginSmoothing: false,
    silverlightName: "silverlightmediaelement.xap",
    defaultVideoWidth: 480,
    defaultVideoHeight: 270,
    pluginWidth: -1,
    pluginHeight: -1,
    pluginVars: [],
    timerRate: 250,
    startVolume: 0.8,
    success: function () {},
    error: function () {}
};
mejs.MediaElement = function (a, b) {
    return mejs.HtmlMediaElementShim.create(a, b)
};
mejs.HtmlMediaElementShim = {
    create: function (a, b) {
        var c = mejs.MediaElementDefaults,
            d = typeof a == "string" ? document.getElementById(a) : a,
            e = d.tagName.toLowerCase(),
            g = e === "audio" || e === "video",
            f = g ? d.getAttribute("src") : d.getAttribute("href");
        e = d.getAttribute("poster");
        var h = d.getAttribute("autoplay"),
            l = d.getAttribute("preload"),
            j = d.getAttribute("controls"),
            k;
        for (k in b) c[k] = b[k];
        f = typeof f == "undefined" || f === null || f == "" ? null : f;
        e = typeof e == "undefined" || e === null ? "" : e;
        l = typeof l == "undefined" || l === null || l === "false" ?
            "none" : l;
        h = !(typeof h == "undefined" || h === null || h === "false");
        j = !(typeof j == "undefined" || j === null || j === "false");
        k = this.determinePlayback(d, c, mejs.MediaFeatures.supportsMediaTag, g, f);
        k.url = k.url !== null ? mejs.Utility.absolutizeUrl(k.url) : "";
        if (k.method == "native") {
            if (mejs.MediaFeatures.isBustedAndroid) {
                d.src = k.url;
                d.addEventListener("click", function () {
                    d.play()
                }, false)
            }
            return this.updateNative(k, c, h, l)
        } else if (k.method !== "") return this.createPlugin(k, c, e, h, l, j);
        else {
            this.createErrorMessage(k, c, e);
            return this
        }
    },
    determinePlayback: function (a, b, c, d, e) {
        var g = [],
            f, h, l, j = {
                method: "",
                url: "",
                htmlMediaElement: a,
                isVideo: a.tagName.toLowerCase() != "audio"
            }, k;
        if (typeof b.type != "undefined" && b.type !== "")
            if (typeof b.type == "string") g.push({
                type: b.type,
                url: e
            });
            else
                for (f = 0; f < b.type.length; f++) g.push({
                    type: b.type[f],
                    url: e
                });
            else if (e !== null) {
            l = this.formatType(e, a.getAttribute("type"));
            g.push({
                type: l,
                url: e
            })
        } else
            for (f = 0; f < a.childNodes.length; f++) {
                h = a.childNodes[f];
                if (h.nodeType == 1 && h.tagName.toLowerCase() == "source") {
                    e = h.getAttribute("src");
                    l = this.formatType(e, h.getAttribute("type"));
                    h = h.getAttribute("media");
                    if (!h || !window.matchMedia || window.matchMedia && window.matchMedia(h).matches) g.push({
                        type: l,
                        url: e
                    })
                }
            }
        if (!d && g.length > 0 && g[0].url !== null && this.getTypeFromFile(g[0].url).indexOf("audio") > -1) j.isVideo = false;
        if (mejs.MediaFeatures.isBustedAndroid) a.canPlayType = function (m) {
            return m.match(/video\/(mp4|m4v)/gi) !== null ? "maybe" : ""
        };
        if (c && (b.mode === "auto" || b.mode === "auto_plugin" || b.mode === "native")) {
            if (!d) {
                f = document.createElement(j.isVideo ?
                    "video" : "audio");
                a.parentNode.insertBefore(f, a);
                a.style.display = "none";
                j.htmlMediaElement = a = f
            }
            for (f = 0; f < g.length; f++)
                if (a.canPlayType(g[f].type).replace(/no/, "") !== "" || a.canPlayType(g[f].type.replace(/mp3/, "mpeg")).replace(/no/, "") !== "") {
                    j.method = "native";
                    j.url = g[f].url;
                    break
                }
            if (j.method === "native") {
                if (j.url !== null) a.src = j.url;
                if (b.mode !== "auto_plugin") return j
            }
        }
        if (b.mode === "auto" || b.mode === "auto_plugin" || b.mode === "shim")
            for (f = 0; f < g.length; f++) {
                l = g[f].type;
                for (a = 0; a < b.plugins.length; a++) {
                    e = b.plugins[a];
                    h = mejs.plugins[e];
                    for (c = 0; c < h.length; c++) {
                        k = h[c];
                        if (k.version == null || mejs.PluginDetector.hasPluginVersion(e, k.version))
                            for (d = 0; d < k.types.length; d++)
                                if (l == k.types[d]) {
                                    j.method = e;
                                    j.url = g[f].url;
                                    return j
                                }
                    }
                }
            }
        if (b.mode === "auto_plugin" && j.method === "native") return j;
        if (j.method === "" && g.length > 0) j.url = g[0].url;
        return j
    },
    formatType: function (a, b) {
        return a && !b ? this.getTypeFromFile(a) : b && ~b.indexOf(";") ? b.substr(0, b.indexOf(";")) : b
    },
    getTypeFromFile: function (a) {
        a = a.split("?")[0];
        a = a.substring(a.lastIndexOf(".") +
            1);
        return (/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(a) ? "video" : "audio") + "/" + this.getTypeFromExtension(a)
    },
    getTypeFromExtension: function (a) {
        switch (a) {
        case "mp4":
        case "m4v":
            return "mp4";
        case "webm":
        case "webma":
        case "webmv":
            return "webm";
        case "ogg":
        case "oga":
        case "ogv":
            return "ogg";
        default:
            return a
        }
    },
    createErrorMessage: function (a, b, c) {
        var d = a.htmlMediaElement,
            e = document.createElement("div");
        e.className = "me-cannotplay";
        try {
            e.style.width = d.width + "px";
            e.style.height = d.height + "px"
        } catch (g) {}
        e.innerHTML =
            c !== "" ? '<a href="' + a.url + '"><img src="' + c + '" width="100%" height="100%" /></a>' : '<a href="' + a.url + '"><span>' + mejs.i18n.t("Download File") + "</span></a>";
        d.parentNode.insertBefore(e, d);
        d.style.display = "none";
        b.error(d)
    },
    createPlugin: function (a, b, c, d, e, g) {
        c = a.htmlMediaElement;
        var f = 1,
            h = 1,
            l = "me_" + a.method + "_" + mejs.meIndex++,
            j = new mejs.PluginMediaElement(l, a.method, a.url),
            k = document.createElement("div"),
            m;
        j.tagName = c.tagName;
        for (m = 0; m < c.attributes.length; m++) {
            var n = c.attributes[m];
            n.specified == true && j.setAttribute(n.name,
                n.value)
        }
        for (m = c.parentNode; m !== null && m.tagName.toLowerCase() != "body";) {
            if (m.parentNode.tagName.toLowerCase() == "p") {
                m.parentNode.parentNode.insertBefore(m, m.parentNode);
                break
            }
            m = m.parentNode
        }
        if (a.isVideo) {
            f = b.videoWidth > 0 ? b.videoWidth : c.getAttribute("width") !== null ? c.getAttribute("width") : b.defaultVideoWidth;
            h = b.videoHeight > 0 ? b.videoHeight : c.getAttribute("height") !== null ? c.getAttribute("height") : b.defaultVideoHeight;
            f = mejs.Utility.encodeUrl(f);
            h = mejs.Utility.encodeUrl(h)
        } else if (b.enablePluginDebug) {
            f =
                320;
            h = 240
        }
        j.success = b.success;
        mejs.MediaPluginBridge.registerPluginElement(l, j, c);
        k.className = "me-plugin";
        k.id = l + "_container";
        a.isVideo ? c.parentNode.insertBefore(k, c) : document.body.insertBefore(k, document.body.childNodes[0]);
        d = ["id=" + l, "isvideo=" + (a.isVideo ? "true" : "false"), "autoplay=" + (d ? "true" : "false"), "preload=" + e, "width=" + f, "startvolume=" + b.startVolume, "timerrate=" + b.timerRate, "flashstreamer=" + b.flashStreamer, "height=" + h];
        if (a.url !== null) a.method == "flash" ? d.push("file=" + mejs.Utility.encodeUrl(a.url)) :
            d.push("file=" + a.url);
        b.enablePluginDebug && d.push("debug=true");
        b.enablePluginSmoothing && d.push("smoothing=true");
        g && d.push("controls=true");
        if (b.pluginVars) d = d.concat(b.pluginVars);
        switch (a.method) {
        case "silverlight":
            k.innerHTML = '<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="' + l + '" name="' + l + '" width="' + f + '" height="' + h + '"><param name="initParams" value="' + d.join(",") + '" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="' +
                b.pluginPath + b.silverlightName + '" /></object>';
            break;
        case "flash":
            if (mejs.MediaFeatures.isIE) {
                a = document.createElement("div");
                k.appendChild(a);
                a.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="' + l + '" width="' + f + '" height="' + h + '"><param name="movie" value="' + b.pluginPath + b.flashName + "?x=" + new Date + '" /><param name="flashvars" value="' + d.join("&amp;") + '" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'
            } else k.innerHTML =
                '<embed id="' + l + '" name="' + l + '" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="' + b.pluginPath + b.flashName + '" flashvars="' + d.join("&") + '" width="' + f + '" height="' + h + '"></embed>';
            break;
        case "youtube":
            b = a.url.substr(a.url.lastIndexOf("=") + 1);
            youtubeSettings = {
                container: k,
                containerId: k.id,
                pluginMediaElement: j,
                pluginId: l,
                videoId: b,
                height: h,
                width: f
            };
            mejs.PluginDetector.hasPluginVersion("flash", [10, 0, 0]) ? mejs.YouTubeApi.createFlash(youtubeSettings) : mejs.YouTubeApi.enqueueIframe(youtubeSettings);
            break;
        case "vimeo":
            j.vimeoid = a.url.substr(a.url.lastIndexOf("index.html") + 1);
            k.innerHTML = '<iframe src="http://player.vimeo.com/video/' + j.vimeoid + '?portrait=0&byline=0&title=0" width="' + f + '" height="' + h + '" frameborder="0"></iframe>'
        }
        c.style.display = "none";
        return j
    },
    updateNative: function (a, b) {
        var c = a.htmlMediaElement,
            d;
        for (d in mejs.HtmlMediaElement) c[d] =
            mejs.HtmlMediaElement[d];
        b.success(c, c);
        return c
    }
};
mejs.YouTubeApi = {
    isIframeStarted: false,
    isIframeLoaded: false,
    loadIframeApi: function () {
        if (!this.isIframeStarted) {
            var a = document.createElement("script");
            a.src = "http://www.youtube.com/player_api";
            var b = document.getElementsByTagName("script")[0];
            b.parentNode.insertBefore(a, b);
            this.isIframeStarted = true
        }
    },
    iframeQueue: [],
    enqueueIframe: function (a) {
        if (this.isLoaded) this.createIframe(a);
        else {
            this.loadIframeApi();
            this.iframeQueue.push(a)
        }
    },
    createIframe: function (a) {
        var b = a.pluginMediaElement,
            c = new YT.Player(a.containerId, {
                height: a.height,
                width: a.width,
                videoId: a.videoId,
                playerVars: {
                    controls: 0
                },
                events: {
                    onReady: function () {
                        a.pluginMediaElement.pluginApi = c;
                        mejs.MediaPluginBridge.initPlugin(a.pluginId);
                        setInterval(function () {
                            mejs.YouTubeApi.createEvent(c, b, "timeupdate")
                        }, 250)
                    },
                    onStateChange: function (d) {
                        mejs.YouTubeApi.handleStateChange(d.data, c, b)
                    }
                }
            })
    },
    createEvent: function (a, b, c) {
        c = {
            type: c,
            target: b
        };
        if (a && a.getDuration) {
            b.currentTime = c.currentTime = a.getCurrentTime();
            b.duration = c.duration = a.getDuration();
            c.paused = b.paused;
            c.ended = b.ended;
            c.muted = a.isMuted();
            c.volume = a.getVolume() / 100;
            c.bytesTotal = a.getVideoBytesTotal();
            c.bufferedBytes = a.getVideoBytesLoaded();
            var d = c.bufferedBytes / c.bytesTotal * c.duration;
            c.target.buffered = c.buffered = {
                start: function () {
                    return 0
                },
                end: function () {
                    return d
                },
                length: 1
            }
        }
        b.dispatchEvent(c.type, c)
    },
    iFrameReady: function () {
        for (this.isIframeLoaded = this.isLoaded = true; this.iframeQueue.length > 0;) this.createIframe(this.iframeQueue.pop())
    },
    flashPlayers: {},
    createFlash: function (a) {
        this.flashPlayers[a.pluginId] =
            a;
        var b, c = "http://www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid=" + a.pluginId + "&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";
        if (mejs.MediaFeatures.isIE) {
            b = document.createElement("div");
            a.container.appendChild(b);
            b.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="' + a.pluginId + '" width="' + a.width + '" height="' + a.height + '"><param name="movie" value="' + c + '" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'
        } else a.container.innerHTML =
            '<object type="application/x-shockwave-flash" id="' + a.pluginId + '" data="' + c + '" width="' + a.width + '" height="' + a.height + '" style="visibility: visible; "><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'
    },
    flashReady: function (a) {
        var b = this.flashPlayers[a],
            c = document.getElementById(a),
            d = b.pluginMediaElement;
        d.pluginApi = d.pluginElement = c;
        mejs.MediaPluginBridge.initPlugin(a);
        c.cueVideoById(b.videoId);
        a = b.containerId + "_callback";
        window[a] = function (e) {
            mejs.YouTubeApi.handleStateChange(e,
                c, d)
        };
        c.addEventListener("onStateChange", a);
        setInterval(function () {
            mejs.YouTubeApi.createEvent(c, d, "timeupdate")
        }, 250)
    },
    handleStateChange: function (a, b, c) {
        switch (a) {
        case -1:
            c.paused = true;
            c.ended = true;
            mejs.YouTubeApi.createEvent(b, c, "loadedmetadata");
            break;
        case 0:
            c.paused = false;
            c.ended = true;
            mejs.YouTubeApi.createEvent(b, c, "ended");
            break;
        case 1:
            c.paused = false;
            c.ended = false;
            mejs.YouTubeApi.createEvent(b, c, "play");
            mejs.YouTubeApi.createEvent(b, c, "playing");
            break;
        case 2:
            c.paused = true;
            c.ended = false;
            mejs.YouTubeApi.createEvent(b,
                c, "pause");
            break;
        case 3:
            mejs.YouTubeApi.createEvent(b, c, "progress")
        }
    }
};

function onYouTubePlayerAPIReady() {
    mejs.YouTubeApi.iFrameReady()
}

function onYouTubePlayerReady(a) {
    mejs.YouTubeApi.flashReady(a)
}
window.mejs = mejs;
window.MediaElement = mejs.MediaElement;
(function (a, b, c) {
    var d = {
        locale: {
            strings: {}
        },
        methods: {}
    };
    d.locale.getLanguage = function () {
        return {
            language: navigator.language
        }
    };
    d.locale.INIT_LANGUAGE = d.locale.getLanguage();
    d.methods.checkPlain = function (e) {
        var g, f, h = {
                "&": "&amp;",
                '"': "&quot;",
                "<": "&lt;",
                ">": "&gt;"
            };
        e = String(e);
        for (g in h)
            if (h.hasOwnProperty(g)) {
                f = RegExp(g, "g");
                e = e.replace(f, h[g])
            }
        return e
    };
    d.methods.formatString = function (e, g) {
        for (var f in g) {
            switch (f.charAt(0)) {
            case "@":
                g[f] = d.methods.checkPlain(g[f]);
                break;
            case "!":
                break;
            default:
                g[f] =
                    '<em class="placeholder">' + d.methods.checkPlain(g[f]) + "</em>"
            }
            e = e.replace(f, g[f])
        }
        return e
    };
    d.methods.t = function (e, g, f) {
        if (d.locale.strings && d.locale.strings[f.context] && d.locale.strings[f.context][e]) e = d.locale.strings[f.context][e];
        if (g) e = d.methods.formatString(e, g);
        return e
    };
    d.t = function (e, g, f) {
        if (typeof e === "string" && e.length > 0) {
            var h = d.locale.getLanguage();
            f = f || {
                context: h.language
            };
            return d.methods.t(e, g, f)
        } else throw {
            name: "InvalidArgumentException",
            message: "First argument is either not a string or empty."
        };
    };
    c.i18n = d
})(jQuery, document, mejs);
(function (a) {
    a.de = {
        Fullscreen: "Vollbild",
        "Go Fullscreen": "Vollbild an",
        "Turn off Fullscreen": "Vollbild aus",
        Close: "Schlie\u00dfen"
    }
})(mejs.i18n.locale.strings);

/*!
 * MediaElementPlayer
 * http://mediaelementjs.com/
 *
 * Creates a controller bar for HTML5 <video> add <audio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *
 * Copyright 2010-2012, John Dyer (http://j.hn/)
 * License: MIT
 *
 */
if (typeof jQuery != "undefined") mejs.$ = jQuery;
else if (typeof ender != "undefined") mejs.$ = ender;
(function (f) {
    mejs.MepDefaults = {
        poster: "",
        defaultVideoWidth: 480,
        defaultVideoHeight: 270,
        videoWidth: -1,
        videoHeight: -1,
        defaultAudioWidth: 400,
        defaultAudioHeight: 30,
        defaultSeekBackwardInterval: function (a) {
            return a.duration * 0.05
        },
        defaultSeekForwardInterval: function (a) {
            return a.duration * 0.05
        },
        audioWidth: -1,
        audioHeight: -1,
        startVolume: 0.8,
        loop: false,
        autoRewind: true,
        enableAutosize: true,
        alwaysShowHours: false,
        showTimecodeFrameCount: false,
        framesPerSecond: 25,
        autosizeProgress: true,
        alwaysShowControls: false,
        clickToPlayPause: true,
        iPadUseNativeControls: false,
        iPhoneUseNativeControls: false,
        AndroidUseNativeControls: false,
        features: ["playpause", "current", "progress", "duration", "tracks", "volume", "fullscreen"],
        isVideo: true,
        enableKeyboard: true,
        pauseOtherPlayers: true,
        keyActions: [{
            keys: [32, 179],
            action: function (a, b) {
                b.paused || b.ended ? b.play() : b.pause()
            }
        }, {
            keys: [38],
            action: function (a, b) {
                b.setVolume(Math.min(b.volume + 0.1, 1))
            }
        }, {
            keys: [40],
            action: function (a, b) {
                b.setVolume(Math.max(b.volume - 0.1, 0))
            }
        }, {
            keys: [37, 227],
            action: function (a, b) {
                if (!isNaN(b.duration) &&
                    b.duration > 0) {
                    if (a.isVideo) {
                        a.showControls();
                        a.startControlsTimer()
                    }
                    var c = Math.max(b.currentTime - a.options.defaultSeekBackwardInterval(b), 0);
                    b.setCurrentTime(c)
                }
            }
        }, {
            keys: [39, 228],
            action: function (a, b) {
                if (!isNaN(b.duration) && b.duration > 0) {
                    if (a.isVideo) {
                        a.showControls();
                        a.startControlsTimer()
                    }
                    var c = Math.min(b.currentTime + a.options.defaultSeekForwardInterval(b), b.duration);
                    b.setCurrentTime(c)
                }
            }
        }, {
            keys: [70],
            action: function (a) {
                if (typeof a.enterFullScreen != "undefined") a.isFullScreen ? a.exitFullScreen() : a.enterFullScreen()
            }
        }]
    };
    mejs.mepIndex = 0;
    mejs.players = [];
    mejs.MediaElementPlayer = function (a, b) {
        if (!(this instanceof mejs.MediaElementPlayer)) return new mejs.MediaElementPlayer(a, b);
        this.$media = this.$node = f(a);
        this.node = this.media = this.$media[0];
        if (typeof this.node.player != "undefined") return this.node.player;
        else this.node.player = this; if (typeof b == "undefined") b = this.$node.data("mejsoptions");
        this.options = f.extend({}, mejs.MepDefaults, b);
        mejs.players.push(this);
        this.init();
        return this
    };
    mejs.MediaElementPlayer.prototype = {
        hasFocus: false,
        controlsAreVisible: true,
        init: function () {
            var a = this,
                b = mejs.MediaFeatures,
                c = f.extend(true, {}, a.options, {
                    success: function (e, g) {
                        a.meReady(e, g)
                    },
                    error: function (e) {
                        a.handleError(e)
                    }
                }),
                d = a.media.tagName.toLowerCase();
            a.isDynamic = d !== "audio" && d !== "video";
            a.isVideo = a.isDynamic ? a.options.isVideo : d !== "audio" && a.options.isVideo;
            if (b.isiPad && a.options.iPadUseNativeControls || b.isiPhone && a.options.iPhoneUseNativeControls) {
                a.$media.attr("controls", "controls");
                if (b.isiPad && a.media.getAttribute("autoplay") !== null) {
                    a.media.load();
                    a.media.play()
                }
            } else if (!(b.isAndroid && a.AndroidUseNativeControls)) {
                a.$media.removeAttr("controls");
                a.id = "mep_" + mejs.mepIndex++;
                a.container = f('<div id="' + a.id + '" class="mejs-container ' + (mejs.MediaFeatures.svg ? "svg" : "no-svg") + '"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(a.$media[0].className).insertBefore(a.$media);
                a.container.addClass((b.isAndroid ? "mejs-android " :
                    "") + (b.isiOS ? "mejs-ios " : "") + (b.isiPad ? "mejs-ipad " : "") + (b.isiPhone ? "mejs-iphone " : "") + (a.isVideo ? "mejs-video " : "mejs-audio "));
                if (b.isiOS) {
                    b = a.$media.clone();
                    a.container.find(".mejs-mediaelement").append(b);
                    a.$media.remove();
                    a.$node = a.$media = b;
                    a.node = a.media = b[0]
                } else a.container.find(".mejs-mediaelement").append(a.$media);
                a.controls = a.container.find(".mejs-controls");
                a.layers = a.container.find(".mejs-layers");
                b = a.isVideo ? "video" : "audio";
                d = b.substring(0, 1).toUpperCase() + b.substring(1);
                a.width = a.options[b +
                    "Width"] > 0 || a.options[b + "Width"].toString().indexOf("%") > -1 ? a.options[b + "Width"] : a.media.style.width !== "" && a.media.style.width !== null ? a.media.style.width : a.media.getAttribute("width") !== null ? a.$media.attr("width") : a.options["default" + d + "Width"];
                a.height = a.options[b + "Height"] > 0 || a.options[b + "Height"].toString().indexOf("%") > -1 ? a.options[b + "Height"] : a.media.style.height !== "" && a.media.style.height !== null ? a.media.style.height : a.$media[0].getAttribute("height") !== null ? a.$media.attr("height") : a.options["default" +
                    d + "Height"];
                a.setPlayerSize(a.width, a.height);
                c.pluginWidth = a.height;
                c.pluginHeight = a.width
            }
            mejs.MediaElement(a.$media[0], c);
            a.container.trigger("controlsshown")
        },
        showControls: function (a) {
            var b = this;
            a = typeof a == "undefined" || a;
            if (!b.controlsAreVisible) {
                if (a) {
                    b.controls.css("visibility", "visible").stop(true, true).fadeIn(200, function () {
                        b.controlsAreVisible = true;
                        b.container.trigger("controlsshown")
                    });
                    b.container.find(".mejs-control").css("visibility", "visible").stop(true, true).fadeIn(200, function () {
                        b.controlsAreVisible =
                            true
                    })
                } else {
                    b.controls.css("visibility", "visible").css("display", "block");
                    b.container.find(".mejs-control").css("visibility", "visible").css("display", "block");
                    b.controlsAreVisible = true;
                    b.container.trigger("controlsshown")
                }
                b.setControlsSize()
            }
        },
        hideControls: function (a) {
            var b = this;
            a = typeof a == "undefined" || a;
            if (b.controlsAreVisible)
                if (a) {
                    b.controls.stop(true, true).fadeOut(200, function () {
                        f(this).css("visibility", "hidden").css("display", "block");
                        b.controlsAreVisible = false;
                        b.container.trigger("controlshidden")
                    });
                    b.container.find(".mejs-control").stop(true, true).fadeOut(200, function () {
                        f(this).css("visibility", "hidden").css("display", "block")
                    })
                } else {
                    b.controls.css("visibility", "hidden").css("display", "block");
                    b.container.find(".mejs-control").css("visibility", "hidden").css("display", "block");
                    b.controlsAreVisible = false;
                    b.container.trigger("controlshidden")
                }
        },
        controlsTimer: null,
        startControlsTimer: function (a) {
            var b = this;
            a = typeof a != "undefined" ? a : 1500;
            b.killControlsTimer("start");
            b.controlsTimer = setTimeout(function () {
                b.hideControls();
                b.killControlsTimer("hide")
            }, a)
        },
        killControlsTimer: function () {
            if (this.controlsTimer !== null) {
                clearTimeout(this.controlsTimer);
                delete this.controlsTimer;
                this.controlsTimer = null
            }
        },
        controlsEnabled: true,
        disableControls: function () {
            this.killControlsTimer();
            this.hideControls(false);
            this.controlsEnabled = false
        },
        enableControls: function () {
            this.showControls(false);
            this.controlsEnabled = true
        },
        meReady: function (a, b) {
            var c = this,
                d = mejs.MediaFeatures,
                e = b.getAttribute("autoplay");
            e = !(typeof e == "undefined" || e === null ||
                e === "false");
            var g;
            if (!c.created) {
                c.created = true;
                c.media = a;
                c.domNode = b;
                if (!(d.isAndroid && c.options.AndroidUseNativeControls) && !(d.isiPad && c.options.iPadUseNativeControls) && !(d.isiPhone && c.options.iPhoneUseNativeControls)) {
                    c.buildposter(c, c.controls, c.layers, c.media);
                    c.buildkeyboard(c, c.controls, c.layers, c.media);
                    c.buildoverlays(c, c.controls, c.layers, c.media);
                    c.findTracks();
                    for (g in c.options.features) {
                        d = c.options.features[g];
                        if (c["build" + d]) try {
                            c["build" + d](c, c.controls, c.layers, c.media)
                        } catch (k) {}
                    }
                    c.container.trigger("controlsready");
                    c.setPlayerSize(c.width, c.height);
                    c.setControlsSize();
                    if (c.isVideo) {
                        if (mejs.MediaFeatures.hasTouch) c.$media.bind("touchstart", function () {
                            if (c.controlsAreVisible) c.hideControls(false);
                            else c.controlsEnabled && c.showControls(false)
                        });
                        else {
                            c.media.addEventListener("click", function () {
                                if (c.options.clickToPlayPause) c.media.paused ? c.media.play() : c.media.pause()
                            });
                            c.container.bind("mouseenter mouseover", function () {
                                if (c.controlsEnabled)
                                    if (!c.options.alwaysShowControls) {
                                        c.killControlsTimer("enter");
                                        c.showControls();
                                        c.startControlsTimer(2500)
                                    }
                            }).bind("mousemove", function () {
                                if (c.controlsEnabled) {
                                    c.controlsAreVisible || c.showControls();
                                    c.options.alwaysShowControls || c.startControlsTimer(2500)
                                }
                            }).bind("mouseleave", function () {
                                c.controlsEnabled && !c.media.paused && !c.options.alwaysShowControls && c.startControlsTimer(1E3)
                            })
                        }
                        e && !c.options.alwaysShowControls && c.hideControls();
                        c.options.enableAutosize && c.media.addEventListener("loadedmetadata", function (h) {
                            if (c.options.videoHeight <= 0 && c.domNode.getAttribute("height") === null && !isNaN(h.target.videoHeight)) {
                                c.setPlayerSize(h.target.videoWidth, h.target.videoHeight);
                                c.setControlsSize();
                                c.media.setVideoSize(h.target.videoWidth, h.target.videoHeight)
                            }
                        }, false)
                    }
                    a.addEventListener("play", function () {
                        for (var h = 0, o = mejs.players.length; h < o; h++) {
                            var n = mejs.players[h];
                            n.id != c.id && c.options.pauseOtherPlayers && !n.paused && !n.ended && n.pause();
                            n.hasFocus = false
                        }
                        c.hasFocus = true
                    }, false);
                    c.media.addEventListener("ended", function () {
                        if (c.options.autoRewind) try {
                            c.media.setCurrentTime(0)
                        } catch (h) {}
                        c.media.pause();
                        c.setProgressRail && c.setProgressRail();
                        c.setCurrentRail && c.setCurrentRail();
                        if (c.options.loop) c.media.play();
                        else !c.options.alwaysShowControls && c.controlsEnabled && c.showControls()
                    }, false);
                    c.media.addEventListener("loadedmetadata", function () {
                        c.updateDuration && c.updateDuration();
                        c.updateCurrent && c.updateCurrent();
                        if (!c.isFullScreen) {
                            c.setPlayerSize(c.width, c.height);
                            c.setControlsSize()
                        }
                    }, false);
                    setTimeout(function () {
                        c.setPlayerSize(c.width, c.height);
                        c.setControlsSize()
                    }, 50);
                    f(window).resize(function () {
                        c.isFullScreen ||
                            mejs.MediaFeatures.hasTrueNativeFullScreen && document.webkitIsFullScreen || c.setPlayerSize(c.width, c.height);
                        c.setControlsSize()
                    });
                    c.media.pluginType == "youtube" && c.container.find(".mejs-overlay-play").hide()
                }
                if (e && a.pluginType == "native") {
                    a.load();
                    a.play()
                }
                if (c.options.success) typeof c.options.success == "string" ? window[c.options.success](c.media, c.domNode, c) : c.options.success(c.media, c.domNode, c)
            }
        },
        handleError: function (a) {
            this.controls.hide();
            this.options.error && this.options.error(a)
        },
        setPlayerSize: function (a,
            b) {
            if (typeof a != "undefined") this.width = a;
            if (typeof b != "undefined") this.height = b;
            if (this.height.toString().indexOf("%") > 0 || this.$node.css("max-width") === "100%" || this.$node[0].currentStyle && this.$node[0].currentStyle.maxWidth === "100%") {
                var c = this.isVideo ? this.media.videoWidth && this.media.videoWidth > 0 ? this.media.videoWidth : this.options.defaultVideoWidth : this.options.defaultAudioWidth,
                    d = this.isVideo ? this.media.videoHeight && this.media.videoHeight > 0 ? this.media.videoHeight : this.options.defaultVideoHeight :
                        this.options.defaultAudioHeight,
                    e = this.container.parent().closest(":visible").width();
                c = this.isVideo || !this.options.autosizeProgress ? parseInt(e * d / c, 10) : d;
                if (this.container.parent()[0].tagName.toLowerCase() === "body") {
                    e = f(window).width();
                    c = f(window).height()
                }
                if (c != 0 && e != 0) {
                    this.container.width(e).height(c);
                    this.$media.width("100%").height("100%");
                    this.container.find("object, embed, iframe").width("100%").height("100%");
                    this.isVideo && this.media.setVideoSize && this.media.setVideoSize(e, c);
                    this.layers.children(".mejs-layer").width("100%").height("100%")
                }
            } else {
                this.container.width(this.width).height(this.height);
                this.layers.children(".mejs-layer").width(this.width).height(this.height)
            }
        },
        setControlsSize: function () {
            var a = 0,
                b = 0,
                c = this.controls.find(".mejs-time-rail"),
                d = this.controls.find(".mejs-time-total");
            this.controls.find(".mejs-time-current");
            this.controls.find(".mejs-time-loaded");
            var e = c.siblings();
            if (this.options && !this.options.autosizeProgress) b = parseInt(c.css("width"));
            if (b === 0 || !b) {
                e.each(function () {
                    if (f(this).css("position") != "absolute") a += f(this).outerWidth(true)
                });
                b = this.controls.width() - a - (c.outerWidth(true) -
                    c.width())
            }
            c.width(b);
            d.width(b - (d.outerWidth(true) - d.width()));
            this.setProgressRail && this.setProgressRail();
            this.setCurrentRail && this.setCurrentRail()
        },
        buildposter: function (a, b, c, d) {
            var e = f('<div class="mejs-poster mejs-layer"></div>').appendTo(c);
            b = a.$media.attr("poster");
            if (a.options.poster !== "") b = a.options.poster;
            b !== "" && b != null ? this.setPoster(b) : e.hide();
            d.addEventListener("play", function () {
                e.hide()
            }, false)
        },
        setPoster: function (a) {
            var b = this.container.find(".mejs-poster"),
                c = b.find("img");
            if (c.length ==
                0) c = f('<img width="100%" height="100%" />').appendTo(b);
            c.attr("src", a)
        },
        buildoverlays: function (a, b, c, d) {
            var e = this;
            if (a.isVideo) {
                var g = f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(c),
                    k = f('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(c),
                    h = f('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(c).click(function () {
                        if (e.options.clickToPlayPause) d.paused ?
                            d.play() : d.pause()
                    });
                d.addEventListener("play", function () {
                    h.hide();
                    g.hide();
                    b.find(".mejs-time-buffering").hide();
                    k.hide()
                }, false);
                d.addEventListener("playing", function () {
                    h.hide();
                    g.hide();
                    b.find(".mejs-time-buffering").hide();
                    k.hide()
                }, false);
                d.addEventListener("seeking", function () {
                    g.show();
                    b.find(".mejs-time-buffering").show()
                }, false);
                d.addEventListener("seeked", function () {
                    g.hide();
                    b.find(".mejs-time-buffering").hide()
                }, false);
                d.addEventListener("pause", function () {
                        mejs.MediaFeatures.isiPhone || h.show()
                    },
                    false);
                d.addEventListener("waiting", function () {
                    g.show();
                    b.find(".mejs-time-buffering").show()
                }, false);
                d.addEventListener("loadeddata", function () {
                    g.show();
                    b.find(".mejs-time-buffering").show()
                }, false);
                d.addEventListener("canplay", function () {
                    g.hide();
                    b.find(".mejs-time-buffering").hide()
                }, false);
                d.addEventListener("error", function () {
                    g.hide();
                    b.find(".mejs-time-buffering").hide();
                    k.show();
                    k.find("mejs-overlay-error").html("Error loading this resource")
                }, false)
            }
        },
        buildkeyboard: function (a, b, c, d) {
            f(document).keydown(function (e) {
                if (a.hasFocus &&
                    a.options.enableKeyboard)
                    for (var g = 0, k = a.options.keyActions.length; g < k; g++)
                        for (var h = a.options.keyActions[g], o = 0, n = h.keys.length; o < n; o++)
                            if (e.keyCode == h.keys[o]) {
                                e.preventDefault();
                                h.action(a, d, e.keyCode);
                                return false
                            }
                return true
            });
            f(document).click(function (e) {
                if (f(e.target).closest(".mejs-container").length == 0) a.hasFocus = false
            })
        },
        findTracks: function () {
            var a = this,
                b = a.$media.find("track");
            a.tracks = [];
            b.each(function (c, d) {
                d = f(d);
                a.tracks.push({
                    srclang: d.attr("srclang").toLowerCase(),
                    src: d.attr("src"),
                    kind: d.attr("kind"),
                    label: d.attr("label") || "",
                    entries: [],
                    isLoaded: false
                })
            })
        },
        changeSkin: function (a) {
            this.container[0].className = "mejs-container " + a;
            this.setPlayerSize(this.width, this.height);
            this.setControlsSize()
        },
        play: function () {
            this.media.play()
        },
        pause: function () {
            this.media.pause()
        },
        load: function () {
            this.media.load()
        },
        setMuted: function (a) {
            this.media.setMuted(a)
        },
        setCurrentTime: function (a) {
            this.media.setCurrentTime(a)
        },
        getCurrentTime: function () {
            return this.media.currentTime
        },
        setVolume: function (a) {
            this.media.setVolume(a)
        },
        getVolume: function () {
            return this.media.volume
        },
        setSrc: function (a) {
            this.media.setSrc(a)
        },
        remove: function () {
            if (this.media.pluginType === "flash") this.media.remove();
            else this.media.pluginType === "native" && this.$media.prop("controls", true);
            this.isDynamic || this.$node.insertBefore(this.container);
            this.container.remove()
        }
    };
    if (typeof jQuery != "undefined") jQuery.fn.mediaelementplayer = function (a) {
        return this.each(function () {
            new mejs.MediaElementPlayer(this, a)
        })
    };
    f(document).ready(function () {
        f(".mejs-player").mediaelementplayer()
    });
    window.MediaElementPlayer = mejs.MediaElementPlayer
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        playpauseText: "Play/Pause"
    });
    f.extend(MediaElementPlayer.prototype, {
        buildplaypause: function (a, b, c, d) {
            var e = f('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="' + this.id + '" title="' + this.options.playpauseText + '"></button></div>').appendTo(b).click(function (g) {
                g.preventDefault();
                d.paused ? d.play() : d.pause();
                return false
            });
            d.addEventListener("play", function () {
                e.removeClass("mejs-play").addClass("mejs-pause")
            }, false);
            d.addEventListener("playing", function () {
                e.removeClass("mejs-play").addClass("mejs-pause")
            }, false);
            d.addEventListener("pause", function () {
                e.removeClass("mejs-pause").addClass("mejs-play")
            }, false);
            d.addEventListener("paused", function () {
                e.removeClass("mejs-pause").addClass("mejs-play")
            }, false)
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        stopText: "Stop"
    });
    f.extend(MediaElementPlayer.prototype, {
        buildstop: function (a, b, c, d) {
            f('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="' + this.id + '" title="' + this.options.stopText + '"></button></div>').appendTo(b).click(function () {
                d.paused || d.pause();
                if (d.currentTime > 0) {
                    d.setCurrentTime(0);
                    d.pause();
                    b.find(".mejs-time-current").width("0px");
                    b.find(".mejs-time-handle").css("left", "0px");
                    b.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0));
                    b.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0));
                    c.find(".mejs-poster").show()
                }
            })
        }
    })
})(mejs.$);
(function (f) {
    f.extend(MediaElementPlayer.prototype, {
        buildprogress: function (a, b, c, d) {
            f('<div class="mejs-time-rail"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(b);
            b.find(".mejs-time-buffering").hide();
            var e =
                b.find(".mejs-time-total");
            c = b.find(".mejs-time-loaded");
            var g = b.find(".mejs-time-current"),
                k = b.find(".mejs-time-handle"),
                h = b.find(".mejs-time-float"),
                o = b.find(".mejs-time-float-current"),
                n = function (m) {
                    m = m.pageX;
                    var q = e.offset(),
                        i = e.outerWidth(true),
                        j = 0,
                        l = j = 0;
                    if (d.duration) {
                        if (m < q.left) m = q.left;
                        else if (m > i + q.left) m = i + q.left;
                        l = m - q.left;
                        j = l / i;
                        j = j <= 0.02 ? 0 : j * d.duration;
                        p && j !== d.currentTime && d.setCurrentTime(j);
                        if (!mejs.MediaFeatures.hasTouch) {
                            h.css("left", l);
                            o.html(mejs.Utility.secondsToTimeCode(j));
                            h.show()
                        }
                    }
                }, p = false;
            e.bind("mousedown", function (m) {
                if (m.which === 1) {
                    p = true;
                    n(m);
                    f(document).bind("mousemove.dur", function (q) {
                        n(q)
                    }).bind("mouseup.dur", function () {
                        p = false;
                        h.hide();
                        f(document).unbind(".dur")
                    });
                    return false
                }
            }).bind("mouseenter", function () {
                f(document).bind("mousemove.dur", function (m) {
                    n(m)
                });
                mejs.MediaFeatures.hasTouch || h.show()
            }).bind("mouseleave", function () {
                if (!p) {
                    f(document).unbind(".dur");
                    h.hide()
                }
            });
            d.addEventListener("progress", function (m) {
                    a.setProgressRail(m);
                    a.setCurrentRail(m)
                },
                false);
            d.addEventListener("timeupdate", function (m) {
                a.setProgressRail(m);
                a.setCurrentRail(m)
            }, false);
            this.loaded = c;
            this.total = e;
            this.current = g;
            this.handle = k
        },
        setProgressRail: function (a) {
            var b = a != undefined ? a.target : this.media,
                c = null;
            if (b && b.buffered && b.buffered.length > 0 && b.buffered.end && b.duration) c = b.buffered.end(0) / b.duration;
            else if (b && b.bytesTotal != undefined && b.bytesTotal > 0 && b.bufferedBytes != undefined) c = b.bufferedBytes / b.bytesTotal;
            else if (a && a.lengthComputable && a.total != 0) c = a.loaded / a.total;
            if (c !==
                null) {
                c = Math.min(1, Math.max(0, c));
                this.loaded && this.total && this.loaded.width(this.total.width() * c)
            }
        },
        setCurrentRail: function () {
            if (this.media.currentTime != undefined && this.media.duration)
                if (this.total && this.handle) {
                    var a = this.total.width() * this.media.currentTime / this.media.duration,
                        b = a - this.handle.outerWidth(true) / 2;
                    this.current.width(a);
                    this.handle.css("left", b)
                }
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        duration: -1,
        timeAndDurationSeparator: " <span> | </span> "
    });
    f.extend(MediaElementPlayer.prototype, {
        buildcurrent: function (a, b, c, d) {
            f('<div class="mejs-time"><span class="mejs-currenttime">' + (a.options.alwaysShowHours ? "00:" : "") + (a.options.showTimecodeFrameCount ? "00:00:00" : "00:00") + "</span></div>").appendTo(b);
            this.currenttime = this.controls.find(".mejs-currenttime");
            d.addEventListener("timeupdate", function () {
                a.updateCurrent()
            }, false)
        },
        buildduration: function (a,
            b, c, d) {
            if (b.children().last().find(".mejs-currenttime").length > 0) f(this.options.timeAndDurationSeparator + '<span class="mejs-duration">' + (this.options.duration > 0 ? mejs.Utility.secondsToTimeCode(this.options.duration, this.options.alwaysShowHours || this.media.duration > 3600, this.options.showTimecodeFrameCount, this.options.framesPerSecond || 25) : (a.options.alwaysShowHours ? "00:" : "") + (a.options.showTimecodeFrameCount ? "00:00:00" : "00:00")) + "</span>").appendTo(b.find(".mejs-time"));
            else {
                b.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container");
                f('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">' + (this.options.duration > 0 ? mejs.Utility.secondsToTimeCode(this.options.duration, this.options.alwaysShowHours || this.media.duration > 3600, this.options.showTimecodeFrameCount, this.options.framesPerSecond || 25) : (a.options.alwaysShowHours ? "00:" : "") + (a.options.showTimecodeFrameCount ? "00:00:00" : "00:00")) + "</span></div>").appendTo(b)
            }
            this.durationD = this.controls.find(".mejs-duration");
            d.addEventListener("timeupdate", function () {
                    a.updateDuration()
                },
                false)
        },
        updateCurrent: function () {
            if (this.currenttime) this.currenttime.html(mejs.Utility.secondsToTimeCode(this.media.currentTime, this.options.alwaysShowHours || this.media.duration > 3600, this.options.showTimecodeFrameCount, this.options.framesPerSecond || 25))
        },
        updateDuration: function () {
            this.container.toggleClass("mejs-long-video", this.media.duration > 3600);
            if (this.media.duration && this.durationD) this.durationD.html(mejs.Utility.secondsToTimeCode(this.media.duration, this.options.alwaysShowHours, this.options.showTimecodeFrameCount,
                this.options.framesPerSecond || 25))
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        muteText: "Mute Toggle",
        hideVolumeOnTouchDevices: true,
        audioVolume: "horizontal",
        videoVolume: "vertical"
    });
    f.extend(MediaElementPlayer.prototype, {
        buildvolume: function (a, b, c, d) {
            if (!(mejs.MediaFeatures.hasTouch && this.options.hideVolumeOnTouchDevices)) {
                var e = this.isVideo ? this.options.videoVolume : this.options.audioVolume,
                    g = e == "horizontal" ? f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="' + this.id + '" title="' + this.options.muteText +
                        '"></button></div><div class="mejs-horizontal-volume-slider"><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></div>').appendTo(b) : f('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="' + this.id + '" title="' + this.options.muteText + '"></button><div class="mejs-volume-slider"><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></div></div>').appendTo(b),
                    k = this.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),
                    h = this.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),
                    o = this.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),
                    n = this.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),
                    p = function (j, l) {
                        if (!k.is(":visible") && typeof l == "undefined") {
                            k.show();
                            p(j, true);
                            k.hide()
                        } else {
                            j = Math.max(0, j);
                            j = Math.min(j, 1);
                            j == 0 ? g.removeClass("mejs-mute").addClass("mejs-unmute") : g.removeClass("mejs-unmute").addClass("mejs-mute");
                            if (e == "vertical") {
                                var r = h.height(),
                                    s = h.position(),
                                    t = r - r * j;
                                n.css("top", Math.round(s.top + t - n.height() / 2));
                                o.height(r - t);
                                o.css("top", s.top + t)
                            } else {
                                r = h.width();
                                s = h.position();
                                r = r * j;
                                n.css("left", Math.round(s.left + r - n.width() / 2));
                                o.width(Math.round(r))
                            }
                        }
                    }, m = function (j) {
                        var l = null,
                            r = h.offset();
                        if (e == "vertical") {
                            l = h.height();
                            parseInt(h.css("top").replace(/px/, ""), 10);
                            l = (l - (j.pageY - r.top)) / l;
                            if (r.top == 0 || r.left == 0) return
                        } else {
                            l = h.width();
                            l = (j.pageX - r.left) / l
                        }
                        l = Math.max(0, l);
                        l = Math.min(l, 1);
                        p(l);
                        l == 0 ? d.setMuted(true) :
                            d.setMuted(false);
                        d.setVolume(l)
                    }, q = false,
                    i = false;
                g.hover(function () {
                    k.show();
                    i = true
                }, function () {
                    i = false;
                    !q && e == "vertical" && k.hide()
                });
                k.bind("mouseover", function () {
                    i = true
                }).bind("mousedown", function (j) {
                    m(j);
                    f(document).bind("mousemove.vol", function (l) {
                        m(l)
                    }).bind("mouseup.vol", function () {
                        q = false;
                        f(document).unbind(".vol");
                        !i && e == "vertical" && k.hide()
                    });
                    q = true;
                    return false
                });
                g.find("button").click(function () {
                    d.setMuted(!d.muted)
                });
                d.addEventListener("volumechange", function () {
                    if (!q)
                        if (d.muted) {
                            p(0);
                            g.removeClass("mejs-mute").addClass("mejs-unmute")
                        } else {
                            p(d.volume);
                            g.removeClass("mejs-unmute").addClass("mejs-mute")
                        }
                }, false);
                if (this.container.is(":visible")) {
                    p(a.options.startVolume);
                    d.pluginType === "native" && d.setVolume(a.options.startVolume)
                }
            }
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        usePluginFullScreen: true,
        newWindowCallback: function () {
            return ""
        },
        fullscreenText: mejs.i18n.t("Fullscreen")
    });
    f.extend(MediaElementPlayer.prototype, {
        isFullScreen: false,
        isNativeFullScreen: false,
        docStyleOverflow: null,
        isInIframe: false,
        buildfullscreen: function (a, b, c, d) {
            if (a.isVideo) {
                a.isInIframe = window.location != window.parent.location;
                if (mejs.MediaFeatures.hasTrueNativeFullScreen) {
                    c = null;
                    c = mejs.MediaFeatures.hasMozNativeFullScreen ? f(document) : a.container;
                    c.bind(mejs.MediaFeatures.fullScreenEventName,
                        function () {
                            if (mejs.MediaFeatures.isFullScreen()) {
                                a.isNativeFullScreen = true;
                                a.setControlsSize()
                            } else {
                                a.isNativeFullScreen = false;
                                a.exitFullScreen()
                            }
                        })
                }
                var e = this,
                    g = f('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="' + e.id + '" title="' + e.options.fullscreenText + '"></button></div>').appendTo(b);
                if (e.media.pluginType === "native" || !e.options.usePluginFullScreen && !mejs.MediaFeatures.isFirefox) g.click(function () {
                    mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen() ||
                        a.isFullScreen ? a.exitFullScreen() : a.enterFullScreen()
                });
                else {
                    var k = null;
                    if (function () {
                        var i = document.createElement("x"),
                            j = document.documentElement,
                            l = window.getComputedStyle;
                        if (!("pointerEvents" in i.style)) return false;
                        i.style.pointerEvents = "auto";
                        i.style.pointerEvents = "x";
                        j.appendChild(i);
                        l = l && l(i, "").pointerEvents === "auto";
                        j.removeChild(i);
                        return !!l
                    }() && !mejs.MediaFeatures.isOpera) {
                        var h = false,
                            o = function () {
                                if (h) {
                                    n.hide();
                                    p.hide();
                                    m.hide();
                                    g.css("pointer-events", "");
                                    e.controls.css("pointer-events",
                                        "");
                                    h = false
                                }
                            }, n = f('<div class="mejs-fullscreen-hover" />').appendTo(e.container).mouseover(o),
                            p = f('<div class="mejs-fullscreen-hover"  />').appendTo(e.container).mouseover(o),
                            m = f('<div class="mejs-fullscreen-hover"  />').appendTo(e.container).mouseover(o),
                            q = function () {
                                var i = {
                                    position: "absolute",
                                    top: 0,
                                    left: 0
                                };
                                n.css(i);
                                p.css(i);
                                m.css(i);
                                n.width(e.container.width()).height(e.container.height() - e.controls.height());
                                i = g.offset().left - e.container.offset().left;
                                fullScreenBtnWidth = g.outerWidth(true);
                                p.width(i).height(e.controls.height()).css({
                                    top: e.container.height() -
                                        e.controls.height()
                                });
                                m.width(e.container.width() - i - fullScreenBtnWidth).height(e.controls.height()).css({
                                    top: e.container.height() - e.controls.height(),
                                    left: i + fullScreenBtnWidth
                                })
                            };
                        f(document).resize(function () {
                            q()
                        });
                        g.mouseover(function () {
                            if (!e.isFullScreen) {
                                var i = g.offset(),
                                    j = a.container.offset();
                                d.positionFullscreenButton(i.left - j.left, i.top - j.top, false);
                                g.css("pointer-events", "none");
                                e.controls.css("pointer-events", "none");
                                n.show();
                                m.show();
                                p.show();
                                q();
                                h = true
                            }
                        });
                        d.addEventListener("fullscreenchange",
                            function () {
                                o()
                            })
                    } else g.mouseover(function () {
                        if (k !== null) {
                            clearTimeout(k);
                            delete k
                        }
                        var i = g.offset(),
                            j = a.container.offset();
                        d.positionFullscreenButton(i.left - j.left, i.top - j.top, true)
                    }).mouseout(function () {
                        if (k !== null) {
                            clearTimeout(k);
                            delete k
                        }
                        k = setTimeout(function () {
                            d.hideFullscreenButton()
                        }, 1500)
                    })
                }
                a.fullscreenBtn = g;
                f(document).bind("keydown", function (i) {
                    if ((mejs.MediaFeatures.hasTrueNativeFullScreen && mejs.MediaFeatures.isFullScreen() || e.isFullScreen) && i.keyCode == 27) a.exitFullScreen()
                })
            }
        },
        enterFullScreen: function () {
            var a =
                this;
            if (!(a.media.pluginType !== "native" && (mejs.MediaFeatures.isFirefox || a.options.usePluginFullScreen))) {
                docStyleOverflow = document.documentElement.style.overflow;
                document.documentElement.style.overflow = "hidden";
                normalHeight = a.container.height();
                normalWidth = a.container.width();
                if (a.media.pluginType === "native")
                    if (mejs.MediaFeatures.hasTrueNativeFullScreen) {
                        mejs.MediaFeatures.requestFullScreen(a.container[0]);
                        a.isInIframe && setTimeout(function c() {
                            if (a.isNativeFullScreen) f(window).width() !== screen.width ?
                                a.exitFullScreen() : setTimeout(c, 500)
                        }, 500)
                    } else if (mejs.MediaFeatures.hasSemiNativeFullScreen) {
                    a.media.webkitEnterFullscreen();
                    return
                }
                if (a.isInIframe) {
                    var b = a.options.newWindowCallback(this);
                    if (b !== "")
                        if (mejs.MediaFeatures.hasTrueNativeFullScreen) setTimeout(function () {
                            if (!a.isNativeFullScreen) {
                                a.pause();
                                window.open(b, a.id, "top=0,left=0,width=" + screen.availWidth + ",height=" + screen.availHeight + ",resizable=yes,scrollbars=no,status=no,toolbar=no")
                            }
                        }, 250);
                        else {
                            a.pause();
                            window.open(b, a.id, "top=0,left=0,width=" +
                                screen.availWidth + ",height=" + screen.availHeight + ",resizable=yes,scrollbars=no,status=no,toolbar=no");
                            return
                        }
                }
                a.container.addClass("mejs-container-fullscreen").width("100%").height("100%");
                setTimeout(function () {
                    a.container.css({
                        width: "100%",
                        height: "100%"
                    });
                    a.setControlsSize()
                }, 500);
                if (a.pluginType === "native") a.$media.width("100%").height("100%");
                else {
                    a.container.find("object, embed, iframe").width("100%").height("100%");
                    a.media.setVideoSize(f(window).width(), f(window).height())
                }
                a.layers.children("div").width("100%").height("100%");
                a.fullscreenBtn && a.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen");
                a.setControlsSize();
                a.isFullScreen = true
            }
        },
        exitFullScreen: function () {
            if (this.media.pluginType !== "native" && mejs.MediaFeatures.isFirefox) this.media.setFullscreen(false);
            else {
                if (mejs.MediaFeatures.hasTrueNativeFullScreen && (mejs.MediaFeatures.isFullScreen() || this.isFullScreen)) mejs.MediaFeatures.cancelFullScreen();
                document.documentElement.style.overflow = docStyleOverflow;
                this.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight);
                if (this.pluginType === "native") this.$media.width(normalWidth).height(normalHeight);
                else {
                    this.container.find("object embed").width(normalWidth).height(normalHeight);
                    this.media.setVideoSize(normalWidth, normalHeight)
                }
                this.layers.children("div").width(normalWidth).height(normalHeight);
                this.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen");
                this.setControlsSize();
                this.isFullScreen = false
            }
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        startLanguage: "",
        tracksText: "Captions/Subtitles"
    });
    f.extend(MediaElementPlayer.prototype, {
        hasChapters: false,
        buildtracks: function (a, b, c, d) {
            if (a.isVideo)
                if (a.tracks.length != 0) {
                    var e;
                    a.chapters = f('<div class="mejs-chapters mejs-layer"></div>').prependTo(c).hide();
                    a.captions = f('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position"><span class="mejs-captions-text"></span></div></div>').prependTo(c).hide();
                    a.captionsText = a.captions.find(".mejs-captions-text");
                    a.captionsButton = f('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="' + this.id + '" title="' + this.options.tracksText + '"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="' + a.id + '_captions" id="' + a.id + '_captions_none" value="none" checked="checked" /><label for="' + a.id + '_captions_none">None</label></li></ul></div></div>').appendTo(b).hover(function () {
                        f(this).find(".mejs-captions-selector").css("visibility", "visible")
                    }, function () {
                        f(this).find(".mejs-captions-selector").css("visibility",
                            "hidden")
                    }).delegate("input[type=radio]", "click", function () {
                        lang = this.value;
                        if (lang == "none") a.selectedTrack = null;
                        else
                            for (e = 0; e < a.tracks.length; e++)
                                if (a.tracks[e].srclang == lang) {
                                    a.selectedTrack = a.tracks[e];
                                    a.captions.attr("lang", a.selectedTrack.srclang);
                                    a.displayCaptions();
                                    break
                                }
                    });
                    a.options.alwaysShowControls ? a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover") : a.container.bind("controlsshown", function () {
                        a.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")
                    }).bind("controlshidden",
                        function () {
                            d.paused || a.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")
                        });
                    a.trackToLoad = -1;
                    a.selectedTrack = null;
                    a.isLoadingTrack = false;
                    for (e = 0; e < a.tracks.length; e++) a.tracks[e].kind == "subtitles" && a.addTrackButton(a.tracks[e].srclang, a.tracks[e].label);
                    a.loadNextTrack();
                    d.addEventListener("timeupdate", function () {
                        a.displayCaptions()
                    }, false);
                    d.addEventListener("loadedmetadata", function () {
                        a.displayChapters()
                    }, false);
                    a.container.hover(function () {
                        if (a.hasChapters) {
                            a.chapters.css("visibility",
                                "visible");
                            a.chapters.fadeIn(200).height(a.chapters.find(".mejs-chapter").outerHeight())
                        }
                    }, function () {
                        a.hasChapters && !d.paused && a.chapters.fadeOut(200, function () {
                            f(this).css("visibility", "hidden");
                            f(this).css("display", "block")
                        })
                    });
                    a.node.getAttribute("autoplay") !== null && a.chapters.css("visibility", "hidden")
                }
        },
        loadNextTrack: function () {
            this.trackToLoad++;
            if (this.trackToLoad < this.tracks.length) {
                this.isLoadingTrack = true;
                this.loadTrack(this.trackToLoad)
            } else this.isLoadingTrack = false
        },
        loadTrack: function (a) {
            var b =
                this,
                c = b.tracks[a];
            f.ajax({
                url: c.src,
                dataType: "text",
                success: function (d) {
                    c.entries = typeof d == "string" && /<tt\s+xml/ig.exec(d) ? mejs.TrackFormatParser.dfxp.parse(d) : mejs.TrackFormatParser.webvvt.parse(d);
                    c.isLoaded = true;
                    b.enableTrackButton(c.srclang, c.label);
                    b.loadNextTrack();
                    c.kind == "chapters" && b.media.addEventListener("play", function () {
                        b.media.duration > 0 && b.displayChapters(c)
                    }, false)
                },
                error: function () {
                    b.loadNextTrack()
                }
            })
        },
        enableTrackButton: function (a, b) {
            if (b === "") b = mejs.language.codes[a] || a;
            this.captionsButton.find("input[value=" +
                a + "]").prop("disabled", false).siblings("label").html(b);
            this.options.startLanguage == a && f("#" + this.id + "_captions_" + a).click();
            this.adjustLanguageBox()
        },
        addTrackButton: function (a, b) {
            if (b === "") b = mejs.language.codes[a] || a;
            this.captionsButton.find("ul").append(f('<li><input type="radio" name="' + this.id + '_captions" id="' + this.id + "_captions_" + a + '" value="' + a + '" disabled="disabled" /><label for="' + this.id + "_captions_" + a + '">' + b + " (loading)</label></li>"));
            this.adjustLanguageBox();
            this.container.find(".mejs-captions-translations option[value=" +
                a + "]").remove()
        },
        adjustLanguageBox: function () {
            this.captionsButton.find(".mejs-captions-selector").height(this.captionsButton.find(".mejs-captions-selector ul").outerHeight(true) + this.captionsButton.find(".mejs-captions-translations").outerHeight(true))
        },
        displayCaptions: function () {
            if (typeof this.tracks != "undefined") {
                var a, b = this.selectedTrack;
                if (b != null && b.isLoaded)
                    for (a = 0; a < b.entries.times.length; a++)
                        if (this.media.currentTime >= b.entries.times[a].start && this.media.currentTime <= b.entries.times[a].stop) {
                            this.captionsText.html(b.entries.text[a]);
                            this.captions.show().height(0);
                            return
                        }
                this.captions.hide()
            }
        },
        displayChapters: function () {
            var a;
            for (a = 0; a < this.tracks.length; a++)
                if (this.tracks[a].kind == "chapters" && this.tracks[a].isLoaded) {
                    this.drawChapters(this.tracks[a]);
                    this.hasChapters = true;
                    break
                }
        },
        drawChapters: function (a) {
            var b = this,
                c, d, e = d = 0;
            b.chapters.empty();
            for (c = 0; c < a.entries.times.length; c++) {
                d = a.entries.times[c].stop - a.entries.times[c].start;
                d = Math.floor(d / b.media.duration * 100);
                if (d + e > 100 || c == a.entries.times.length - 1 && d + e < 100) d = 100 - e;
                b.chapters.append(f('<div class="mejs-chapter" rel="' +
                    a.entries.times[c].start + '" style="left: ' + e.toString() + "%;width: " + d.toString() + '%;"><div class="mejs-chapter-block' + (c == a.entries.times.length - 1 ? " mejs-chapter-block-last" : "") + '"><span class="ch-title">' + a.entries.text[c] + '</span><span class="ch-time">' + mejs.Utility.secondsToTimeCode(a.entries.times[c].start) + "&ndash;" + mejs.Utility.secondsToTimeCode(a.entries.times[c].stop) + "</span></div></div>"));
                e += d
            }
            b.chapters.find("div.mejs-chapter").click(function () {
                b.media.setCurrentTime(parseFloat(f(this).attr("rel")));
                b.media.paused && b.media.play()
            });
            b.chapters.show()
        }
    });
    mejs.language = {
        codes: {
            af: "Afrikaans",
            sq: "Albanian",
            ar: "Arabic",
            be: "Belarusian",
            bg: "Bulgarian",
            ca: "Catalan",
            zh: "Chinese",
            "zh-cn": "Chinese Simplified",
            "zh-tw": "Chinese Traditional",
            hr: "Croatian",
            cs: "Czech",
            da: "Danish",
            nl: "Dutch",
            en: "English",
            et: "Estonian",
            tl: "Filipino",
            fi: "Finnish",
            fr: "French",
            gl: "Galician",
            de: "German",
            el: "Greek",
            ht: "Haitian Creole",
            iw: "Hebrew",
            hi: "Hindi",
            hu: "Hungarian",
            is: "Icelandic",
            id: "Indonesian",
            ga: "Irish",
            it: "Italian",
            ja: "Japanese",
            ko: "Korean",
            lv: "Latvian",
            lt: "Lithuanian",
            mk: "Macedonian",
            ms: "Malay",
            mt: "Maltese",
            no: "Norwegian",
            fa: "Persian",
            pl: "Polish",
            pt: "Portuguese",
            ro: "Romanian",
            ru: "Russian",
            sr: "Serbian",
            sk: "Slovak",
            sl: "Slovenian",
            es: "Spanish",
            sw: "Swahili",
            sv: "Swedish",
            tl: "Tagalog",
            th: "Thai",
            tr: "Turkish",
            uk: "Ukrainian",
            vi: "Vietnamese",
            cy: "Welsh",
            yi: "Yiddish"
        }
    };
    mejs.TrackFormatParser = {
        webvvt: {
            pattern_identifier: /^([a-zA-z]+-)?[0-9]+$/,
            pattern_timecode: /^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,
            parse: function (a) {
                var b = 0;
                a = mejs.TrackFormatParser.split2(a, /\r?\n/);
                for (var c = {
                    text: [],
                    times: []
                }, d, e; b < a.length; b++)
                    if (this.pattern_identifier.exec(a[b])) {
                        b++;
                        if ((d = this.pattern_timecode.exec(a[b])) && b < a.length) {
                            b++;
                            e = a[b];
                            for (b++; a[b] !== "" && b < a.length;) {
                                e = e + "\n" + a[b];
                                b++
                            }
                            e = f.trim(e).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, "<a href='$1' target='_blank'>$1</a>");
                            c.text.push(e);
                            c.times.push({
                                start: mejs.Utility.convertSMPTEtoSeconds(d[1]) == 0 ? 0.2 : mejs.Utility.convertSMPTEtoSeconds(d[1]),
                                stop: mejs.Utility.convertSMPTEtoSeconds(d[3]),
                                settings: d[5]
                            })
                        }
                    }
                return c
            }
        },
        dfxp: {
            parse: function (a) {
                a = f(a).filter("tt");
                var b = 0;
                b = a.children("div").eq(0);
                var c = b.find("p");
                b = a.find("#" + b.attr("style"));
                var d, e;
                a = {
                    text: [],
                    times: []
                };
                if (b.length) {
                    e = b.removeAttr("id").get(0).attributes;
                    if (e.length) {
                        d = {};
                        for (b = 0; b < e.length; b++) d[e[b].name.split(":")[1]] = e[b].value
                    }
                }
                for (b = 0; b < c.length; b++) {
                    var g;
                    e = {
                        start: null,
                        stop: null,
                        style: null
                    };
                    if (c.eq(b).attr("begin")) e.start = mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("begin"));
                    if (!e.start && c.eq(b - 1).attr("end")) e.start = mejs.Utility.convertSMPTEtoSeconds(c.eq(b - 1).attr("end"));
                    if (c.eq(b).attr("end")) e.stop = mejs.Utility.convertSMPTEtoSeconds(c.eq(b).attr("end"));
                    if (!e.stop && c.eq(b + 1).attr("begin")) e.stop = mejs.Utility.convertSMPTEtoSeconds(c.eq(b + 1).attr("begin"));
                    if (d) {
                        g = "";
                        for (var k in d) g += k + ":" + d[k] + ";"
                    }
                    if (g) e.style = g;
                    if (e.start == 0) e.start = 0.2;
                    a.times.push(e);
                    e = f.trim(c.eq(b).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,
                        "<a href='$1' target='_blank'>$1</a>");
                    a.text.push(e);
                    if (a.times.start == 0) a.times.start = 2
                }
                return a
            }
        },
        split2: function (a, b) {
            return a.split(b)
        }
    };
    if ("x\n\ny".split(/\n/gi).length != 3) mejs.TrackFormatParser.split2 = function (a, b) {
        var c = [],
            d = "",
            e;
        for (e = 0; e < a.length; e++) {
            d += a.substring(e, e + 1);
            if (b.test(d)) {
                c.push(d.replace(b, ""));
                d = ""
            }
        }
        c.push(d);
        return c
    }
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        contextMenuItems: [{
            render: function (a) {
                if (typeof a.enterFullScreen == "undefined") return null;
                return a.isFullScreen ? "Turn off Fullscreen" : "Go Fullscreen"
            },
            click: function (a) {
                a.isFullScreen ? a.exitFullScreen() : a.enterFullScreen()
            }
        }, {
            render: function (a) {
                return a.media.muted ? "Unmute" : "Mute"
            },
            click: function (a) {
                a.media.muted ? a.setMuted(false) : a.setMuted(true)
            }
        }, {
            isSeparator: true
        }, {
            render: function () {
                return "Download Video"
            },
            click: function (a) {
                window.location.href = a.media.currentSrc
            }
        }]
    });
    f.extend(MediaElementPlayer.prototype, {
        buildcontextmenu: function (a) {
            a.contextMenu = f('<div class="mejs-contextmenu"></div>').appendTo(f("body")).hide();
            a.container.bind("contextmenu", function (b) {
                if (a.isContextMenuEnabled) {
                    b.preventDefault();
                    a.renderContextMenu(b.clientX - 1, b.clientY - 1);
                    return false
                }
            });
            a.container.bind("click", function () {
                a.contextMenu.hide()
            });
            a.contextMenu.bind("mouseleave", function () {
                a.startContextMenuTimer()
            })
        },
        isContextMenuEnabled: true,
        enableContextMenu: function () {
            this.isContextMenuEnabled =
                true
        },
        disableContextMenu: function () {
            this.isContextMenuEnabled = false
        },
        contextMenuTimeout: null,
        startContextMenuTimer: function () {
            var a = this;
            a.killContextMenuTimer();
            a.contextMenuTimer = setTimeout(function () {
                a.hideContextMenu();
                a.killContextMenuTimer()
            }, 750)
        },
        killContextMenuTimer: function () {
            var a = this.contextMenuTimer;
            if (a != null) {
                clearTimeout(a);
                delete a
            }
        },
        hideContextMenu: function () {
            this.contextMenu.hide()
        },
        renderContextMenu: function (a, b) {
            for (var c = this, d = "", e = c.options.contextMenuItems, g = 0, k = e.length; g <
                k; g++)
                if (e[g].isSeparator) d += '<div class="mejs-contextmenu-separator"></div>';
                else {
                    var h = e[g].render(c);
                    if (h != null) d += '<div class="mejs-contextmenu-item" data-itemindex="' + g + '" id="element-' + Math.random() * 1E6 + '">' + h + "</div>"
                }
            c.contextMenu.empty().append(f(d)).css({
                top: b,
                left: a
            }).show();
            c.contextMenu.find(".mejs-contextmenu-item").each(function () {
                var o = f(this),
                    n = parseInt(o.data("itemindex"), 10),
                    p = c.options.contextMenuItems[n];
                typeof p.show != "undefined" && p.show(o, c);
                o.click(function () {
                    typeof p.click !=
                        "undefined" && p.click(c);
                    c.contextMenu.hide()
                })
            });
            setTimeout(function () {
                c.killControlsTimer("rev3")
            }, 100)
        }
    })
})(mejs.$);
(function (f) {
    f.extend(mejs.MepDefaults, {
        postrollCloseText: mejs.i18n.t("Close")
    });
    f.extend(MediaElementPlayer.prototype, {
        buildpostroll: function (a, b, c) {
            var d = this.container.find('link[rel="postroll"]').attr("href");
            if (typeof d !== "undefined") {
                a.postroll = f('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">' + this.options.postrollCloseText + '</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(c).hide();
                this.media.addEventListener("ended",
                    function () {
                        f.ajax({
                            dataType: "html",
                            url: d,
                            success: function (e) {
                                c.find(".mejs-postroll-layer-content").html(e)
                            }
                        });
                        a.postroll.show()
                    }, false)
            }
        }
    })
})(mejs.$);



/*!
 * jQuery MsgBox - for jQuery 1.3+
 * http://codecanyon.net/item/jquery-msgbox/92626?ref=aeroalquimia
 *
 * Copyright 2010, Eduardo Daniel Sada
 * You need to buy a license if you want use this script.
 * http://codecanyon.net/wiki/buying/howto-buying/licensing/
 *
 * Version: 1.3.2 (Jun 21 2011)
 *
 * Includes jQuery Easing v1.1.2
 * http://gsgd.co.uk/sandbox/jquery.easIng.php
 * Copyright (c) 2007 George Smith
 * Released under the MIT License.
 */

(function ($) {

    var ie6 = (jQuery.browser.msie && parseInt(jQuery.browser.version, 10) < 7 && parseInt(jQuery.browser.version, 10) > 4);

    if ($.proxy === undefined) {
        $.extend({
            proxy: function (fn, thisObject) {
                if (fn) {
                    proxy = function () {
                        return fn.apply(thisObject || this, arguments);
                    };
                };
                return proxy;
            }
        });
    };

    $.extend(jQuery.easing, {
        easeOutBack: function (x, t, b, c, d, s) {
            if (s == undefined) s = 1.70158;
            return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;
        }
    });

    $.extend($.expr[':'], {
        value: function (a) {
            return $(a).val();
        }
    });

    $.extend({
        MsgBoxObject: {
            defaults: {
                name: 'jquery-msgbox',
                zIndex: 10000,
                width: 420,
                height: 'auto',
                background: '#FFFFFF',
                modal: true,
                overlay: {
                    'background-color': '#000000',
                    'opacity': 0.5
                },
                showDuration: 200,
                closeDuration: 100,
                moveDuration: 500,
                shake: {
                    'distance': 10,
                    'duration': 100,
                    'transition': 'easeOutBack',
                    'loops': 2
                },
                form: {
                    'active': false,
                    'action': '#',
                    'method': 'post'
                },
                emergefrom: 'top'
            },
            options: {},
            esqueleto: {
                msgbox: [],
                wrapper: [],
                form: [],
                buttons: [],
                inputs: []
            },
            visible: false,
            i: 0,
            animation: false,

            config: function (options) {
                this.options = $.extend(true, this.options, options);
                this.overlay.element.css(this.options.overlay);
                this.overlay.options.hideOnClick = !this.options.modal;
                this.esqueleto.msgbox.css({
                    'width': this.options.width,
                    'height': this.options.height,
                    'background-color': this.options.background
                });
                this.moveBox();
            },

            overlay: {
                create: function (options) {
                    this.options = options;
                    this.element = $('<div id="' + new Date().getTime() + '"></div>');
                    this.element.css($.extend({}, {
                        'position': 'fixed',
                        'top': 0,
                        'left': 0,
                        'opacity': 0,
                        'display': 'none',
                        'z-index': this.options.zIndex
                    }, this.options.style));

                    this.element.click($.proxy(function (event) {
                        if (this.options.hideOnClick) {
                            if ($.isFunction(this.options.callback)) {
                                this.options.callback();
                            } else {
                                this.hide();
                            }
                        }
                        event.preventDefault();
                    }, this));

                    this.hidden = true;
                    this.inject();
                    return this;
                },

                inject: function () {
                    this.target = $(document.body);
                    this.target.append(this.element);

                    if (ie6) {
                        this.element.css({
                            'position': 'absolute'
                        });
                        var zIndex = parseInt(this.element.css('zIndex'));
                        if (!zIndex) {
                            zIndex = 1;
                            var pos = this.element.css('position');
                            if (pos == 'static' || !pos) {
                                this.element.css({
                                    'position': 'relative'
                                });
                            }
                            this.element.css({
                                'zIndex': zIndex
                            });
                        }
                        zIndex = ( !! (this.options.zIndex || this.options.zIndex === 0) && zIndex > this.options.zIndex) ? this.options.zIndex : zIndex - 1;
                        if (zIndex < 0) {
                            zIndex = 1;
                        }
                        this.shim = $('<iframe id="IF_' + new Date().getTime() + '" scrolling="no" frameborder=0 src=""></div>');
                        this.shim.css({
                            zIndex: zIndex,
                            position: 'absolute',
                            top: 0,
                            left: 0,
                            border: 'none',
                            width: 0,
                            height: 0,
                            opacity: 0
                        });
                        this.shim.insertAfter(this.element);
                        $('html, body').css({
                            'height': '100%',
                            'width': '100%',
                            'margin-left': 0,
                            'margin-right': 0
                        });
                    }
                },

                resize: function (x, y) {
                    this.element.css({
                        'height': 0,
                        'width': 0
                    });
                    if (this.shim) this.shim.css({
                        'height': 0,
                        'width': 0
                    });

                    var win = {
                        x: $(document).width(),
                        y: $(document).height()
                    };

                    this.element.css({
                        'width': '100%',
                        'height': y ? y : win.y
                    });

                    if (this.shim) {
                        this.shim.css({
                            'height': 0,
                            'width': 0
                        });
                        this.shim.css({
                            'position': 'absolute',
                            'left': 0,
                            'top': 0,
                            'width': this.element.width(),
                            'height': y ? y : win.y
                        });
                    }
                    return this;
                },

                show: function () {
                    if (!this.hidden) return this;
                    if (this.transition) this.transition.stop();
                    this.target.bind('resize', $.proxy(this.resize, this));
                    this.resize();
                    if (this.shim) this.shim.css({
                        'display': 'block'
                    });
                    this.hidden = false;

                    this.transition = this.element.fadeIn(this.options.showDuration, $.proxy(function () {
                        this.element.trigger('show');
                    }, this));

                    return this;
                },

                hide: function () {
                    if (this.hidden) return this;
                    if (this.transition) this.transition.stop();
                    this.target.unbind('resize');
                    if (this.shim) this.shim.css({
                        'display': 'none'
                    });
                    this.hidden = true;

                    this.transition = this.element.fadeOut(this.options.closeDuration, $.proxy(function () {
                        this.element.trigger('hide');
                        this.element.css({
                            'height': 0,
                            'width': 0
                        });
                    }, this));

                    return this;
                }
            },

            create: function () {
                this.options = $.extend(true, this.defaults, this.options);

                this.overlay.create({
                    style: this.options.overlay,
                    hideOnClick: !this.options.modal,
                    zIndex: this.options.zIndex - 1,
                    showDuration: this.options.showDuration,
                    closeDuration: this.options.closeDuration
                });

                this.esqueleto.msgbox = $('<div class="' + this.options.name + '"></div>');
                this.esqueleto.msgbox.css({
                    'display': 'none',
                    'position': 'absolute',
                    'top': 0,
                    'left': 0,
                    'width': this.options.width,
                    'height': this.options.height,
                    'z-index': this.options.zIndex,
                    'word-wrap': 'break-word',
                    '-moz-box-shadow': '0 0 15px rgba(0, 0, 0, 0.5)',
                    '-webkit-box-shadow': '0 0 15px rgba(0, 0, 0, 0.5)',
                    'box-shadow': '0 0 15px rgba(0, 0, 0, 0.5)',
                    '-moz-border-radius': '6px',
                    '-webkit-border-radius': '6px',
                    'border-radius': '6px',
                    'background-color': this.options.background
                });

                this.esqueleto.wrapper = $('<div class="' + this.options.name + '-wrapper"></div>');
                this.esqueleto.msgbox.append(this.esqueleto.wrapper);

                this.esqueleto.form = $('<form action="' + this.options.formaction + '" method="post"></form>');
                this.esqueleto.wrapper.append(this.esqueleto.form);


                this.esqueleto.wrapper.css({
                    height: (ie6 ? 80 : 'auto'),
                    'min-height': 80,
                    'zoom': 1
                });

                $('body').append(this.esqueleto.msgbox);

                this.addevents();
                return this.esqueleto.msgbox;
            },

            addevents: function () {
                $(window).bind('resize', $.proxy(function () {
                    if (this.visible) {
                        this.overlay.resize();
                        this.moveBox();
                    }
                }, this));

                $(window).bind('scroll', $.proxy(function () {
                    if (this.visible) {
                        this.moveBox();
                    }
                }, this));

                this.esqueleto.msgbox.bind('keydown', $.proxy(function (event) {
                    if (event.keyCode == 27) {
                        this.close(false);
                    }
                }, this));

                this.esqueleto.form.bind('submit', $.proxy(function (event) {
                    $('input[type=submit]:first, button[type=submit]:first, button:first', this.esqueleto.form).trigger('click');
                    if (!options.form.active) {
                        event.preventDefault();
                    }
                }, this));

                // heredamos los eventos, desde el overlay:
                this.overlay.element.bind('show', $.proxy(function () {
                    $(this).triggerHandler('show');
                }, this));
                this.overlay.element.bind('hide', $.proxy(function () {
                    $(this).triggerHandler('close');
                }, this));

            },

            show: function (txt, options, callback) {
                var types = ['alert', 'info', 'error', 'prompt', 'confirm'];

                this.esqueleto.msgbox.queue(this.options.name, $.proxy(function (next) {

                    options = $.extend(true, {
                        type: 'alert',
                        form: {
                            'active': false
                        }
                    }, options || {});

                    if (typeof options.buttons === "undefined") {
                        if (options.type == 'confirm' || options.type == 'prompt') {
                            var buttons = [{
                                type: 'submit',
                                value: 'Accept'
                            }, {
                                type: 'cancel',
                                value: 'Cancel'
                            }];
                        } else {
                            var buttons = [{
                                type: 'submit',
                                value: 'Accept'
                            }];
                        };
                    } else {
                        var buttons = options.buttons;
                    };

                    if (typeof options.inputs === "undefined" && options.type == 'prompt') {
                        var inputs = [{
                            type: 'text',
                            name: 'prompt',
                            value: ''
                        }];
                    } else {
                        var inputs = options.inputs;
                    };

                    this.callback = $.isFunction(callback) ? callback : function (e) {};

                    if (typeof inputs !== "undefined") {
                        this.esqueleto.inputs = $('<div class="' + this.options.name + '-inputs"></div>');
                        this.esqueleto.form.append(this.esqueleto.inputs);

                        $.each(inputs, $.proxy(function (i, input) {
                            if (input.type == 'checkbox') {
                                iLabel = input.label ? '<label class="' + this.options.name + '-label">' : '';
                                fLabel = input.label ? input.label + '</label>' : '';
                                input.value = input.value === undefined ? '1' : input.value;
                                iName = input.name === undefined ? this.options.name + '-label-' + i : input.name;
                                this.esqueleto.inputs.append($(iLabel + '<input type="' + input.type + '" style="display:inline; width:auto;" name="' + iName + '" value="' + input.value + '" autocomplete="off"/> ' + fLabel));
                            } else {
                                iLabel = input.label ? '<label class="' + this.options.name + '-label">' + input.label : '';
                                fLabel = input.label ? '</label>' : '';
                                input.value = input.value === undefined ? '' : input.value;
                                iRequired = input.required === undefined || input.required == false ? '' : 'required="true"';
                                iName = input.name === undefined ? this.options.name + '-label-' + i : input.name;
                                this.esqueleto.inputs.append($(iLabel + '<input type="' + input.type + '" name="' + iName + '" value="' + input.value + '" autocomplete="off" ' + iRequired + '/>' + fLabel));
                            }
                        }, this));
                    }

                    this.esqueleto.buttons = $('<div class="' + this.options.name + '-buttons"></div>');
                    this.esqueleto.form.append(this.esqueleto.buttons);

                    if (options.form.active) {
                        this.esqueleto.form.attr('action', options.form.action === undefined ? '#' : options.form.action);
                        this.esqueleto.form.attr('method', options.form.method === undefined ? 'post' : options.form.method);
                        this.options.form.active = true;
                    } else {
                        this.esqueleto.form.attr('action', '#');
                        this.esqueleto.form.attr('method', 'post');
                        this.options.form.active = false;
                    }

                    if (options.type != 'prompt') {
                        $.each(buttons, $.proxy(function (i, button) {
                            if (button.type == 'submit') {
                                this.esqueleto.buttons.append($('<button class="button light classic" type="submit">' + button.value + '</button>').bind('click', $.proxy(function (e) {
                                    this.close(button.value);
                                    e.preventDefault();
                                }, this)));
                            } else if (button.type == 'cancel') {
                                this.esqueleto.buttons.append($('<button class="button light classic" type="button">' + button.value + '</button>').bind('click', $.proxy(function (e) {
                                    this.close(false);
                                    e.preventDefault();
                                }, this)));
                            }
                        }, this));
                    } else if (options.type == 'prompt') {
                        $.each(buttons, $.proxy(function (i, button) {
                            if (button.type == 'submit') {
                                this.esqueleto.buttons.append($('<button type="submit">' + button.value + '</button>').bind('click', $.proxy(function (e) {
                                    if ($('input[required="true"]:not(:value)').length > 0) {
                                        $('input[required="true"]:not(:value):first').focus();
                                        this.shake();
                                    } else if (this.options.form.active) {
                                        return true;
                                    } else {
                                        this.close(this.toArguments($('input', this.esqueleto.inputs)));
                                    }

                                    e.preventDefault();
                                }, this)));
                            } else if (button.type == 'cancel') {
                                this.esqueleto.buttons.append($('<button type="button">' + button.value + '</button>').bind('click', $.proxy(function (e) {
                                    this.close(false);
                                    e.preventDefault();
                                }, this)));
                            };
                        }, this));
                    };

                    this.esqueleto.form.prepend(txt);

                    $.each(types, $.proxy(function (i, e) {
                        this.esqueleto.wrapper.removeClass(this.options.name + '-' + e);
                    }, this));
                    this.esqueleto.wrapper.addClass(this.options.name + '-' + options.type);

                    this.moveBox(); // set initial position

                    this.visible = true;
                    this.overlay.show();

                    this.esqueleto.msgbox.css({
                        display: 'block',
                        left: (($(document).width() - this.options.width) / 2)
                    });

                    this.moveBox();

                    setTimeout($.proxy(function () {
                        var b = $('input, button', this.esqueleto.msgbox);
                        if (b.length) {
                            b.get(0).focus();
                        }
                    }, this), this.options.moveDuration);
                }, this));


                this.i++;

                if (this.i == 1) {
                    this.esqueleto.msgbox.dequeue(this.options.name);
                }

            },

            toArguments: function (array) {
                return $.map(array, function (a) {
                    return $(a).val();
                });
            },

            moveBox: function () {
                var size = {
                    x: $(window).width(),
                    y: $(window).height()
                };
                var scroll = {
                    x: $(window).scrollLeft(),
                    y: $(window).scrollTop()
                };
                var height = this.esqueleto.msgbox.outerHeight();
                var y = 0;
                var x = 0;

                // vertically center
                y = scroll.x + ((size.x - this.options.width) / 2);

                if (this.options.emergefrom == "bottom") {
                    x = (scroll.y + size.y + 80);
                } else // top
                {
                    x = (scroll.y - height) - 80;
                }

                if (this.visible) {

                    if (this.animation) {
                        this.animation.stop;
                    }

                    this.animation = this.esqueleto.msgbox.animate({
                        left: y,
                        top: scroll.y + ((size.y - height) / 2)
                    }, {
                        duration: this.options.moveDuration,
                        queue: false,
                        easing: 'easeOutBack'
                    });

                } else {
                    this.esqueleto.msgbox.css({
                        top: x,
                        left: y
                    });
                }
            },

            close: function (param) {
                this.esqueleto.msgbox.css({
                    display: 'none',
                    top: 0
                });

                this.visible = false;

                if ($.isFunction(this.callback)) {
                    this.callback.apply(this, $.makeArray(param));
                }

                setTimeout($.proxy(function () {
                    this.i--;
                    this.esqueleto.msgbox.dequeue(this.options.name);
                }, this), this.options.closeDuration);

                if (this.i == 1) {
                    this.overlay.hide();
                }

                this.moveBox();

                this.esqueleto.form.empty();
            },

            shake: function () {
                var x = this.options.shake.distance;
                var d = this.options.shake.duration;
                var t = this.options.shake.transition;
                var o = this.options.shake.loops;
                var l = this.esqueleto.msgbox.position().left;
                var e = this.esqueleto.msgbox;

                for (i = 0; i < o; i++) {
                    e.animate({
                        left: l + x
                    }, d, t);
                    e.animate({
                        left: l - x
                    }, d, t);
                };

                e.animate({
                    left: l + x
                }, d, t);
                e.animate({
                    left: l
                }, d, t);
            }

        },

        msgbox: function (txt, options, callback) {
            if (typeof txt == "object") {
                $.MsgBoxObject.config(txt);
            } else {
                return $.MsgBoxObject.show(txt, options, callback);
            }
        }

    });

    // $(function () {
    //     if (parseFloat($.fn.jquery) > 1.2) {
    //         $.MsgBoxObject.create();
    //     } else {
    //         throw "The jQuery version that was loaded is too old. MsgBox requires jQuery 1.3+";
    //     }
    // });
})(jQuery);

jQuery.base64 = (function ($) {

    var _PADCHAR = "=",
        _ALPHA = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2b/index.html",
        _VERSION = "1.0";


    function _getbyte64(s, i) {
        // This is oddly fast, except on Chrome/V8.
        // Minimal or no improvement in performance by using a
        // object with properties mapping chars to value (eg. 'A': 0)

        var idx = _ALPHA.indexOf(s.charAt(i));

        if (idx === -1) {
            throw "Cannot decode base64";
        }

        return idx;
    }


    function _decode(s) {
        var pads = 0,
            i,
            b10,
            imax = s.length,
            x = [];

        s = String(s);

        if (imax === 0) {
            return s;
        }

        if (imax % 4 !== 0) {
            throw "Cannot decode base64";
        }

        if (s.charAt(imax - 1) === _PADCHAR) {
            pads = 1;

            if (s.charAt(imax - 2) === _PADCHAR) {
                pads = 2;
            }

            // either way, we want to ignore this last block
            imax -= 4;
        }

        for (i = 0; i < imax; i += 4) {
            b10 = (_getbyte64(s, i) << 18) | (_getbyte64(s, i + 1) << 12) | (_getbyte64(s, i + 2) << 6) | _getbyte64(s, i + 3);
            x.push(String.fromCharCode(b10 >> 16, (b10 >> 8) & 0xff, b10 & 0xff));
        }

        switch (pads) {
        case 1:
            b10 = (_getbyte64(s, i) << 18) | (_getbyte64(s, i + 1) << 12) | (_getbyte64(s, i + 2) << 6);
            x.push(String.fromCharCode(b10 >> 16, (b10 >> 8) & 0xff));
            break;

        case 2:
            b10 = (_getbyte64(s, i) << 18) | (_getbyte64(s, i + 1) << 12);
            x.push(String.fromCharCode(b10 >> 16));
            break;
        }

        return x.join("");
    }


    function _getbyte(s, i) {
        var x = s.charCodeAt(i);

        if (x > 255) {
            throw "INVALID_CHARACTER_ERR: DOM Exception 5";
        }

        return x;
    }


    function _encode(s) {
        if (arguments.length !== 1) {
            throw "SyntaxError: exactly one argument required";
        }

        s = String(s);

        var i,
            b10,
            x = [],
            imax = s.length - s.length % 3;

        if (s.length === 0) {
            return s;
        }

        for (i = 0; i < imax; i += 3) {
            b10 = (_getbyte(s, i) << 16) | (_getbyte(s, i + 1) << 8) | _getbyte(s, i + 2);
            x.push(_ALPHA.charAt(b10 >> 18));
            x.push(_ALPHA.charAt((b10 >> 12) & 0x3F));
            x.push(_ALPHA.charAt((b10 >> 6) & 0x3f));
            x.push(_ALPHA.charAt(b10 & 0x3f));
        }

        switch (s.length - imax) {
        case 1:
            b10 = _getbyte(s, i) << 16;
            x.push(_ALPHA.charAt(b10 >> 18) + _ALPHA.charAt((b10 >> 12) & 0x3F) + _PADCHAR + _PADCHAR);
            break;

        case 2:
            b10 = (_getbyte(s, i) << 16) | (_getbyte(s, i + 1) << 8);
            x.push(_ALPHA.charAt(b10 >> 18) + _ALPHA.charAt((b10 >> 12) & 0x3F) + _ALPHA.charAt((b10 >> 6) & 0x3f) + _PADCHAR);
            break;
        }

        return x.join("");
    }


    return {
        decode: _decode,
        encode: _encode,
        VERSION: _VERSION
    };

}(jQuery));

(function ($) {

    /* Minimizing function - me */
    $.fn.minimize = function () {

        var $content = $($(this).data('content'));

        $(this).data('opened', '1');
        $(this).data('minheight', $content.find('header').outerHeight());

        $(this).click(function () {

            if ($(this).data('opened') == '1') {

                $(this).data('opened', '0');
                $content.stop().animate({
                    'height': $(this).data('minheight')
                }, $(this).data('speed'), 'easeOutQuart');
                $(this).addClass('minimized');

            } else {

                $(this).data('opened', '1');
                var getH = $content.css('height', 'auto').height();
                $content.css('height', $(this).data('minheight')).stop().animate({
                    'height': getH
                }, $(this).data('speed'), 'easeInQuart', function () {
                    $content.height('auto');
                });
                $(this).removeClass('minimized');

            }

            return false;

        });

    }

    /* Easy Toggle component - me */
    $.fn.toggle = function () {

        var $selToggle = $(this).children('li').eq(0);
        $selToggle.addClass('opened');

        $(this).find('li').click(function () {
            if (!$(this).hasClass('opened')) {
                openBox($selToggle);
                openBox($(this));
            }
            return false;
        });

        $(this).find('li').children('a').click(function () {
            if (!$(this).parent().hasClass('opened')) {
                openBox($selToggle);
                openBox($(this).parent());
            }
            return false;
        });

        $(this).find('div').find('a').click(function () {
            document.location.href = $(this).attr('href');
            return false;
        });

        function openBox($li) {
            $selToggle = $li;
            if (!$li.hasClass('opened')) {
                $li.addClass('opened')
                    .css('height', 'auto')
                    .find('div').slideDown(300);
            } else {
                $li.removeClass('opened')
                    .find('div').slideUp(300, function () {
                        $(this).parent().css({
                            'height': 30
                        });
                    });
            }
        }

    }

    /* Easy Tabs component - me */
    $.fn.tabs = function (tabsContent) {

        var $tabs = $(this).find(tabsContent);
        var $selButton = $(this).find('ul.filters li:first-child a');
        var $selTab = $(this).find('div.tabsContent div:first-child, div.postTabs div:first-child');
        $selButton.addClass('selected');
        $selTab.addClass('selected');

        $(this).find('ul.filters').find('a').click(function () {

            $selButton.removeClass('selected');
            $selButton = $(this);
            $selButton.addClass('selected');

            $selTab.removeClass('selected');
            $selTab.fadeOut(200);
            $selTab = $tabs.children('div').eq($selButton.parent().index());
            $selTab.addClass('selected');
            $selTab.delay(200).fadeIn(350);

            return false;

        });

    }

    /* Easy Testimonials component - me */
    $.fn.testimonials = function () {

        var index = 0;
        var $list = $(this).children('ul').children();

        $(this).find('a.btnNext').click(function () {
            $list.eq(index).fadeOut(200);
            if (++index == $list.length) index = 0;
            $list.eq(index).delay(200).fadeIn(200);
            return false;
        });

        $(this).find('a.btnPrev').click(function () {
            $list.eq(index).fadeOut(200);
            if (--index < 0) index = $list.length - 1;
            $list.eq(index).delay(200).fadeIn(200);
            return false;
        });

    }

    /* Portfolio Grid Viewer - me (codename:mars) */
    $.fn.marsPortfolio = function (autoCloseSidebar) {

        var $folio = $(this);
        var $body = $('body');
        var $items = $folio.children('a.folioItem');
        var $projectHolder = $('#content > div');
        var $projectHover = $('#projectHover');
        var $btnNext = $projectHover.find('.btnNext');
        var $btnPrev = $projectHover.find('.btnPrev');
        var $btnClose = $projectHover.find('.btnClose');
        var $project = null;
        var $cr1 = $cr2 = $cr3 = $cr4 = $cr5 = null;

        $items.append('<span class="folioPlus"></span>');
        $items.append('<span class="folioShadow"></span>');

        var sP = ($body.hasClass('admin-bar') ? 28 : 0);

        var itemWidth = iW = 360;
        var itemHeight = iH = 270;
        var itemPadding = 70;

        var zI = 10,
            maxP = (itemWidth * itemHeight) * $items.size(),
            firstProject = true,
            fSafe = true,
            fHash = true,
            byHash = false,
            oTitle = document.title,
            catArr = new Array(),
            sTop = 0;

        var mobileM = ($('#mobileCheck').css('display') == 'block' ? true : false);
        var touchM = "ontouchstart" in window;

        /* Setup Sorting */

        var k1 = 1000000,
            k2 = 0;
        $items.each(function () {
            var $item = $(this);
            $folio.find('.folioCategories li').each(function () {
                if ($item.data('type') == $(this).text())
                    $item.data($(this).text(), --k1);
                else
                    $item.data($(this).text(), --k2);
            });
        });

        var sortingObject = new Object(),
            oi = 0;
        $folio.find('.folioCategories li').each(function () {
            var type = $(this).text();
            catArr.push(type);
            sortingObject[type] = function ($elem) {
                return parseInt($elem.data(type));
            }
        });

        /* Setup filtering */

        $selectedFilter = $('li.selected a[data-filter]').parent().parent();
        $('a[data-filter], option[data-filter]').click(function (event) {

            var $this = $(this);

            if ($projectHolder.hasClass('openedP')) {
                closeAndStay();
                setTimeout(function () {
                    rightSorting($this);
                }, 501);
            } else {
                rightSorting($this);
            }

            event.preventDefault();
            return false;

        });

        function rightSorting($this) {

            if ($this.attr('title') != 'nofilter') {

                $items.addClass('noHover');
                setTimeout(function () {
                    $items.removeClass('noHover');
                }, 1000);

                $('html,body').animate({
                    scrollTop: 0
                }, 500, 'easeInQuad');

                var selector = $this.data('filter');

                if (selector != '*')
                    document.location.hash = '#/category/' + selector;
                else
                    document.location.hash = '#';

                $selectedFilter.removeClass('selected');
                $selectedFilter = $this.parent().parent();
                $selectedFilter.addClass('selected');

                $items.removeClass('disableResize');

                $folio.width($(document).width() - sideW);

                if (selector != '*') {

                    $folio.isotope({
                        sortBy: selector,
                        sortAscending: false
                    });

                    $items.each(function () {
                        $(this).bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);
                        if ($(this).hasClass(selector)) {
                            $(this).removeClass('disabled').animate({
                                'opacity': 1
                            }, 300);
                        } else {
                            $(this).addClass('disabled').animate({
                                'opacity': .1
                            }, 300);
                            $(this).unbind('mouseover').unbind('mouseout').unbind('click');
                            $(this).click(function () {
                                return false;
                            })
                        }
                    });

                } else {

                    $folio.isotope({
                        sortBy: 'original-order',
                        sortAscending: true
                    });

                    $items.removeClass('disabled').animate({
                        'opacity': 1
                    }, 300);
                    $items.bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);

                }

            }

        }


        /* Setup hash init & change */
        var $itemsToSearch;
        if ($('body').hasClass('page-template-template-portfolio-paged-php')) {
            $itemsToSearch = $('#allItems').children('a');
        } else if ($('body').hasClass('page-template-template-videoportfolio.html')) {
            $itemsToSearch = $('#allItems').children('a');
        } else {
            $itemsToSearch = $items;
        }

        var init = false;
        checkHash();

        if (window.addEventListener) window.addEventListener('hashchange', checkHash, false);

        function checkHash() {
            if (fHash || byHash) {
                fHash = false;
                if (document.location.hash != '' && document.location.hash != '#') {

                    if (document.location.hash.indexOf('category') < 0) {

                        $itemsToSearch.each(function () {
                            if (document.location.hash == '#/' + $(this).data('name')) {
                                if (!$projectHolder.hasClass('openedP')) {
                                    openProject($(this).attr('href'), $(this).data('name'));
                                    byHash = true;
                                } else {
                                    closeAndOpen($(this).attr('href'), $(this).data('name'));
                                    byHash = true;
                                }
                                init = true;
                            }
                        });

                    } else {

                        var cat = document.location.hash.slice(document.location.hash.indexOf('category') + 9, document.location.hash.length);

                        if ($.inArray(cat, catArr) >= 0) {
                            resizeFolio();
                            $('a[data-filter=' + cat + ']').trigger('click');
                        }

                    }

                } else if ((document.location.hash == '#' || document.location.hash == '') && $projectHolder.hasClass('openedP')) {
                    closeAndStay();
                    byHash = true;
                }
            } else {
                fHash = true;
            }
        }

        /* Setup hover */

        $items.bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);

        function itemOut() {

            if (!touchM && !mobileM && !$(this).hasClass('noHover')) {
                var $this = $(this);
                /**** Return opacity to 100% on img ********/

                $(this).children('img').stop().animate({
                    'opacity': 1,
                    'marginTop': 0
                }, 200, 'easeOutQuad');

                /**** End opacity change *******/

                $(this).children('span.folioPlus').stop().animate({
                    'opacity': 0,
                    'bottom': -53
                }, 200, 'easeOutQuad');
                $(this).children('div.folioTextHolder').stop().animate({
                    'height': 0,
                    'bottom': 0
                }, 200, 'easeOutQuad');
                $(this).find('div.folioText').stop().animate({
                    'opacity': 0,
                    'top': -150
                }, 200, 'easeOutQuad');
                $(this).children('span.folioShadow').stop().animate({
                    'opacity': 0,
                    'marginTop': 0,
                    'height': '0'
                }, 300, 'easeOutQuad', function () {
                    $this.css('zIndex', 1);
                });
            }
        }

        function itemOver() {
            if (!touchM && !mobileM && !$(this).hasClass('noHover')) {
                $(this).css('zIndex', ++zI);

                /*********  Remove animation upwards on each portfolio thumbnail  ********/

                /*$(this).children('img.folioThumb').stop().animate({'opacity': 1, 'marginTop': -70}, 300, 'easeOutQuad');*/

                /**********  End remove animation upwards *************/

                $(this).children('span.folioPlus').stop().animate({
                    'opacity': 1,
                    'bottom': iH / 2 - 30
                }, 300, 'easeOutQuad');
                $(this).children('span.folioShadow').stop().animate({
                    'opacity': 1,
                    'marginTop': -70,
                    'height': iH + 140
                }, 300, 'easeOutQuad');
                $(this).children('div.folioTextHolder').stop().animate({
                    'height': iH / 2 + itemPadding,
                    'bottom': -70
                }, 300, 'easeOutQuad');
                $(this).find('div.folioText').stop().animate({
                    'opacity': 1,
                    'top': 0
                }, 350, 'easeOutSine');
            }

        }

        function itemClick() {

            if ($(this).data('external') != 'no') {

                document.location = $(this).data('external');

            } else {

                if (!$(this).hasClass('disabled')) {

                    $(this).addClass('disabled');
                    var $this = $(this);

                    setTimeout(function () {
                        $this.removeClass('disabled');
                    }, 500);

                    byHash = false;
                    fHash = false;
                    openProject($(this).attr('href'), $(this).data('name'));

                    $(this).children('img').stop().animate({
                        'opacity': .5,
                        'marginTop': 0
                    }, 100, 'easeOutQuad');
                    $(this).children('span.folioPlus').stop().animate({
                        'opacity': 0,
                        'bottom': -53
                    }, 100, 'easeOutQuad');
                    $(this).children('div.folioTextHolder').stop().animate({
                        'height': 0,
                        'bottom': 0
                    }, 100, 'easeOutQuad');
                    $(this).find('div.folioText').stop().animate({
                        'opacity': 0,
                        'top': -150
                    }, 100, 'easeOutQuad');
                    $(this).children('span.folioShadow').stop().animate({
                        'opacity': 0,
                        'marginTop': 0,
                        'height': '0'
                    }, 100, 'easeOutQuad');

                    if (mobileM)
                        $('html,body').animate({
                            scrollTop: 0
                        }, 500, 'easeInQuad');

                }

            }

            return false;

        }

        function itemFuzzyClick() {
            return false;
        }

        $('#projectHover').click(function () {
            closeAndStay();
            return false;
        })

        /* Setup Resize */

        var sideW = $('body').hasClass('Stick') ? 280 : 0;
        $.topBoss = $('body').hasClass('Stick') ? 'opened' : 'closed';

        resizeFolio();
        $(window).resize(function () {
            resizeFolio();
        });

        $('#sidebar #close').click(function () {
            resizeFolio();
        });

        function resizeFolio() {

            sideW = $.topBoss == 'closed' ? 0 : 280;

            mobileM = ($('#mobileCheck').css('display') == 'block' ? true : false);

            if (mobileM) sideW = 0;

            var sW = $(document).width() - sideW,
                sH = $(window).height();

            /******  Changed the itemWidth and itemHeight values to gallery size  *********/

            if ($(document).width() < 640) {
                itemWidth = 150;
                itemHeight = 112;
            } else {
                itemWidth = 150;
                itemHeight = 112;
            }

            /*******  End Size Change  **********/

            iW = Math.floor(sW / Math.ceil(sW / itemWidth));
            iH = Math.floor(iW / 4 * 3);
            $items.css({
                'width': iW,
                'height': iH
            });

            if (iW < 260)
                $items.find('p').css('height', '50');
            else
                $items.find('p').css('height', 'auto');

            $folio.width(sW);

            $folio.isotope({
                itemSelector: '.folioItem',
                getSortData: sortingObject,
                animationEngine: 'jquery',
                resizable: false
            });

            $items.addClass('disableResize');

            if (!mobileM)
                $projectHover.height($(document).height() - 140 - sP);
            else
                $projectHover.height($(document).height());

            if (mobileM && $cr1 != null && $cr1.length > 0) {
                $cr1.width($(window).width());
                $cr1.height($(window).width() * 0.8);
                $cr2.width($(window).width());
                $cr2.height($(window).width() * 0.8);
                $cr3.width($(window).width());
                $cr3.height($(window).width() * 0.8);
                $cr5.width($(window).width());
                $cr5.height($(window).width() * 0.8);
                $cr4.css('marginTop', $cr1.height());
            } else if (!mobileM && $cr1 != null && $cr1.length > 0) {
                $cr1.width('600px');
                $cr1.height('480px');
                $cr2.width('600px');
                $cr2.height('480px');
                $cr3.width('600px');
                $cr3.height('480px');
                $cr5.width('600px');
                $cr5.height('480px');
                $cr4.css('marginTop', 'auto');
            }

            if ($project)
                if ($projectHolder.hasClass('openedP')) {
                    if (sH > $project.height() + 280 + sP)
                        $project.css('marginTop', (sH - $project.height() - 280 - sP) / 2);
                    else if (sH < $projectHolder.outerHeight() + 280 + sP && $project.css('marginTop') > 0)
                        $project.css('marginTop', 0);
                }

        }

        /* Setup navigation buttons */

        $btnNext.click(function () {
            if (fSafe) {
                fSafe = false;
                byHash = false;
                closeAndOpen($(this).attr('href'), $(this).data('name'));
            }
            return false;
        });

        $btnPrev.click(function () {
            if (fSafe) {
                fSafe = false;
                byHash = false;
                closeAndOpen($(this).attr('href'), $(this).data('name'));
            }
            return false;
        });

        $btnClose.click(function () {
            byHash = false;
            closeAndStay();
            return false;
        });

        /* Setup loading */

        function openProject(href, title) {

            sTop = $('html').scrollTop() == 0 ? $('body').scrollTop() : $('html').scrollTop();

            if (firstProject) {
                firstProject = false;

                $projectHolder.addClass('openedP');

                $body.css('overflowY', 'scroll');

                var pHH2 = (mobileM ? $(document).height() : $(document).height() - 140 - sP);

                $projectHover.height(0).fadeIn(0).animate({
                    'height': pHH2
                }, 200, 'easeInQuad', function () {
                    continueLoading(href);
                    $items.css('zIndex', 6);
                });

            } else {
                $projectHolder.addClass('openedP');
                continueLoading(href);
            }

            fHash = false;
            document.location.hash = '#/' + title;

        }

        function continueLoading(href) {
            $.ajax({
                url: href,
                dataType: 'html'
            }).done(function (data) {

                var pwd = $(data).find('#pwd').text();

                if (pwd == '') {

                    $btnNext.css('display', '');
                    $btnPrev.css('display', '');
                    $btnClose.css('display', '');

                    finishLoading(data);

                } else {

                    $btnNext.css('display', 'none');
                    $btnPrev.css('display', 'none');
                    $btnClose.css('display', 'none');

                    $.msgbox('This is a protected post. In order to view it, please enter a password:', {
                        type: 'prompt',
                        buttons: [{
                            type: 'submit',
                            value: 'Ok'
                        }, {
                            type: 'cancel',
                            value: 'Cancel'
                        }]
                    }, function (event) {
                        if (event == $.base64.decode(pwd))
                            finishLoading(data);
                        else
                            closeAndStay();
                    });

                }

            });

        }

        function finishLoading(data) {
            //console.log(data);

            $project = $(data).find('.project');

            $projectHolder.prepend($project);


            document.title = $(data).find('#title').text();

            if ($('#postSlider').length > 0) {
                $("#postSlider").slides({
                    effect: 'fade',
                    pagination: false,
                    next: 'sliderBtnNext',
                    prev: 'sliderBtnPrev',
                    generatePagination: false,
                    customPagination: 'sliderPagination',
                    crossfade: true,
                    animationStart: function () {
                        $('#postSlider').find('iframe').each(function () {
                            src = $(this).attr('src');
                            $(this).attr('src', src);
                        })
                    }
                });
            }

            //twttr.widgets.load();

            $('video').mediaelementplayer({
                alwaysShowControls: true,
                iPadUseNativeControls: true,
                iPhoneUseNativeControls: true,
                AndroidUseNativeControls: true,
                enableKeyboard: false,
                pluginPath: theme_objects.base + '/js/mediaelement/'
            });

            if ($('.nano > .content').css('position', 'static').height() > 436) {
                $('.nano > .content').css('overflowY', 'scroll');
                $('.nano').nanoScroller();
            }
            $('.nano > .content').css('position', 'absolute');

            if (touchM) {
                $('#postSlider').touchSwipe(function (dir) {
                    if (dir == 'right')
                        $('#postSlider .sliderBtnPrev').trigger('click');
                    else if (dir == 'left')
                        $('#postSlider .sliderBtnNext').trigger('click');
                })
            }

            $cr1 = $('#postSlider');
            $cr2 = $('#postSlider .slides_control');
            $cr3 = $('#postSlider .slides_control > div');
            $cr4 = $('section.projectContent');
            $cr5 = $('#postSlider .slides_container');

            if ($('.toggle').length > 0) $('.toggle').each(function () {
                $(this).toggle();
            });
            if ($('.tabs').length > 0) $('.tabs').each(function () {
                $(this).tabs($(this).find('div.tabsContent'))
            });

            resizeFolio();

            $project.find('a').hoverFadeColor();
            $project.find('.close').bind('click', closeAndStay);

            var $prevLink = $project.find('#nextProject a');
            var $nextLink = $project.find('#previousProject a');

            if ($prevLink.length > 0)
                $btnPrev.removeClass('disabled').attr('href', $prevLink.attr('href')).data('name', $prevLink.text());
            else
                $btnPrev.addClass('disabled');

            if ($nextLink.length > 0)
                $btnNext.removeClass('disabled').attr('href', $nextLink.attr('href')).data('name', $nextLink.text());
            else
                $btnNext.addClass('disabled');

            $project.css('left', '150%').stop().animate({
                'left': '50%'
            }, 500, 'easeInOutCubic', function () {
                fSafe = true;
            });

        }

        function closeAndOpen(href, title) {
            $project.stop().animate({
                'left': '-50%'
            }, 300, 'easeOutQuart', function () {
                $project.remove();
                openProject(href, title);
            });
        }

        function closeAndStay() {

            document.location.hash = '#';
            document.title = oTitle;

            $('html,body').animate({
                scrollTop: sTop
            }, 500, 'easeInQuad');

            if ($project != null)

                $project.stop().animate({
                    'left': '-50%'
                }, 500, 'easeOutQuart', function () {
                    $project.remove();
                    resizeFolio();

                    $body.css('overflowY', 'auto');
                    $projectHolder.removeClass('openedP');
                    $items.css('zIndex', 10);
                    $folio.css('width', 'auto');
                });

            $projectHover.delay(200).fadeOut(200);
            firstProject = true;

        }

    }

    /* Gallery Grid Viewer - me (codename:mars) */
    $.fn.marsGallery = function (autoCloseSidebar) {

        if ($('body').hasClass('page-template-template-gallery-php'))
            $('#content').append('<ul id="supersized"></ul>');

        var $folio = $(this);
        var $body = $('body');
        var $items = $folio.children('a.folioItem');
        var $projectHolder = $('#content > div');
        var $projectHover = $('#projectHover');
        var $projectControls = $('#supersizedControls');
        var $supersized = $('#supersized');
        var $btnNext = $('a.btnNext');
        var $btnPrev = $('a.btnPrev');
        var $project = null;

        var sP = ($body.hasClass('admin-bar') ? 28 : 0);

        $items.append('<span class="folioPlus"></span>');
        $items.append('<span class="folioShadow"></span>');

        var itemWidth = iW = 240;
        var itemHeight = iH = 180;
        var itemPadding = 70;

        var zI = 10,
            maxP = (itemWidth * itemHeight) * $items.size(),
            firstProject = true,
            fSafe = true,
            fHash = true,
            byHash = false,
            oTitle = document.title,
            catArr = new Array(),
            sTop = 0;

        var mobileM = ($('#mobileCheck').css('display') == 'block' ? true : false);
        var touchM = "ontouchstart" in window;

        /* Setup Sorting */

        var k1 = 1000000,
            k2 = 0;
        $items.each(function () {
            var $item = $(this);
            $folio.find('.folioCategories li').each(function () {
                if ($item.data('type') == $(this).text())
                    $item.data($(this).text(), --k1);
                else
                    $item.data($(this).text(), --k2);
            });
        });

        var sortingObject = new Object(),
            oi = 0;
        $folio.find('.folioCategories li').each(function () {
            var type = $(this).text();
            catArr.push(type);
            sortingObject[type] = function ($elem) {
                return parseInt($elem.data(type));
            }
        });

        /* Setup filtering */

        $selectedFilter = $('li.selected a[data-filter]').parent().parent();
        $('a[data-filter]').click(function (event) {

            $('html,body').animate({
                scrollTop: 0
            }, 500, 'easeInQuad');

            if ($folio.hasClass('galleryOpened')) {
                setTimeout(closeAndStay, 1000);
            };

            $items.addClass('noHover');
            setTimeout(function () {
                $items.removeClass('noHover');
            }, 1000);

            var selector = $(this).data('filter');

            if (selector != '*')
                document.location.hash = '#/category/' + selector;
            else
                document.location.hash = '#';

            $selectedFilter.removeClass('selected');
            $selectedFilter = $(this).parent().parent();
            $selectedFilter.addClass('selected');

            $items.removeClass('disableResize');

            if (selector != '*') {

                $folio.isotope({
                    sortBy: selector,
                    sortAscending: false
                });

                $items.each(function () {
                    if ($(this).hasClass(selector)) {
                        $(this).removeClass('disabled').animate({
                            'opacity': 1
                        }, 300);
                        $(this).unbind().bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);
                    } else {
                        $(this).addClass('disabled').animate({
                            'opacity': .1
                        }, 300);
                        $(this).unbind();
                        $(this).click(function () {
                            return false;
                        })
                    }
                });

            } else {

                $folio.isotope({
                    sortBy: 'original-order',
                    sortAscending: true
                });

                $items.removeClass('disabled').animate({
                    'opacity': 1
                }, 300);
                $items.unbind().bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);

            }

            event.preventDefault();
            return false;

        });

        /* Setup hash init & change */

        var init = false;
        checkHash();

        if (window.addEventListener) window.addEventListener('hashchange', checkHash, false);

        function checkHash() {
            if (fHash || byHash) {
                fHash = false;
                if (document.location.hash != '' && document.location.hash != '#') {

                    if (document.location.hash.indexOf('category') < 0) {

                        $items.each(function () {
                            if (document.location.hash == '#/' + $(this).data('name')) {
                                if (!$folio.hasClass('galleryOpened')) {
                                    openProject($(this).attr('href'), $(this).data('name'));
                                    byHash = true;
                                } else {
                                    closeAndOpen($(this).attr('href'), $(this).data('name'));
                                    byHash = true;
                                }
                                init = true;
                            }
                        });

                    } else {

                        var cat = document.location.hash.slice(document.location.hash.indexOf('category') + 9, document.location.hash.length);

                        if ($.inArray(cat, catArr) >= 0) {
                            resizeFolio();
                            $('a[data-filter=' + cat + ']').trigger('click');
                        }

                    }

                } else if ((document.location.hash == '#' || document.location.hash == '') && $folio.hasClass('galleryOpened')) {
                    closeAndStay();
                    byHash = true;
                }
            } else {
                fHash = true;
            }
        }

        /* Setup hover */

        $items.bind('mouseover', itemOver).bind('mouseout', itemOut).bind('click', itemClick);

        function itemOver() {

            if (!touchM && !mobileM && !$(this).hasClass('noHover')) {

                var icW = iW;
                var icH = iH;

                $(this).css('zIndex', ++zI);

                $(this).children('img.folioThumb').stop().animate({
                    'opacity': 1
                }, 300, 'easeOutQuad');
                $(this).children('span.folioPlus').stop().animate({
                    'opacity': 1,
                    'top': icH / 2 - 45
                }, 300, 'easeOutQuad');
                $(this).children('span.folioShadow').stop().animate({
                    'opacity': 1
                }, 300, 'easeOutQuad');
                $(this).children('div.folioTextHolder').stop().animate({
                    'opacity': 1
                }, 300, 'easeOutQuad');
                $(this).find('div.folioText').stop().animate({
                    'opacity': 1,
                    'top': icH / 2
                }, 350, 'easeOutSine');

            }

        }

        function itemOut() {

            if (!touchM && !mobileM && !$(this).hasClass('noHover')) {

                var $this = $(this);

                $(this).children('img.folioThumb').stop().animate({
                    'opacity': .5
                }, 200, 'easeOutQuad');
                $(this).children('span.folioPlus').stop().animate({
                    'opacity': 0,
                    'top': -23
                }, 200, 'easeOutQuad');
                $(this).children('span.folioShadow').stop().animate({
                    'opacity': 0
                }, 200, 'easeOutQuad');
                $(this).children('div.folioTextHolder').stop().animate({
                    'opacity': 0
                }, 200, 'easeOutQuad');
                $(this).find('div.folioText').stop().animate({
                    'opacity': 0,
                    'top': 200
                }, 250, 'easeOutSine', function () {
                    $this.css('zIndex', 1);
                });

            }

        }

        var clickFail = true;

        function itemClick() {
            if (clickFail) {
                clickFail = false;
                byHash = false;
                fHash = false;
                openProject($(this).attr('href'), $(this).data('name'));
                setTimeout(function () {
                    clickFail = true;
                }, 1000);
                if (mobileM)
                    $('html,body').animate({
                        scrollTop: 0
                    }, 500, 'easeInQuad');
            }
            return false;
        }


        /* Setup Resize */

        var sideW = $('body').hasClass('Stick') ? 280 : 0;
        $.topBoss = $('body').hasClass('Stick') ? 'opened' : 'closed';
        $('body').addClass('topBoss');

        resizeFolio();
        $(window).resize(function () {
            resizeFolio();
        });

        $('#sidebar #close').click(function () {
            resizeFolio();
        });

        function resizeFolio() {

            sideW = $.topBoss == 'closed' ? 0 : 280;

            mobileM = ($('#mobileCheck').css('display') == 'block' ? true : false);

            if (mobileM) sideW = 0;

            var sW = $(window).width() - sideW,
                sH = $(window).height();

            iW = Math.floor(sW / Math.ceil(sW / itemWidth));
            iH = Math.floor(iW / 4 * 3);
            $items.css({
                'width': iW,
                'height': iH
            });

            $folio.width($(document).width() - sideW);

            $folio.isotope({
                itemSelector: '.folioItem',
                getSortData: sortingObject,
                animationEngine: 'jquery',
                resizable: false
            });

            $items.addClass('disableResize');

            if (!mobileM)
                $projectHover.height($(window).height() - 140 - sP);
            else
                $projectHover.height($(window).height());

            $projectControls.height($(window).height() - 140 - sP);

            if ($folio.hasClass('galleryOpened'))
                $folio.css('height', $(window).height() - 280 - sP * 2);

        }

        /* Setup navigation buttons */

        $btnNext.click(function () {
            if (fSafe) {
                fSafe = false;
                byHash = false;
                closeAndOpen($(this).attr('href'), $(this).data('name'));
            }
            return false;
        });

        $btnPrev.click(function () {
            if (fSafe) {
                fSafe = false;
                byHash = false;
                closeAndOpen($(this).attr('href'), $(this).data('name'));
            }
            return false;
        });

        $('.btnClose').click(function () {
            byHash = false;
            closeAndStay();
            return false;
        });

        /* Setup loading */

        function openProject(href, title) {

            sTop = $('html').scrollTop() == 0 ? $('body').scrollTop() : $('html').scrollTop();

            if (firstProject) {
                firstProject = false;

                $folio.addClass('galleryOpened');
                $body.addClass('galleryOpened');

                $folio.animate({
                    'height': $(window).height() - 280 - sP * 2
                }, 200, 'easeInQuad');
                var phH = $projectHover.height();

                $('#topFooter').css('zIndex', 99999);
                $('#bottomFooter').css('zIndex', 99999);

                $supersized.css('zIndex', 99998);

                $projectHover.height(0).fadeIn(0).animate({
                    'height': phH
                }, 200, 'easeInQuad', function () {
                    continueLoading(href);
                    $items.css('zIndex', 6);
                });

            } else {
                continueLoading(href);
            }

            fHash = false;
            document.location.hash = '#/' + title;

        }

        function continueLoading(href) {
            $.ajax({
                url: href,
                dataType: 'html'
            }).done(function (data) {


                $project = $(data).find('.project');

                document.title = $(data).find('#title').text();

                $projectControls.append($(data).find('.galleryContent'));

                //twttr.widgets.load();

                var imgArray = new Array();

                $project.find('#projectSlides').children('img').each(function () {

                    imgArray.push({
                        image: $(this).attr('src'),
                        title: $(this).attr('title')
                    })

                });

                var fitPortrait = $('body').hasClass('Fit') ? 1 : 0;

                $.supersized({
                    slides: imgArray,
                    transition: 1,
                    transition_speed: 1000,
                    horizontal_center: 12,
                    image_protect: 0,
                    fit_portrait: fitPortrait,
                    fit_landscape: fitPortrait,
                    fit_always: fitPortrait
                });

                var $prevLink = $project.find('#nextProject a');
                var $nextLink = $project.find('#previousProject a');

                if (touchM) {
                    $('#supersizedControls').touchSwipe(function (dir) {
                        if (dir == 'right')
                            api.prevSlide();
                        else if (dir == 'left')
                            api.nextSlide();
                    })
                }

                if ($prevLink.length > 0)
                    $btnPrev.removeClass('disabled').attr('href', $prevLink.attr('href')).data('name', $prevLink.text());
                else
                    $btnPrev.addClass('disabled');

                if ($nextLink.length > 0)
                    $btnNext.removeClass('disabled').attr('href', $nextLink.attr('href')).data('name', $nextLink.text());
                else
                    $btnNext.addClass('disabled');

                $('.galleryContent').find('.close').click(function () {
                    byHash = false;
                    closeAndStay();
                    return false;
                });

                setTimeout(function () {
                    fSafe = true;
                }, 500);

            });

        }

        function closeAndOpen(href, title) {

            $projectControls.find('#slideList').fadeOut();
            $body.find('.galleryContent').delay(100).fadeOut(200);
            $supersized.delay(200).fadeOut(400, function () {

                clearInterval($.supersized.vars.slideshow_interval);
                $.supersized.vars.current_slide = 0;
                $.supersized.vars.in_animation = false;
                $.supersized.vars.is_paused = false;
                $.supersized.vars.slideshow_interval = null;
                $.supersized.vars.options.slides = null;

                $projectControls.find('li:not(#playPause)').remove();
                $body.find('.galleryContent').remove();
                $supersized.empty();

                $('#progressBar').stop().animate({
                    height: 0
                }, 100, 'easeOutQuad');

                openProject(href, title);

            });

        }

        function closeAndStay() {

            $('html,body').animate({
                scrollTop: sTop
            }, 500, 'easeInQuad');

            document.location.hash = '#';
            document.title = oTitle;

            $folio.removeClass('galleryOpened');
            $body.removeClass('galleryOpened');
            resizeFolio();

            $projectControls.find('.slideProjects a').stop().fadeOut(0);
            $projectControls.find('#slideList').stop().fadeOut(200);
            $body.find('.galleryContent').delay(100).fadeOut(200);
            $supersized.delay(200).fadeOut(400, function () {

                $projectControls.find('li:not(#playPause)').remove();
                $body.find('.galleryContent').remove();
                $supersized.empty();
                if ($.supersized.vars.slideshow_interval) {
                    clearInterval($.supersized.vars.slideshow_interval);
                };
                $('#progressBar').stop().animate({
                    height: 0
                }, 100, 'easeOutQuad');
                $('#topFooter').css('zIndex', 7);
                $('#bottomFooter').css('zIndex', 7);

                $supersized.css('zIndex', -999);
                $projectControls.css('zIndex', -999);

            });

            $projectHover.fadeOut(100);

            firstProject = true;
            $items.css('zIndex', 10);

        }

    }

    /* Easy Twitter component - queness.com & me */

    $.fn.twitter = function (username, count) {

        var $twitHolder = $(this);
        var tHr = ''

        $.getJSON("https://api.twitter.com/1/statuses/user_timeline.json?screen_name=" + username + "&count=" + count + "&callback=?",
            function (data) {
                $.each(data, function (i, item) {

                    if (i == 0) $twitHolder.empty();

                    $twitHolder.append(clean(item.text) + '<span class="twitFooter">' + timeAgo(item.created_at) + '</span>');

                });
            });

    };

    function timeAgo(dateString) {
        var rightNow = new Date();
        var then = new Date(dateString);

        if ($.browser.msie) {
            // IE can't parse these crazy Ruby dates
            then = Date.parse(dateString.replace(/( \+)/, ' UTC$1'));
        }

        var diff = rightNow - then;

        var second = 1000,
            minute = second * 60,
            hour = minute * 60,
            day = hour * 24,
            week = day * 7;

        if (isNaN(diff) || diff < 0) {
            return ""; // return blank string if unknown
        }

        if (diff < second * 2) {
            // within 2 seconds
            return "right now";
        }

        if (diff < minute) {
            return Math.floor(diff / second) + " seconds ago";
        }

        if (diff < minute * 2) {
            return "1 minute ago";
        }

        if (diff < hour) {
            return Math.floor(diff / minute) + " minutes ago";
        }

        if (diff < hour * 2) {
            return "1 hour ago";
        }

        if (diff < day) {
            return Math.floor(diff / hour) + " hours ago";
        }

        if (diff > day && diff < day * 2) {
            return "yesterday";
        }

        if (diff < day * 365) {
            return Math.floor(diff / day) + " days ago";
        } else {
            return "over a year ago";
        }
    }

    function link(tweet) {
        return tweet.replace(/\b(((https*\:\/\/)|www\.)[^\"\']+?)(([!?,.\)]+)?(\s|$))/g, function (link, m1, m2, m3, m4) {
            var http = m2.match(/w/) ? 'http://' : '';
            return '<a class="twtr-hyperlink" target="_blank" href="' + http + m1 + '">' + ((m1.length > 25) ? m1.substr(0, 24) + '...' : m1) + '</a>' + m4;
        });
    };

    function at(tweet) {
        return tweet.replace(/\B[@@]([a-zA-Z0-9_]{1,20})/g, function (m, username) {
            return '<a target="_blank" class="twtr-atreply" href="http://twitter.com/intent/user?screen_name=' + username + '">@' + username + '</a>';
        });
    }

    function list(tweet) {
        return tweet.replace(/\B[@@]([a-zA-Z0-9_]{1,20}\/\w+)/g, function (m, userlist) {
            return '<a target="_blank" class="twtr-atreply" href="http://twitter.com/' + userlist + '">@' + userlist + '</a>';
        });

    }

    function hash(tweet) {
        return tweet.replace(/(^|\s+)#(\w+)/gi, function (m, before, hash) {
            return before + '<a target="_blank" class="twtr-hashtag" href="http://twitter.com/search?q=%23' + hash + '">#' + hash + '</a>';
        });

    }

    function clean(tweet) {
        return hash(at(list(link(tweet))));
    }

    /* styledSelect script - Petr Stanicek (pixy@pixy.cz) */

    jQuery.fn.styledSelect = function (options) {
        var isFF2 = jQuery.browser.mozilla && jQuery.browser.version.indexOf('1.8.') == 0;
        var prefs = {
            coverClass: 'select-replace-cover',
            innerClass: 'select-replace',
            adjustPosition: {
                top: 0,
                left: 0
            },
            selectOpacity: 0
        }
        if (options) jQuery.extend(prefs, options);
        return this.each(function () {
            if (isFF2) return false;
            var selElm = jQuery(this);
            selElm.wrap('<span><' + '/span>');
            selElm.after('<span><' + '/span>');
            var selReplace = selElm.next();
            var selCover = selElm.parent();
            selElm.css({
                'opacity': prefs.selectOpacity,
                'visibility': 'visible',
                'position': 'absolute',
                'top': 0,
                'left': 0,
                'display': 'inline',
                'z-index': 1
            });
            selCover.addClass(prefs.coverClass).css({
                'display': 'inline-block',
                'position': 'relative',
                'top': prefs.adjustPosition.top,
                'left': prefs.adjustPosition.left,
                'z-index': 0,
                'vertical-align': 'middle',
                'text-align': 'left'
            });
            selReplace.addClass(prefs.innerClass).css({
                'display': 'block',
                'white-space': 'nowrap'
            });

            selElm.bind('change', function () {
                jQuery(this).next().text(this.options[this.selectedIndex].text);
            }).bind('resize', function () {
                jQuery(this).parent().width(jQuery(this).width() + 'px');
            });
            selElm.trigger('change').trigger('resize');
        });
    }

})(jQuery);

/*
 * Slides, A Slideshow Plugin for jQuery
 * Intructions: http://slidesjs.com
 * By: Nathan Searles, http://nathansearles.com
 * Version: 1.1.9
 * Updated: September 5th, 2011
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function ($) {
    $.fn.slides = function (option) {
        // override defaults with specified option
        option = $.extend({}, $.fn.slides.option, option);

        return this.each(function () {
            // wrap slides in control container, make sure slides are block level
            $('.' + option.container, $(this)).children().wrapAll('<div class="slides_control"/>');

            var elem = $(this),
                control = $('.slides_control', elem),
                total = control.children().size(),
                width = control.children().outerWidth(),
                height = control.children().outerHeight(),
                start = option.start - 1,
                effect = option.effect.indexOf(',') < 0 ? option.effect : option.effect.replace(' ', '').split(',')[0],
                paginationEffect = option.effect.indexOf(',') < 0 ? effect : option.effect.replace(' ', '').split(',')[1],
                next = 0,
                prev = 0,
                number = 0,
                current = 0,
                loaded, active, clicked, position, direction, imageParent, pauseTimeout, playInterval;

            // is there only one slide?
            if (total < 2) {
                // Fade in .slides_container
                $('.' + option.container, $(this)).fadeIn(option.fadeSpeed, option.fadeEasing, function () {
                    // let the script know everything is loaded
                    loaded = true;
                    // call the loaded funciton
                    option.slidesLoaded();
                });
                // Hide the next/previous buttons
                $('.' + option.next + ', .' + option.prev).fadeOut(0);
                return false;
            }

            updateCustomPagination();

            // animate slides
            function animate(direction, effect, clicked) {
                if (!active && loaded) {
                    active = true;
                    // start of animation
                    option.animationStart(current + 1);
                    switch (direction) {
                    case 'next':
                        // change current slide to previous
                        prev = current;
                        // get next from current + 1
                        next = current + 1;
                        // if last slide, set next to first slide
                        next = total === next ? 0 : next;
                        // set position of next slide to right of previous
                        position = width * 2;
                        // distance to slide based on width of slides
                        direction = -width * 2;
                        // store new current slide
                        current = next;
                        break;
                    case 'prev':
                        // change current slide to previous
                        prev = current;
                        // get next from current - 1
                        next = current - 1;
                        // if first slide, set next to last slide
                        next = next === -1 ? total - 1 : next;
                        // set position of next slide to left of previous
                        position = 0;
                        // distance to slide based on width of slides
                        direction = 0;
                        // store new current slide
                        current = next;
                        break;
                    case 'pagination':
                        // get next from pagination item clicked, convert to number
                        next = parseInt(clicked, 10);
                        // get previous from pagination item with class of current
                        prev = $('.' + option.paginationClass + ' li.' + option.currentClass + ' a', elem).attr('href').match('[^#/]+$');
                        // if next is greater then previous set position of next slide to right of previous
                        if (next > prev) {
                            position = width * 2;
                            direction = -width * 2;
                        } else {
                            // if next is less then previous set position of next slide to left of previous
                            position = 0;
                            direction = 0;
                        }
                        // store new current slide
                        current = next;
                        break;
                    }

                    updateCustomPagination();

                    // fade animation
                    if (effect === 'fade') {
                        // fade animation with crossfade
                        if (option.crossfade) {
                            // put hidden next above current
                            control.children(':eq(' + next + ')', elem).css({
                                zIndex: 10
                                // fade in next
                            }).fadeIn(option.fadeSpeed, option.fadeEasing, function () {
                                if (option.autoHeight) {
                                    // animate container to height of next
                                    control.animate({
                                        height: control.children(':eq(' + next + ')', elem).outerHeight()
                                    }, option.autoHeightSpeed, function () {
                                        // hide previous
                                        control.children(':eq(' + prev + ')', elem).css({
                                            display: 'none',
                                            zIndex: 0
                                        });
                                        // reset z index
                                        control.children(':eq(' + next + ')', elem).css({
                                            zIndex: 0
                                        });
                                        // end of animation
                                        option.animationComplete(next + 1);
                                        active = false;
                                    });
                                } else {
                                    // hide previous
                                    control.children(':eq(' + prev + ')', elem).css({
                                        display: 'none',
                                        zIndex: 0
                                    });
                                    // reset zindex
                                    control.children(':eq(' + next + ')', elem).css({
                                        zIndex: 0
                                    });
                                    // end of animation
                                    option.animationComplete(next + 1);
                                    active = false;
                                }
                            });
                        } else {
                            // fade animation with no crossfade
                            control.children(':eq(' + prev + ')', elem).fadeOut(option.fadeSpeed, option.fadeEasing, function () {
                                // animate to new height
                                if (option.autoHeight) {
                                    control.animate({
                                            // animate container to height of next
                                            height: control.children(':eq(' + next + ')', elem).outerHeight()
                                        }, option.autoHeightSpeed,
                                        // fade in next slide
                                        function () {
                                            control.children(':eq(' + next + ')', elem).fadeIn(option.fadeSpeed, option.fadeEasing);
                                        });
                                } else {
                                    // if fixed height
                                    control.children(':eq(' + next + ')', elem).fadeIn(option.fadeSpeed, option.fadeEasing, function () {
                                        // fix font rendering in ie, lame
                                        if ($.browser.msie) {
                                            $(this).get(0).style.removeAttribute('filter');
                                        }
                                    });
                                }
                                // end of animation
                                option.animationComplete(next + 1);
                                active = false;
                            });
                        }
                        // slide animation
                    } else {
                        // move next slide to right of previous
                        control.children(':eq(' + next + ')').css({
                            left: position,
                            display: 'block'
                        });
                        // animate to new height
                        if (option.autoHeight) {
                            control.animate({
                                left: direction,
                                height: control.children(':eq(' + next + ')').outerHeight()
                            }, option.slideSpeed, option.slideEasing, function () {
                                control.css({
                                    left: -width
                                });
                                control.children(':eq(' + next + ')').css({
                                    left: width,
                                    zIndex: 5
                                });
                                // reset previous slide
                                control.children(':eq(' + prev + ')').css({
                                    left: width,
                                    display: 'none',
                                    zIndex: 0
                                });
                                // end of animation
                                option.animationComplete(next + 1);
                                active = false;
                            });
                            // if fixed height
                        } else {
                            // animate control
                            control.animate({
                                left: direction
                            }, option.slideSpeed, option.slideEasing, function () {
                                // after animation reset control position
                                control.css({
                                    left: -width
                                });
                                // reset and show next
                                control.children(':eq(' + next + ')').css({
                                    left: width,
                                    zIndex: 5
                                });
                                // reset previous slide
                                control.children(':eq(' + prev + ')').css({
                                    left: width,
                                    display: 'none',
                                    zIndex: 0
                                });
                                // end of animation
                                option.animationComplete(next + 1);
                                active = false;
                            });
                        }
                    }
                    // set current state for pagination
                    if (option.pagination) {
                        // remove current class from all
                        $('.' + option.paginationClass + ' li.' + option.currentClass, elem).removeClass(option.currentClass);
                        // add current class to next
                        $('.' + option.paginationClass + ' li:eq(' + next + ')', elem).addClass(option.currentClass);
                    }
                }
            } // end animate function

            function stop() {
                // clear interval from stored id
                clearInterval(elem.data('interval'));
            }

            function updateCustomPagination() {
                $('.' + option.customPagination).text((current + 1) + '  of  ' + total);
            }

            function pause() {
                if (option.pause) {
                    // clear timeout and interval
                    clearTimeout(elem.data('pause'));
                    clearInterval(elem.data('interval'));
                    // pause slide show for option.pause amount
                    pauseTimeout = setTimeout(function () {
                        // clear pause timeout
                        clearTimeout(elem.data('pause'));
                        // start play interval after pause
                        playInterval = setInterval(function () {
                            animate("next", effect);
                        }, option.play);
                        // store play interval
                        elem.data('interval', playInterval);
                    }, option.pause);
                    // store pause interval
                    elem.data('pause', pauseTimeout);
                } else {
                    // if no pause, just stop
                    stop();
                }
            }

            // 2 or more slides required
            if (total < 2) {
                return;
            }

            // error corection for start slide
            if (start < 0) {
                start = 0;
            }

            if (start > total) {
                start = total - 1;
            }

            // change current based on start option number
            if (option.start) {
                current = start;
            }

            // randomizes slide order
            if (option.randomize) {
                control.randomize();
            }

            // make sure overflow is hidden, width is set
            $('.' + option.container, elem).css({
                overflow: 'hidden',
                // fix for ie
                position: 'relative'
            });

            // set css for slides
            control.children().css({
                position: 'absolute',
                top: 0,
                left: control.children().outerWidth(),
                zIndex: 0,
                display: 'none'
            });

            // set css for control div
            control.css({
                position: 'relative',
                // size of control 3 x slide width
                width: (width * 3),
                // set height to slide height
                height: height,
                // center control to slide
                left: -width
            });

            // show slides
            $('.' + option.container, elem).css({
                display: 'block'
            });

            // if autoHeight true, get and set height of first slide
            if (option.autoHeight) {
                control.children().css({
                    height: 'auto'
                });
                control.animate({
                    height: control.children(':eq(' + start + ')').outerHeight()
                }, option.autoHeightSpeed);
            }

            // checks if image is loaded
            if (option.preload && control.find('img:eq(' + start + ')').length) {
                // adds preload image
                $('.' + option.container, elem).css({
                    background: 'url(' + option.preloadImage + ') no-repeat 50% 50%'
                });

                // gets image src, with cache buster
                var img = control.find('img:eq(' + start + ')').attr('src') + '?' + (new Date()).getTime();

                // check if the image has a parent
                if ($('img', elem).parent().attr('class') != 'slides_control') {
                    // If image has parent, get tag name
                    imageParent = control.children(':eq(0)')[0].tagName.toLowerCase();
                } else {
                    // Image doesn't have parent, use image tag name
                    imageParent = control.find('img:eq(' + start + ')');
                }

                // checks if image is loaded
                control.find('img:eq(' + start + ')').attr('src', img).load(function () {
                    // once image is fully loaded, fade in
                    control.find(imageParent + ':eq(' + start + ')').fadeIn(option.fadeSpeed, option.fadeEasing, function () {
                        $(this).css({
                            zIndex: 5
                        });
                        // removes preload image
                        $('.' + option.container, elem).css({
                            background: ''
                        });
                        // let the script know everything is loaded
                        loaded = true;
                        // call the loaded funciton
                        option.slidesLoaded();
                    });
                });
            } else {
                // if no preloader fade in start slide
                control.children(':eq(' + start + ')').fadeIn(option.fadeSpeed, option.fadeEasing, function () {
                    // let the script know everything is loaded
                    loaded = true;
                    // call the loaded funciton
                    option.slidesLoaded();
                });
            }

            // click slide for next
            if (option.bigTarget) {
                // set cursor to pointer
                control.children().css({
                    cursor: 'pointer'
                });
                // click handler
                control.children().click(function () {
                    // animate to next on slide click
                    animate('next', effect);
                    return false;
                });
            }

            // pause on mouseover
            if (option.hoverPause && option.play) {
                control.bind('mouseover', function () {
                    // on mouse over stop
                    stop();
                });
                control.bind('mouseleave', function () {
                    // on mouse leave start pause timeout
                    pause();
                });
            }

            // generate next/prev buttons
            if (option.generateNextPrev) {
                $('.' + option.container, elem).after('<a href="#" class="' + option.prev + '">Prev</a>');
                $('.' + option.prev, elem).after('<a href="#" class="' + option.next + '">Next</a>');
            }

            // next button
            $('.' + option.next, elem).click(function (e) {
                e.preventDefault();
                if (option.play) {
                    pause();
                }
                animate('next', effect);
            });

            // previous button
            $('.' + option.prev, elem).click(function (e) {
                e.preventDefault();
                if (option.play) {
                    pause();
                }
                animate('prev', effect);
            });

            // generate pagination
            if (option.generatePagination) {
                // create unordered list
                if (option.prependPagination) {
                    elem.prepend('<ul class=' + option.paginationClass + '></ul>');
                } else {
                    elem.append('<ul class=' + option.paginationClass + '></ul>');
                }
                // for each slide create a list item and link
                control.children().each(function () {
                    $('.' + option.paginationClass, elem).append('<li><a href="#' + number + '">' + (number + 1) + '</a></li>');
                    number++;
                });
            } else {
                // if pagination exists, add href w/ value of item number to links
                $('.' + option.paginationClass + ' li a', elem).each(function () {
                    $(this).attr('href', '#' + number);
                    number++;
                });
            }

            // add current class to start slide pagination
            $('.' + option.paginationClass + ' li:eq(' + start + ')', elem).addClass(option.currentClass);

            // click handling
            $('.' + option.paginationClass + ' li a', elem).click(function () {
                // pause slideshow
                if (option.play) {
                    pause();
                }
                // get clicked, pass to animate function
                clicked = $(this).attr('href').match('[^#/]+$');
                // if current slide equals clicked, don't do anything
                if (current != clicked) {
                    animate('pagination', paginationEffect, clicked);
                }
                return false;
            });

            // click handling
            $('a.link', elem).click(function () {
                // pause slideshow
                if (option.play) {
                    pause();
                }
                // get clicked, pass to animate function
                clicked = $(this).attr('href').match('[^#/]+$') - 1;
                // if current slide equals clicked, don't do anything
                if (current != clicked) {
                    animate('pagination', paginationEffect, clicked);
                }
                return false;
            });

            if (option.play) {
                // set interval
                playInterval = setInterval(function () {
                    animate('next', effect);
                }, option.play);
                // store interval id
                elem.data('interval', playInterval);
            }
        });
    };

    // default options
    $.fn.slides.option = {
        preload: false, // boolean, Set true to preload images in an image based slideshow
        preloadImage: '/img/loading.gif', // string, Name and location of loading image for preloader. Default is "/img/loading.gif"
        container: 'slides_container', // string, Class name for slides container. Default is "slides_container"
        generateNextPrev: false, // boolean, Auto generate next/prev buttons
        next: 'next', // string, Class name for next button
        prev: 'prev', // string, Class name for previous button
        pagination: true, // boolean, If you're not using pagination you can set to false, but don't have to
        generatePagination: true, // boolean, Auto generate pagination
        prependPagination: false, // boolean, prepend pagination
        paginationClass: 'pagination', // string, Class name for pagination
        currentClass: 'current', // string, Class name for current class
        fadeSpeed: 350, // number, Set the speed of the fading animation in milliseconds
        fadeEasing: '', // string, must load jQuery's easing plugin before http://gsgd.co.uk/sandbox/jquery/easing/
        slideSpeed: 350, // number, Set the speed of the sliding animation in milliseconds
        slideEasing: '', // string, must load jQuery's easing plugin before http://gsgd.co.uk/sandbox/jquery/easing/
        start: 1, // number, Set the speed of the sliding animation in milliseconds
        effect: 'slide', // string, '[next/prev], [pagination]', e.g. 'slide, fade' or simply 'fade' for both
        crossfade: false, // boolean, Crossfade images in a image based slideshow
        randomize: false, // boolean, Set to true to randomize slides
        play: 0, // number, Autoplay slideshow, a positive number will set to true and be the time between slide animation in milliseconds
        pause: 0, // number, Pause slideshow on click of next/prev or pagination. A positive number will set to true and be the time of pause in milliseconds
        hoverPause: false, // boolean, Set to true and hovering over slideshow will pause it
        autoHeight: false, // boolean, Set to true to auto adjust height
        autoHeightSpeed: 350, // number, Set auto height animation time in milliseconds
        bigTarget: false, // boolean, Set to true and the whole slide will link to next slide on click
        animationStart: function () {}, // Function called at the start of animation
        animationComplete: function () {}, // Function called at the completion of animation
        slidesLoaded: function () {} // Function is called when slides is fully loaded
    };

    // Randomize slide order on load
    $.fn.randomize = function (callback) {
        function randomizeOrder() {
            return (Math.round(Math.random()) - 0.5);
        }
        return ($(this).each(function () {
            var $this = $(this);
            var $children = $this.children();
            var childCount = $children.length;
            if (childCount > 1) {
                $children.hide();
                var indices = [];
                for (i = 0; i < childCount; i++) {
                    indices[indices.length] = i;
                }
                indices = indices.sort(randomizeOrder);
                $.each(indices, function (j, k) {
                    var $child = $children.eq(k);
                    var $clone = $child.clone(true);
                    $clone.show().appendTo($this);
                    if (callback !== undefined) {
                        callback($child, $clone);
                    }
                    $child.remove();
                });
            }
        }));
    };
})(jQuery);

/**
 * Isotope v1.5.19
 * An exquisite jQuery plugin for magical layouts
 * http://isotope.metafizzy.co
 *
 * Commercial use requires one-time license fee
 * http://metafizzy.co/#licenses
 *
 * Copyright 2012 David DeSandro / Metafizzy
 */

/*jshint asi: true, browser: true, curly: true, eqeqeq: true, forin: false, immed: false, newcap: true, noempty: true, strict: true, undef: true */
/*global jQuery: false */

(function (window, $, undefined) {

    'use strict';

    // get global vars
    var document = window.document;
    var Modernizr = window.Modernizr;

    // helper function
    var capitalize = function (str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    };

    // ========================= getStyleProperty by kangax ===============================
    // http://perfectionkills.com/feature-testing-css-properties/

    var prefixes = 'Moz Webkit O Ms'.split(' ');

    var getStyleProperty = function (propName) {
        var style = document.documentElement.style,
            prefixed;

        // test standard property first
        if (typeof style[propName] === 'string') {
            return propName;
        }

        // capitalize
        propName = capitalize(propName);

        // test vendor specific properties
        for (var i = 0, len = prefixes.length; i < len; i++) {
            prefixed = prefixes[i] + propName;
            if (typeof style[prefixed] === 'string') {
                return prefixed;
            }
        }
    };

    var transformProp = getStyleProperty('transform'),
        transitionProp = getStyleProperty('transitionProperty');


    // ========================= miniModernizr ===============================
    // <3<3<3 and thanks to Faruk and Paul for doing the heavy lifting

    /*!
     * Modernizr v1.6ish: miniModernizr for Isotope
     * http://www.modernizr.com
     *
     * Developed by:
     * - Faruk Ates  http://farukat.es/
     * - Paul Irish  http://paulirish.com/
     *
     * Copyright (c) 2009-2010
     * Dual-licensed under the BSD or MIT licenses.
     * http://www.modernizr.com/license/
     */

    /*
     * This version whittles down the script just to check support for
     * CSS transitions, transforms, and 3D transforms.
     */

    var tests = {
        csstransforms: function () {
            return !!transformProp;
        },

        csstransforms3d: function () {
            var test = !! getStyleProperty('perspective');
            // double check for Chrome's false positive
            if (test) {
                var vendorCSSPrefixes = ' -o- -moz- -ms- -webkit- -khtml- '.split(' '),
                    mediaQuery = '@media (' + vendorCSSPrefixes.join('transform-3d),(') + 'modernizr)',
                    $style = $('<style>' + mediaQuery + '{#modernizr{height:3px}}' + '</style>')
                        .appendTo('head'),
                    $div = $('<div id="modernizr" />').appendTo('html');

                test = $div.height() === 3;

                $div.remove();
                $style.remove();
            }
            return test;
        },

        csstransitions: function () {
            return !!transitionProp;
        }
    };

    var testName;

    if (Modernizr) {
        // if there's a previous Modernzir, check if there are necessary tests
        for (testName in tests) {
            if (!Modernizr.hasOwnProperty(testName)) {
                // if test hasn't been run, use addTest to run it
                Modernizr.addTest(testName, tests[testName]);
            }
        }
    } else {
        // or create new mini Modernizr that just has the 3 tests
        Modernizr = window.Modernizr = {
            _version: '1.6ish: miniModernizr for Isotope'
        };

        var classes = ' ';
        var result;

        // Run through tests
        for (testName in tests) {
            result = tests[testName]();
            Modernizr[testName] = result;
            classes += ' ' + (result ? '' : 'no-') + testName;
        }

        // Add the new classes to the <html> element.
        $('html').addClass(classes);
    }


    // ========================= isoTransform ===============================

    /**
     *  provides hooks for .css({ scale: value, translate: [x, y] })
     *  Progressively enhanced CSS transforms
     *  Uses hardware accelerated 3D transforms for Safari
     *  or falls back to 2D transforms.
     */

    if (Modernizr.csstransforms) {

        // i.e. transformFnNotations.scale(0.5) >> 'scale3d( 0.5, 0.5, 1)'
        var transformFnNotations = Modernizr.csstransforms3d ? { // 3D transform functions
            translate: function (position) {
                return 'translate3d(' + position[0] + 'px, ' + position[1] + 'px, 0) ';
            },
            scale: function (scale) {
                return 'scale3d(' + scale + ', ' + scale + ', 1) ';
            }
        } : { // 2D transform functions
            translate: function (position) {
                return 'translate(' + position[0] + 'px, ' + position[1] + 'px) ';
            },
            scale: function (scale) {
                return 'scale(' + scale + ') ';
            }
        };

        var setIsoTransform = function (elem, name, value) {
            // unpack current transform data
            var data = $.data(elem, 'isoTransform') || {},
                newData = {},
                fnName,
                transformObj = {},
                transformValue;

            // i.e. newData.scale = 0.5
            newData[name] = value;
            // extend new value over current data
            $.extend(data, newData);

            for (fnName in data) {
                transformValue = data[fnName];
                transformObj[fnName] = transformFnNotations[fnName](transformValue);
            }

            // get proper order
            // ideally, we could loop through this give an array, but since we only have
            // a couple transforms we're keeping track of, we'll do it like so
            var translateFn = transformObj.translate || '',
                scaleFn = transformObj.scale || '',
                // sorting so translate always comes first
                valueFns = translateFn + scaleFn;

            // set data back in elem
            $.data(elem, 'isoTransform', data);

            // set name to vendor specific property
            elem.style[transformProp] = valueFns;
        };

        // ==================== scale ===================

        $.cssNumber.scale = true;

        $.cssHooks.scale = {
            set: function (elem, value) {
                // uncomment this bit if you want to properly parse strings
                // if ( typeof value === 'string' ) {
                //   value = parseFloat( value );
                // }
                setIsoTransform(elem, 'scale', value);
            },
            get: function (elem, computed) {
                var transform = $.data(elem, 'isoTransform');
                return transform && transform.scale ? transform.scale : 1;
            }
        };

        $.fx.step.scale = function (fx) {
            $.cssHooks.scale.set(fx.elem, fx.now + fx.unit);
        };


        // ==================== translate ===================

        $.cssNumber.translate = true;

        $.cssHooks.translate = {
            set: function (elem, value) {

                // uncomment this bit if you want to properly parse strings
                // if ( typeof value === 'string' ) {
                //   value = value.split(' ');
                // }
                //
                // var i, val;
                // for ( i = 0; i < 2; i++ ) {
                //   val = value[i];
                //   if ( typeof val === 'string' ) {
                //     val = parseInt( val );
                //   }
                // }

                setIsoTransform(elem, 'translate', value);
            },

            get: function (elem, computed) {
                var transform = $.data(elem, 'isoTransform');
                return transform && transform.translate ? transform.translate : [0, 0];
            }
        };

    }

    // ========================= get transition-end event ===============================
    var transitionEndEvent, transitionDurProp;

    if (Modernizr.csstransitions) {
        transitionEndEvent = {
            WebkitTransitionProperty: 'webkitTransitionEnd', // webkit
            MozTransitionProperty: 'transitionend',
            OTransitionProperty: 'oTransitionEnd',
            transitionProperty: 'transitionEnd'
        }[transitionProp];

        transitionDurProp = getStyleProperty('transitionDuration');
    }

    // ========================= smartresize ===============================

    /*
     * smartresize: debounced resize event for jQuery
     *
     * latest version and complete README available on Github:
     * https://github.com/louisremi/jquery.smartresize.js
     *
     * Copyright 2011 @louis_remi
     * Licensed under the MIT license.
     */

    var $event = $.event,
        resizeTimeout;

    $event.special.smartresize = {
        setup: function () {
            $(this).bind("resize", $event.special.smartresize.handler);
        },
        teardown: function () {
            $(this).unbind("resize", $event.special.smartresize.handler);
        },
        handler: function (event, execAsap) {
            // Save the context
            var context = this,
                args = arguments;

            // set correct event type
            event.type = "smartresize";

            if (resizeTimeout) {
                clearTimeout(resizeTimeout);
            }
            resizeTimeout = setTimeout(function () {
                jQuery.event.handle.apply(context, args);
            }, execAsap === "execAsap" ? 0 : 100);
        }
    };

    $.fn.smartresize = function (fn) {
        return fn ? this.bind("smartresize", fn) : this.trigger("smartresize", ["execAsap"]);
    };



    // ========================= Isotope ===============================


    // our "Widget" object constructor
    $.Isotope = function (options, element, callback) {
        this.element = $(element);

        this._create(options);
        this._init(callback);
    };

    // styles of container element we want to keep track of
    var isoContainerStyles = ['width', 'height'];

    var $window = $(window);

    $.Isotope.settings = {
        resizable: false,
        layoutMode: 'masonry',
        containerClass: 'isotope',
        itemClass: 'isotope-item',
        hiddenClass: 'isotope-hidden',
        hiddenStyle: {
            opacity: 0,
            scale: 0.001
        },
        visibleStyle: {
            opacity: 1,
            scale: 1
        },
        containerStyle: {
            position: 'relative',
            overflow: 'hidden'
        },
        animationEngine: 'best-available',
        animationOptions: {
            queue: false,
            duration: 800
        },
        sortBy: 'original-order',
        sortAscending: true,
        resizesContainer: true,
        transformsEnabled: !$.browser.opera, // disable transforms in Opera
        itemPositionDataEnabled: false
    };

    $.Isotope.prototype = {

        // sets up widget
        _create: function (options) {

            this.options = $.extend({}, $.Isotope.settings, options);

            this.styleQueue = [];
            this.elemCount = 0;

            // get original styles in case we re-apply them in .destroy()
            var elemStyle = this.element[0].style;
            this.originalStyle = {};
            // keep track of container styles
            var containerStyles = isoContainerStyles.slice(0);
            for (var prop in this.options.containerStyle) {
                containerStyles.push(prop);
            }
            for (var i = 0, len = containerStyles.length; i < len; i++) {
                prop = containerStyles[i];
                this.originalStyle[prop] = elemStyle[prop] || '';
            }
            // apply container style from options
            this.element.css(this.options.containerStyle);

            this._updateAnimationEngine();
            this._updateUsingTransforms();

            // sorting
            var originalOrderSorter = {
                'original-order': function ($elem, instance) {
                    instance.elemCount++;
                    return instance.elemCount;
                },
                random: function () {
                    return Math.random();
                }
            };

            this.options.getSortData = $.extend(this.options.getSortData, originalOrderSorter);

            // need to get atoms
            this.reloadItems();

            // get top left position of where the bricks should be
            this.offset = {
                left: parseInt((this.element.css('padding-left') || 0), 10),
                top: parseInt((this.element.css('padding-top') || 0), 10)
            };

            // add isotope class first time around
            var instance = this;
            setTimeout(function () {
                instance.element.addClass(instance.options.containerClass);
            }, 0);

            // bind resize method
            if (this.options.resizable) {
                $window.bind('smartresize.isotope', function () {
                    instance.resize();
                });
            }

            // dismiss all click events from hidden events
            this.element.delegate('.' + this.options.hiddenClass, 'click', function () {
                return false;
            });

        },

        _getAtoms: function ($elems) {
            var selector = this.options.itemSelector,
                // filter & find
                $atoms = selector ? $elems.filter(selector).add($elems.find(selector)) : $elems,
                // base style for atoms
                atomStyle = {
                    position: 'absolute'
                };

            if (this.usingTransforms) {
                atomStyle.left = 0;
                atomStyle.top = 0;
            }

            $atoms.css(atomStyle).addClass(this.options.itemClass);

            this.updateSortData($atoms, true);

            return $atoms;
        },

        // _init fires when your instance is first created
        // (from the constructor above), and when you
        // attempt to initialize the widget again (by the bridge)
        // after it has already been initialized.
        _init: function (callback) {

            this.$filteredAtoms = this._filter(this.$allAtoms);
            this._sort();
            this.reLayout(callback);

        },

        option: function (opts) {
            // change options AFTER initialization:
            // signature: $('#foo').bar({ cool:false });
            if ($.isPlainObject(opts)) {
                this.options = $.extend(true, this.options, opts);

                // trigger _updateOptionName if it exists
                var updateOptionFn;
                for (var optionName in opts) {
                    updateOptionFn = '_update' + capitalize(optionName);
                    if (this[updateOptionFn]) {
                        this[updateOptionFn]();
                    }
                }
            }
        },

        // ====================== updaters ====================== //
        // kind of like setters

        _updateAnimationEngine: function () {
            var animationEngine = this.options.animationEngine.toLowerCase().replace(/[ _\-]/g, '');
            var isUsingJQueryAnimation;
            // set applyStyleFnName
            switch (animationEngine) {
            case 'css':
            case 'none':
                isUsingJQueryAnimation = false;
                break;
            case 'jquery':
                isUsingJQueryAnimation = true;
                break;
            default: // best available
                isUsingJQueryAnimation = !Modernizr.csstransitions;
            }
            this.isUsingJQueryAnimation = isUsingJQueryAnimation;
            this._updateUsingTransforms();
        },

        _updateTransformsEnabled: function () {
            this._updateUsingTransforms();
        },

        _updateUsingTransforms: function () {
            var usingTransforms = this.usingTransforms = this.options.transformsEnabled &&
                Modernizr.csstransforms && Modernizr.csstransitions && !this.isUsingJQueryAnimation;

            // prevent scales when transforms are disabled
            if (!usingTransforms) {
                delete this.options.hiddenStyle.scale;
                delete this.options.visibleStyle.scale;
            }

            this.getPositionStyles = usingTransforms ? this._translate : this._positionAbs;
        },


        // ====================== Filtering ======================

        _filter: function ($atoms) {
            var filter = this.options.filter === '' ? '*' : this.options.filter;

            if (!filter) {
                return $atoms;
            }

            var hiddenClass = this.options.hiddenClass,
                hiddenSelector = '.' + hiddenClass,
                $hiddenAtoms = $atoms.filter(hiddenSelector),
                $atomsToShow = $hiddenAtoms;

            if (filter !== '*') {
                $atomsToShow = $hiddenAtoms.filter(filter);
                var $atomsToHide = $atoms.not(hiddenSelector).not(filter).addClass(hiddenClass);
                this.styleQueue.push({
                    $el: $atomsToHide,
                    style: this.options.hiddenStyle
                });
            }

            this.styleQueue.push({
                $el: $atomsToShow,
                style: this.options.visibleStyle
            });
            $atomsToShow.removeClass(hiddenClass);

            return $atoms.filter(filter);
        },

        // ====================== Sorting ======================

        updateSortData: function ($atoms, isIncrementingElemCount) {
            var instance = this,
                getSortData = this.options.getSortData,
                $this, sortData;
            $atoms.each(function () {
                $this = $(this);
                sortData = {};
                // get value for sort data based on fn( $elem ) passed in
                for (var key in getSortData) {
                    if (!isIncrementingElemCount && key === 'original-order') {
                        // keep original order original
                        sortData[key] = $.data(this, 'isotope-sort-data')[key];
                    } else {
                        sortData[key] = getSortData[key]($this, instance);
                    }
                }
                // apply sort data to element
                $.data(this, 'isotope-sort-data', sortData);
            });
        },

        // used on all the filtered atoms
        _sort: function () {

            var sortBy = this.options.sortBy,
                getSorter = this._getSorter,
                sortDir = this.options.sortAscending ? 1 : -1,
                sortFn = function (alpha, beta) {
                    var a = getSorter(alpha, sortBy),
                        b = getSorter(beta, sortBy);
                    // fall back to original order if data matches
                    if (a === b && sortBy !== 'original-order') {
                        a = getSorter(alpha, 'original-order');
                        b = getSorter(beta, 'original-order');
                    }
                    return ((a > b) ? 1 : (a < b) ? -1 : 0) * sortDir;
                };

            this.$filteredAtoms.sort(sortFn);
        },

        _getSorter: function (elem, sortBy) {
            return $.data(elem, 'isotope-sort-data')[sortBy];
        },

        // ====================== Layout Helpers ======================

        _translate: function (x, y) {
            return {
                translate: [x, y]
            };
        },

        _positionAbs: function (x, y) {
            return {
                left: x,
                top: y
            };
        },

        _pushPosition: function ($elem, x, y) {
            x = Math.round(x + this.offset.left);
            y = Math.round(y + this.offset.top);
            var position = this.getPositionStyles(x, y);
            this.styleQueue.push({
                $el: $elem,
                style: position
            });
            if (this.options.itemPositionDataEnabled) {
                $elem.data('isotope-item-position', {
                    x: x,
                    y: y
                });
            }
        },


        // ====================== General Layout ======================

        // used on collection of atoms (should be filtered, and sorted before )
        // accepts atoms-to-be-laid-out to start with
        layout: function ($elems, callback) {

            var layoutMode = this.options.layoutMode;

            // layout logic
            this['_' + layoutMode + 'Layout']($elems);

            // set the size of the container
            if (this.options.resizesContainer) {
                var containerStyle = this['_' + layoutMode + 'GetContainerSize']();
                this.styleQueue.push({
                    $el: this.element,
                    style: containerStyle
                });
            }

            this._processStyleQueue($elems, callback);

            this.isLaidOut = true;
        },

        _processStyleQueue: function ($elems, callback) {
            // are we animating the layout arrangement?
            // use plugin-ish syntax for css or animate
            var styleFn = !this.isLaidOut ? 'css' : (
                this.isUsingJQueryAnimation ? 'animate' : 'css'
            ),
                animOpts = this.options.animationOptions,
                onLayout = this.options.onLayout,
                objStyleFn, processor,
                triggerCallbackNow, callbackFn;

            if ($elems.hasClass('disableResize'))
                styleFn = 'css';

            // default styleQueue processor, may be overwritten down below
            processor = function (i, obj) {
                obj.$el[styleFn](obj.style, animOpts);
            };

            if (this._isInserting && this.isUsingJQueryAnimation) {
                // if using styleQueue to insert items
                processor = function (i, obj) {
                    // only animate if it not being inserted
                    objStyleFn = obj.$el.hasClass('no-transition') ? 'css' : styleFn;
                    obj.$el[objStyleFn](obj.style, animOpts);
                };

            } else if (callback || onLayout || animOpts.complete) {
                // has callback
                var isCallbackTriggered = false,
                    // array of possible callbacks to trigger
                    callbacks = [callback, onLayout, animOpts.complete],
                    instance = this;
                triggerCallbackNow = true;
                // trigger callback only once
                callbackFn = function () {
                    if (isCallbackTriggered) {
                        return;
                    }
                    var hollaback;
                    for (var i = 0, len = callbacks.length; i < len; i++) {
                        hollaback = callbacks[i];
                        if (typeof hollaback === 'function') {
                            hollaback.call(instance.element, $elems, instance);
                        }
                    }
                    isCallbackTriggered = true;
                };

                if (this.isUsingJQueryAnimation && styleFn === 'animate') {
                    // add callback to animation options
                    animOpts.complete = callbackFn;
                    triggerCallbackNow = false;

                } else if (Modernizr.csstransitions) {
                    // detect if first item has transition
                    var i = 0,
                        firstItem = this.styleQueue[0],
                        testElem = firstItem && firstItem.$el,
                        styleObj;
                    // get first non-empty jQ object
                    while (!testElem || !testElem.length) {
                        styleObj = this.styleQueue[i++];
                        // HACK: sometimes styleQueue[i] is undefined
                        if (!styleObj) {
                            return;
                        }
                        testElem = styleObj.$el;
                    }
                    // get transition duration of the first element in that object
                    // yeah, this is inexact
                    var duration = parseFloat(getComputedStyle(testElem[0])[transitionDurProp]);
                    if (duration > 0) {
                        processor = function (i, obj) {
                            obj.$el[styleFn](obj.style, animOpts)
                            // trigger callback at transition end
                            .one(transitionEndEvent, callbackFn);
                        };
                        triggerCallbackNow = false;
                    }
                }
            }

            // process styleQueuex
            $.each(this.styleQueue, processor);

            if (triggerCallbackNow) {
                callbackFn();
            }

            // clear out queue for next time
            this.styleQueue = [];
        },


        resize: function () {
            if (this['_' + this.options.layoutMode + 'ResizeChanged']()) {
                // this.reLayout();
            }
        },


        reLayout: function (callback) {

            this['_' + this.options.layoutMode + 'Reset']();
            this.layout(this.$filteredAtoms, callback);

        },

        // ====================== Convenience methods ======================

        // ====================== Adding items ======================

        // adds a jQuery object of items to a isotope container
        addItems: function ($content, callback) {
            var $newAtoms = this._getAtoms($content);
            // add new atoms to atoms pools
            this.$allAtoms = this.$allAtoms.add($newAtoms);

            if (callback) {
                callback($newAtoms);
            }
        },

        // convienence method for adding elements properly to any layout
        // positions items, hides them, then animates them back in <--- very sezzy
        insert: function ($content, callback) {
            // position items
            this.element.append($content);

            var instance = this;
            this.addItems($content, function ($newAtoms) {
                var $newFilteredAtoms = instance._filter($newAtoms);
                instance._addHideAppended($newFilteredAtoms);
                instance._sort();
                instance.reLayout();
                instance._revealAppended($newFilteredAtoms, callback);
            });

        },

        // convienence method for working with Infinite Scroll
        appended: function ($content, callback) {
            var instance = this;
            this.addItems($content, function ($newAtoms) {
                instance._addHideAppended($newAtoms);
                instance.layout($newAtoms);
                instance._revealAppended($newAtoms, callback);
            });
        },

        // adds new atoms, then hides them before positioning
        _addHideAppended: function ($newAtoms) {
            this.$filteredAtoms = this.$filteredAtoms.add($newAtoms);
            $newAtoms.addClass('no-transition');

            this._isInserting = true;

            // apply hidden styles
            this.styleQueue.push({
                $el: $newAtoms,
                style: this.options.hiddenStyle
            });
        },

        // sets visible style on new atoms
        _revealAppended: function ($newAtoms, callback) {
            var instance = this;
            // apply visible style after a sec
            setTimeout(function () {
                // enable animation
                $newAtoms.removeClass('no-transition');
                // reveal newly inserted filtered elements
                instance.styleQueue.push({
                    $el: $newAtoms,
                    style: instance.options.visibleStyle
                });
                instance._isInserting = false;
                instance._processStyleQueue($newAtoms, callback);
            }, 10);
        },

        // gathers all atoms
        reloadItems: function () {
            this.$allAtoms = this._getAtoms(this.element.children());
        },

        // removes elements from Isotope widget
        remove: function ($content, callback) {
            // remove elements from Isotope instance in callback
            var instance = this;
            // remove() as a callback, for after transition / animation
            var removeContent = function () {
                instance.$allAtoms = instance.$allAtoms.not($content);
                $content.remove();
                if (callback) {
                    callback.call(instance.element);
                }
            };

            if ($content.filter(':not(.' + this.options.hiddenClass + ')').length) {
                // if any non-hidden content needs to be removed
                this.styleQueue.push({
                    $el: $content,
                    style: this.options.hiddenStyle
                });
                this.$filteredAtoms = this.$filteredAtoms.not($content);
                this._sort();
                this.reLayout(removeContent);
            } else {
                // remove it now
                removeContent();
            }

        },

        shuffle: function (callback) {
            this.updateSortData(this.$allAtoms);
            this.options.sortBy = 'random';
            this._sort();
            this.reLayout(callback);
        },

        // destroys widget, returns elements and container back (close) to original style
        destroy: function () {

            var usingTransforms = this.usingTransforms;
            var options = this.options;

            this.$allAtoms
                .removeClass(options.hiddenClass + ' ' + options.itemClass)
                .each(function () {
                    var style = this.style;
                    style.position = '';
                    style.top = '';
                    style.left = '';
                    style.opacity = '';
                    if (usingTransforms) {
                        style[transformProp] = '';
                    }
                });

            // re-apply saved container styles
            var elemStyle = this.element[0].style;
            for (var prop in this.originalStyle) {
                elemStyle[prop] = this.originalStyle[prop];
            }

            this.element
                .unbind('.isotope')
                .undelegate('.' + options.hiddenClass, 'click')
                .removeClass(options.containerClass)
                .removeData('isotope');

            $window.unbind('.isotope');

        },


        // ====================== LAYOUTS ======================

        // calculates number of rows or columns
        // requires columnWidth or rowHeight to be set on namespaced object
        // i.e. this.masonry.columnWidth = 200
        _getSegments: function (isRows) {
            var namespace = this.options.layoutMode,
                measure = isRows ? 'rowHeight' : 'columnWidth',
                size = isRows ? 'height' : 'width',
                segmentsName = isRows ? 'rows' : 'cols',
                containerSize = this.element[size](),
                segments,
                // i.e. options.masonry && options.masonry.columnWidth
                segmentSize = this.options[namespace] && this.options[namespace][measure] ||
                // or use the size of the first item, i.e. outerWidth
                this.$filteredAtoms['outer' + capitalize(size)](true) ||
                // if there's no items, use size of container
                containerSize;

            segments = Math.floor(containerSize / segmentSize);
            segments = Math.max(segments, 1);

            // i.e. this.masonry.cols = ....
            this[namespace][segmentsName] = segments;
            // i.e. this.masonry.columnWidth = ...
            this[namespace][measure] = segmentSize;

        },

        _checkIfSegmentsChanged: function (isRows) {
            var namespace = this.options.layoutMode,
                segmentsName = isRows ? 'rows' : 'cols',
                prevSegments = this[namespace][segmentsName];
            // update cols/rows
            this._getSegments(isRows);
            // return if updated cols/rows is not equal to previous
            return (this[namespace][segmentsName] !== prevSegments);
        },

        // ====================== Masonry ======================

        _masonryReset: function () {
            // layout-specific props
            this.masonry = {};
            // FIXME shouldn't have to call this again
            this._getSegments();
            var i = this.masonry.cols;
            this.masonry.colYs = [];
            while (i--) {
                this.masonry.colYs.push(0);
            }
        },

        _masonryLayout: function ($elems) {
            var instance = this,
                props = instance.masonry;
            $elems.each(function () {
                var $this = $(this),
                    //how many columns does this brick span
                    colSpan = Math.ceil($this.outerWidth(true) / props.columnWidth);
                colSpan = Math.min(colSpan, props.cols);

                if (colSpan === 1) {
                    // if brick spans only one column, just like singleMode
                    instance._masonryPlaceBrick($this, props.colYs);
                } else {
                    // brick spans more than one column
                    // how many different places could this brick fit horizontally
                    var groupCount = props.cols + 1 - colSpan,
                        groupY = [],
                        groupColY,
                        i;

                    // for each group potential horizontal position
                    for (i = 0; i < groupCount; i++) {
                        // make an array of colY values for that one group
                        groupColY = props.colYs.slice(i, i + colSpan);
                        // and get the max value of the array
                        groupY[i] = Math.max.apply(Math, groupColY);
                    }

                    instance._masonryPlaceBrick($this, groupY);
                }
            });
        },

        // worker method that places brick in the columnSet
        //   with the the minY
        _masonryPlaceBrick: function ($brick, setY) {
            // get the minimum Y value from the columns
            var minimumY = Math.min.apply(Math, setY),
                shortCol = 0;

            // Find index of short column, the first from the left
            for (var i = 0, len = setY.length; i < len; i++) {
                if (setY[i] === minimumY) {
                    shortCol = i;
                    break;
                }
            }

            // position the brick
            var x = this.masonry.columnWidth * shortCol,
                y = minimumY;
            this._pushPosition($brick, x, y);

            // apply setHeight to necessary columns
            var setHeight = minimumY + $brick.outerHeight(true),
                setSpan = this.masonry.cols + 1 - len;
            for (i = 0; i < setSpan; i++) {
                this.masonry.colYs[shortCol + i] = setHeight;
            }

        },

        _masonryGetContainerSize: function () {
            var containerHeight = Math.max.apply(Math, this.masonry.colYs);
            return {
                height: containerHeight
            };
        },

        _masonryResizeChanged: function () {
            return this._checkIfSegmentsChanged();
        },

        // ====================== fitRows ======================

        _fitRowsReset: function () {
            this.fitRows = {
                x: 0,
                y: 0,
                height: 0
            };
        },

        _fitRowsLayout: function ($elems) {
            var instance = this,
                containerWidth = this.element.width(),
                props = this.fitRows;

            $elems.each(function () {
                var $this = $(this),
                    atomW = $this.outerWidth(true),
                    atomH = $this.outerHeight(true);

                if (props.x !== 0 && atomW + props.x > containerWidth) {
                    // if this element cannot fit in the current row
                    props.x = 0;
                    props.y = props.height;
                }

                // position the atom
                instance._pushPosition($this, props.x, props.y);

                props.height = Math.max(props.y + atomH, props.height);
                props.x += atomW;

            });
        },

        _fitRowsGetContainerSize: function () {
            return {
                height: this.fitRows.height
            };
        },

        _fitRowsResizeChanged: function () {
            return true;
        },


        // ====================== cellsByRow ======================

        _cellsByRowReset: function () {
            this.cellsByRow = {
                index: 0
            };
            // get this.cellsByRow.columnWidth
            this._getSegments();
            // get this.cellsByRow.rowHeight
            this._getSegments(true);
        },

        _cellsByRowLayout: function ($elems) {
            var instance = this,
                props = this.cellsByRow;
            $elems.each(function () {
                var $this = $(this),
                    col = props.index % props.cols,
                    row = Math.floor(props.index / props.cols),
                    x = (col + 0.5) * props.columnWidth - $this.outerWidth(true) / 2,
                    y = (row + 0.5) * props.rowHeight - $this.outerHeight(true) / 2;
                instance._pushPosition($this, x, y);
                props.index++;
            });
        },

        _cellsByRowGetContainerSize: function () {
            return {
                height: Math.ceil(this.$filteredAtoms.length / this.cellsByRow.cols) * this.cellsByRow.rowHeight + this.offset.top
            };
        },

        _cellsByRowResizeChanged: function () {
            return this._checkIfSegmentsChanged();
        },


        // ====================== straightDown ======================

        _straightDownReset: function () {
            this.straightDown = {
                y: 0
            };
        },

        _straightDownLayout: function ($elems) {
            var instance = this;
            $elems.each(function (i) {
                var $this = $(this);
                instance._pushPosition($this, 0, instance.straightDown.y);
                instance.straightDown.y += $this.outerHeight(true);
            });
        },

        _straightDownGetContainerSize: function () {
            return {
                height: this.straightDown.y
            };
        },

        _straightDownResizeChanged: function () {
            return true;
        },


        // ====================== masonryHorizontal ======================

        _masonryHorizontalReset: function () {
            // layout-specific props
            this.masonryHorizontal = {};
            // FIXME shouldn't have to call this again
            this._getSegments(true);
            var i = this.masonryHorizontal.rows;
            this.masonryHorizontal.rowXs = [];
            while (i--) {
                this.masonryHorizontal.rowXs.push(0);
            }
        },

        _masonryHorizontalLayout: function ($elems) {
            var instance = this,
                props = instance.masonryHorizontal;
            $elems.each(function () {
                var $this = $(this),
                    //how many rows does this brick span
                    rowSpan = Math.ceil($this.outerHeight(true) / props.rowHeight);
                rowSpan = Math.min(rowSpan, props.rows);

                if (rowSpan === 1) {
                    // if brick spans only one column, just like singleMode
                    instance._masonryHorizontalPlaceBrick($this, props.rowXs);
                } else {
                    // brick spans more than one row
                    // how many different places could this brick fit horizontally
                    var groupCount = props.rows + 1 - rowSpan,
                        groupX = [],
                        groupRowX, i;

                    // for each group potential horizontal position
                    for (i = 0; i < groupCount; i++) {
                        // make an array of colY values for that one group
                        groupRowX = props.rowXs.slice(i, i + rowSpan);
                        // and get the max value of the array
                        groupX[i] = Math.max.apply(Math, groupRowX);
                    }

                    instance._masonryHorizontalPlaceBrick($this, groupX);
                }
            });
        },

        _masonryHorizontalPlaceBrick: function ($brick, setX) {
            // get the minimum Y value from the columns
            var minimumX = Math.min.apply(Math, setX),
                smallRow = 0;
            // Find index of smallest row, the first from the top
            for (var i = 0, len = setX.length; i < len; i++) {
                if (setX[i] === minimumX) {
                    smallRow = i;
                    break;
                }
            }

            // position the brick
            var x = minimumX,
                y = this.masonryHorizontal.rowHeight * smallRow;
            this._pushPosition($brick, x, y);

            // apply setHeight to necessary columns
            var setWidth = minimumX + $brick.outerWidth(true),
                setSpan = this.masonryHorizontal.rows + 1 - len;
            for (i = 0; i < setSpan; i++) {
                this.masonryHorizontal.rowXs[smallRow + i] = setWidth;
            }
        },

        _masonryHorizontalGetContainerSize: function () {
            var containerWidth = Math.max.apply(Math, this.masonryHorizontal.rowXs);
            return {
                width: containerWidth
            };
        },

        _masonryHorizontalResizeChanged: function () {
            return this._checkIfSegmentsChanged(true);
        },


        // ====================== fitColumns ======================

        _fitColumnsReset: function () {
            this.fitColumns = {
                x: 0,
                y: 0,
                width: 0
            };
        },

        _fitColumnsLayout: function ($elems) {
            var instance = this,
                containerHeight = this.element.height(),
                props = this.fitColumns;
            $elems.each(function () {
                var $this = $(this),
                    atomW = $this.outerWidth(true),
                    atomH = $this.outerHeight(true);

                if (props.y !== 0 && atomH + props.y > containerHeight) {
                    // if this element cannot fit in the current column
                    props.x = props.width;
                    props.y = 0;
                }

                // position the atom
                instance._pushPosition($this, props.x, props.y);

                props.width = Math.max(props.x + atomW, props.width);
                props.y += atomH;

            });
        },

        _fitColumnsGetContainerSize: function () {
            return {
                width: this.fitColumns.width
            };
        },

        _fitColumnsResizeChanged: function () {
            return true;
        },



        // ====================== cellsByColumn ======================

        _cellsByColumnReset: function () {
            this.cellsByColumn = {
                index: 0
            };
            // get this.cellsByColumn.columnWidth
            this._getSegments();
            // get this.cellsByColumn.rowHeight
            this._getSegments(true);
        },

        _cellsByColumnLayout: function ($elems) {
            var instance = this,
                props = this.cellsByColumn;
            $elems.each(function () {
                var $this = $(this),
                    col = Math.floor(props.index / props.rows),
                    row = props.index % props.rows,
                    x = (col + 0.5) * props.columnWidth - $this.outerWidth(true) / 2,
                    y = (row + 0.5) * props.rowHeight - $this.outerHeight(true) / 2;
                instance._pushPosition($this, x, y);
                props.index++;
            });
        },

        _cellsByColumnGetContainerSize: function () {
            return {
                width: Math.ceil(this.$filteredAtoms.length / this.cellsByColumn.rows) * this.cellsByColumn.columnWidth
            };
        },

        _cellsByColumnResizeChanged: function () {
            return this._checkIfSegmentsChanged(true);
        },

        // ====================== straightAcross ======================

        _straightAcrossReset: function () {
            this.straightAcross = {
                x: 0
            };
        },

        _straightAcrossLayout: function ($elems) {
            var instance = this;
            $elems.each(function (i) {
                var $this = $(this);
                instance._pushPosition($this, instance.straightAcross.x, 0);
                instance.straightAcross.x += $this.outerWidth(true);
            });
        },

        _straightAcrossGetContainerSize: function () {
            return {
                width: this.straightAcross.x
            };
        },

        _straightAcrossResizeChanged: function () {
            return true;
        }

    };


    // ======================= imagesLoaded Plugin ===============================
    /*!
     * jQuery imagesLoaded plugin v1.1.0
     * http://github.com/desandro/imagesloaded
     *
     * MIT License. by Paul Irish et al.
     */


    // $('#my-container').imagesLoaded(myFunction)
    // or
    // $('img').imagesLoaded(myFunction)

    // execute a callback when all images have loaded.
    // needed because .load() doesn't work on cached images

    // callback function gets image collection as argument
    //  `this` is the container

    $.fn.imagesLoaded = function (callback) {
        var $this = this,
            $images = $this.find('img').add($this.filter('img')),
            len = $images.length,
            blank = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==',
            loaded = [];

        function triggerCallback() {
            callback.call($this, $images);
        }

        function imgLoaded(event) {
            var img = event.target;
            if (img.src !== blank && $.inArray(img, loaded) === -1) {
                loaded.push(img);
                if (--len <= 0) {
                    setTimeout(triggerCallback);
                    $images.unbind('.imagesLoaded', imgLoaded);
                }
            }
        }

        // if no images, trigger immediately
        if (!len) {
            triggerCallback();
        }

        $images.bind('load.imagesLoaded error.imagesLoaded', imgLoaded).each(function () {
            // cached images don't fire load sometimes, so we reset src.
            var src = this.src;
            // webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f
            // data uri bypasses webkit log warning (thx doug jones)
            this.src = blank;
            this.src = src;
        });

        return $this;
    };


    // helper function for logging errors
    // $.error breaks jQuery chaining
    var logError = function (message) {
        if (window.console) {
            window.console.error(message);
        }
    };

    // =======================  Plugin bridge  ===============================
    // leverages data method to either create or return $.Isotope constructor
    // A bit from jQuery UI
    //   https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.widget.js
    // A bit from jcarousel
    //   https://github.com/jsor/jcarousel/blob/master/lib/jquery.jcarousel.js

    $.fn.isotope = function (options, callback) {
        if (typeof options === 'string') {
            // call method
            var args = Array.prototype.slice.call(arguments, 1);

            this.each(function () {
                var instance = $.data(this, 'isotope');
                if (!instance) {
                    logError("cannot call methods on isotope prior to initialization; " +
                        "attempted to call method '" + options + "'");
                    return;
                }
                if (!$.isFunction(instance[options]) || options.charAt(0) === "_") {
                    logError("no such method '" + options + "' for isotope instance");
                    return;
                }
                // apply method
                instance[options].apply(instance, args);
            });
        } else {
            this.each(function () {
                var instance = $.data(this, 'isotope');
                if (instance) {
                    // apply options & init
                    instance.option(options);
                    instance._init(callback);
                } else {
                    // initialize new instance
                    $.data(this, 'isotope', new $.Isotope(options, this, callback));
                }
            });
        }
        // return jQuery object
        // so plugin methods do not have to
        return this;
    };

})(window, jQuery);

/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function ($) {
    $.cookie = function (key, value, options) {

        // key and at least value given, set cookie...
        if (arguments.length > 1 && (!/Object/.test(Object.prototype.toString.call(value)) || value === null || value === undefined)) {
            options = $.extend({}, options);

            if (value === null || value === undefined) {
                options.expires = -1;
            }

            if (typeof options.expires === 'number') {
                var days = options.expires,
                    t = options.expires = new Date();
                t.setDate(t.getDate() + days);
            }

            value = String(value);

            return (document.cookie = [
                encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value),
                options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
                options.path ? '; path=' + options.path : '',
                options.domain ? '; domain=' + options.domain : '',
                options.secure ? '; secure' : ''
            ].join(''));
        }

        // key and possibly options given, get cookie...
        options = value || {};
        var decode = options.raw ? function (s) {
                return s;
            } : decodeURIComponent;

        var pairs = document.cookie.split('; ');
        for (var i = 0, pair; pair = pairs[i] && pairs[i].split('='); i++) {
            if (decode(pair[0]) === key) return decode(pair[1] || ''); // IE saves cookies with empty string as "c; ", e.g. without "=" as opposed to EOMB, thus pair[1] may be undefined
        }
        return null;
    };
})(jQuery);

/*

	Supersized - Fullscreen Slideshow jQuery Plugin
	Version : 3.2.7
	Site	: www.buildinternet.com/project/supersized

	Author	: Sam Dunn
	Company : One Mighty Roar (www.onemightyroar.com)
	License : MIT License / GPL License

*/

(function ($) {

    /* Place Supersized Elements
	----------------------------*/

    $.supersized = function (options) {

        /* Variables
		----------------------------*/
        var el = '#supersized',
            base = this;
        // Access to jQuery and DOM versions of element
        base.$el = $(el);
        base.el = el;
        vars = $.supersized.vars;

        // Add a reverse reference to the DOM object
        base.$el.data("supersized", base);
        api = base.$el.data('supersized');

        base.init = function () {
            // Combine options and vars
            $.supersized.vars = $.extend($.supersized.vars, $.supersized.themeVars);
            $.supersized.vars.options = $.extend({}, $.supersized.defaultOptions, $.supersized.themeOptions, options);
            base.options = $.supersized.vars.options;

            base._build();
        };


        /* Build Elements
		----------------------------*/
        base._build = function () {
            // Add in slide markers
            var thisSlide = 0,
                slideSet = '',
                markers = '',
                markerContent,
                thumbMarkers = '',
                thumbImage;

            while (thisSlide <= base.options.slides.length - 1) {
                //Determine slide link content
                switch (base.options.slide_links) {
                case 'num':
                    markerContent = thisSlide + 1;
                    break;
                case 'name':
                    markerContent = base.options.slides[thisSlide].title;
                    break;
                case 'blank':
                    markerContent = '';
                    break;
                }

                slideSet = slideSet + '<li class="slide-' + thisSlide + '"></li>';

                if (thisSlide == base.options.start_slide - 1) {
                    // Slide links
                    if (base.options.slide_links) markers = markers + '<li class="slide-link-' + thisSlide + ' current-slide"><a>' + markerContent + '</a></li>';
                    // Slide Thumbnail Links
                    if (base.options.thumb_links) {
                        base.options.slides[thisSlide].thumb ? thumbImage = base.options.slides[thisSlide].thumb : thumbImage = base.options.slides[thisSlide].image;
                        thumbMarkers = thumbMarkers + '<li class="thumb' + thisSlide + ' current-thumb"><img src="' + thumbImage + '"/></li>';
                    };
                } else {
                    // Slide links
                    if (base.options.slide_links) markers = markers + '<li class="slide-link-' + thisSlide + '" ><a>' + markerContent + '</a></li>';
                    // Slide Thumbnail Links
                    if (base.options.thumb_links) {
                        base.options.slides[thisSlide].thumb ? thumbImage = base.options.slides[thisSlide].thumb : thumbImage = base.options.slides[thisSlide].image;
                        thumbMarkers = thumbMarkers + '<li class="thumb' + thisSlide + '"><img src="' + thumbImage + '"/></li>';
                    };
                }
                thisSlide++;
            }

            if (base.options.slide_links) $(vars.slide_list).append(markers);
            if (base.options.thumb_links && vars.thumb_tray.length) {
                $(vars.thumb_tray).append('<ul id="' + vars.thumb_list.replace('#', '') + '">' + thumbMarkers + '</ul>');
            }

            $(base.el).append(slideSet);

            // Add in thumbnails
            if (base.options.thumbnail_navigation) {
                // Load previous thumbnail
                vars.current_slide - 1 < 0 ? prevThumb = base.options.slides.length - 1 : prevThumb = vars.current_slide - 1;
                $(vars.prev_thumb).show().html($("<img/>").attr("src", base.options.slides[prevThumb].image));

                // Load next thumbnail
                vars.current_slide == base.options.slides.length - 1 ? nextThumb = 0 : nextThumb = vars.current_slide + 1;
                $(vars.next_thumb).show().html($("<img/>").attr("src", base.options.slides[nextThumb].image));
            }

            base._start(); // Get things started
        };


        /* Initialize
		----------------------------*/
        base._start = function () {

            // Determine if starting slide random
            if (base.options.start_slide) {
                vars.current_slide = base.options.start_slide - 1;
            } else {
                vars.current_slide = Math.floor(Math.random() * base.options.slides.length); // Generate random slide number
            }

            // If links should open in new window
            var linkTarget = base.options.new_window ? ' target="_blank"' : '';

            // Set slideshow quality (Supported only in FF and IE, no Webkit)
            if (base.options.performance == 3) {
                base.$el.addClass('speed'); // Faster transitions
            } else if ((base.options.performance == 1) || (base.options.performance == 2)) {
                base.$el.addClass('quality'); // Higher image quality
            }

            // Shuffle slide order if needed
            if (base.options.random) {
                arr = base.options.slides;
                for (var j, x, i = arr.length; i; j = parseInt(Math.random() * i), x = arr[--i], arr[i] = arr[j], arr[j] = x); // Fisher-Yates shuffle algorithm (jsfromhell.com/array/shuffle)
                base.options.slides = arr;
            }

            /*-----Load initial set of images-----*/

            if (base.options.slides.length > 1) {
                if (base.options.slides.length > 2) {
                    // Set previous image
                    vars.current_slide - 1 < 0 ? loadPrev = base.options.slides.length - 1 : loadPrev = vars.current_slide - 1; // If slide is 1, load last slide as previous
                    var imageLink = (base.options.slides[loadPrev].url) ? "href='" + base.options.slides[loadPrev].url + "'" : "";

                    var imgPrev = $('<img src="' + base.options.slides[loadPrev].image + '"/>');
                    var slidePrev = base.el + ' li:eq(' + loadPrev + ')';
                    imgPrev.appendTo(slidePrev).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading prevslide');

                    imgPrev.load(function () {
                        var oldDisplay = $('#supersized').css('display');
                        $('#supersized').css('display', 'block');
                        $(this).data('origWidth', $(this).width()).data('origHeight', $(this).height());
                        $('#supersized').css('display', oldDisplay);
                        base.resizeNow(); // Resize background image
                    }); // End Load
                }
            } else {
                // Slideshow turned off if there is only one slide
                base.options.slideshow = 0;
            }

            // Set current image
            imageLink = (api.getField('url')) ? "href='" + api.getField('url') + "'" : "";
            var img = $('<img src="' + api.getField('image') + '"/>');

            var slideCurrent = base.el + ' li:eq(' + vars.current_slide + ')';
            img.appendTo(slideCurrent).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading activeslide');

            img.load(function () {
                base._origDim($(this));
                base.resizeNow(); // Resize background image
                base.launch();
                if (typeof theme != 'undefined' && typeof theme._init == "function") theme._init(); // Load Theme
            });

            if (base.options.slides.length > 1) {
                // Set next image
                vars.current_slide == base.options.slides.length - 1 ? loadNext = 0 : loadNext = vars.current_slide + 1; // If slide is last, load first slide as next
                imageLink = (base.options.slides[loadNext].url) ? "href='" + base.options.slides[loadNext].url + "'" : "";

                var imgNext = $('<img src="' + base.options.slides[loadNext].image + '"/>');
                var slideNext = base.el + ' li:eq(' + loadNext + ')';
                imgNext.appendTo(slideNext).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading');

                imgNext.load(function () {
                    var oldDisplay = $('#supersized').css('display');
                    $('#supersized').css('display', 'block');
                    $(this).data('origWidth', $(this).width()).data('origHeight', $(this).height());
                    $('#supersized').css('display', oldDisplay);
                    base.resizeNow(); // Resize background image
                }); // End Load
            }
            /*-----End load initial images-----*/

            //  Hide elements to be faded in
            base.$el.css('visibility', 'hidden');
            $('.load-item').hide();

        };


        /* Launch Supersized
		----------------------------*/
        base.launch = function () {

            base.$el.css('visibility', 'visible').hide().fadeIn(500);
            $('#supersized-loader').remove(); //Hide loading animation

            // Call theme function for before slide transition
            if (typeof theme != 'undefined' && typeof theme.beforeAnimation == "function") theme.beforeAnimation('next');
            $('.load-item').show();

            // Keyboard Navigation
            if (base.options.keyboard_nav) {
                $(document.documentElement).keyup(function (event) {

                    if (vars.in_animation) return false; // Abort if currently animating

                    // Left Arrow or Down Arrow
                    if ((event.keyCode == 37) || (event.keyCode == 40)) {
                        clearInterval(vars.slideshow_interval); // Stop slideshow, prevent buildup
                        base.prevSlide();

                        // Right Arrow or Up Arrow
                    } else if ((event.keyCode == 39) || (event.keyCode == 38)) {
                        clearInterval(vars.slideshow_interval); // Stop slideshow, prevent buildup
                        base.nextSlide();

                        // Spacebar
                    } else if (event.keyCode == 32 && !vars.hover_pause) {
                        clearInterval(vars.slideshow_interval); // Stop slideshow, prevent buildup
                        base.playToggle();
                    }

                });
            }

            // Pause when hover on image
            if (base.options.slideshow && base.options.pause_hover) {
                $(base.el).hover(function () {
                    if (vars.in_animation) return false; // Abort if currently animating
                    vars.hover_pause = true; // Mark slideshow paused from hover
                    if (!vars.is_paused) {
                        vars.hover_pause = 'resume'; // It needs to resume afterwards
                        base.playToggle();
                    }
                }, function () {
                    if (vars.hover_pause == 'resume') {
                        base.playToggle();
                        vars.hover_pause = false;
                    }
                });
            }

            if (base.options.slide_links) {
                // Slide marker clicked
                $(vars.slide_list + '> li').click(function () {

                    if ($(this).attr('id') != 'playPause') {

                        index = $(vars.slide_list + '> li').index(this);
                        targetSlide = index;

                        base.goTo(targetSlide);
                        return false;

                    }

                });
            }

            // Thumb marker clicked
            if (base.options.thumb_links) {
                $(vars.thumb_list + '> li').click(function () {

                    index = $(vars.thumb_list + '> li').index(this);
                    targetSlide = index + 1;

                    api.goTo(targetSlide);
                    return false;

                });
            }

            // Start slideshow if enabled
            if (base.options.slideshow && base.options.slides.length > 1) {

                // Start slideshow if autoplay enabled
                if (base.options.autoplay && base.options.slides.length > 1) {
                    vars.slideshow_interval = setInterval(base.nextSlide, base.options.slide_interval); // Initiate slide interval
                } else {
                    vars.is_paused = true; // Mark as paused
                }

                //Prevent navigation items from being dragged
                $('.load-item img').bind("contextmenu mousedown", function () {
                    return false;
                });

            }

            // Adjust image when browser is resized
            $(window).resize(function () {
                base.resizeNow();
            });

        };


        /* Resize Images
		----------------------------*/
        base.resizeNow = function () {

            return base.$el.each(function () {
                //  Resize each image seperately
                $('img', base.el).each(function () {

                    thisSlide = $(this);
                    var ratio = (thisSlide.data('origHeight') / thisSlide.data('origWidth')).toFixed(2); // Define image ratio

                    // Gather browser size
                    var browserwidth = base.$el.width(),
                        browserheight = base.$el.height(),
                        offset;

                    /*-----Resize Image-----*/
                    if (base.options.fit_always) { // Fit always is enabled
                        if ((browserheight / browserwidth) > ratio) {
                            resizeWidth();
                        } else {
                            resizeHeight();
                        }
                    } else { // Normal Resize
                        if ((browserheight <= base.options.min_height) && (browserwidth <= base.options.min_width)) { // If window smaller than minimum width and height

                            if ((browserheight / browserwidth) > ratio) {
                                base.options.fit_landscape && ratio < 1 ? resizeWidth(true) : resizeHeight(true); // If landscapes are set to fit
                            } else {
                                base.options.fit_portrait && ratio >= 1 ? resizeHeight(true) : resizeWidth(true); // If portraits are set to fit
                            }

                        } else if (browserwidth <= base.options.min_width) { // If window only smaller than minimum width

                            if ((browserheight / browserwidth) > ratio) {
                                base.options.fit_landscape && ratio < 1 ? resizeWidth(true) : resizeHeight(); // If landscapes are set to fit
                            } else {
                                base.options.fit_portrait && ratio >= 1 ? resizeHeight() : resizeWidth(true); // If portraits are set to fit
                            }

                        } else if (browserheight <= base.options.min_height) { // If window only smaller than minimum height

                            if ((browserheight / browserwidth) > ratio) {
                                base.options.fit_landscape && ratio < 1 ? resizeWidth() : resizeHeight(true); // If landscapes are set to fit
                            } else {
                                base.options.fit_portrait && ratio >= 1 ? resizeHeight(true) : resizeWidth(); // If portraits are set to fit
                            }

                        } else { // If larger than minimums

                            if ((browserheight / browserwidth) > ratio) {
                                base.options.fit_landscape && ratio < 1 ? resizeWidth() : resizeHeight(); // If landscapes are set to fit
                            } else {
                                base.options.fit_portrait && ratio >= 1 ? resizeHeight() : resizeWidth(); // If portraits are set to fit
                            }

                        }
                    }
                    /*-----End Image Resize-----*/


                    /*-----Resize Functions-----*/

                    function resizeWidth(minimum) {
                        if (minimum) { // If minimum height needs to be considered
                            if (thisSlide.width() < browserwidth || thisSlide.width() < base.options.min_width) {
                                if (thisSlide.width() * ratio >= base.options.min_height) {
                                    thisSlide.width(base.options.min_width);
                                    thisSlide.height(thisSlide.width() * ratio);
                                } else {
                                    resizeHeight();
                                }
                            }
                        } else {
                            if (base.options.min_height >= browserheight && !base.options.fit_landscape) { // If minimum height needs to be considered
                                if (browserwidth * ratio >= base.options.min_height || (browserwidth * ratio >= base.options.min_height && ratio <= 1)) { // If resizing would push below minimum height or image is a landscape
                                    thisSlide.width(browserwidth);
                                    thisSlide.height(browserwidth * ratio);
                                } else if (ratio > 1) { // Else the image is portrait
                                    thisSlide.height(base.options.min_height);
                                    thisSlide.width(thisSlide.height() / ratio);
                                } else if (thisSlide.width() < browserwidth) {
                                    thisSlide.width(browserwidth);
                                    thisSlide.height(thisSlide.width() * ratio);
                                }
                            } else { // Otherwise, resize as normal
                                thisSlide.width(browserwidth);
                                thisSlide.height(browserwidth * ratio);
                            }
                        }
                    };

                    function resizeHeight(minimum) {
                        if (minimum) { // If minimum height needs to be considered
                            if (thisSlide.height() < browserheight) {
                                if (thisSlide.height() / ratio >= base.options.min_width) {
                                    thisSlide.height(base.options.min_height);
                                    thisSlide.width(thisSlide.height() / ratio);
                                } else {
                                    resizeWidth(true);
                                }
                            }
                        } else { // Otherwise, resized as normal
                            if (base.options.min_width >= browserwidth) { // If minimum width needs to be considered
                                if (browserheight / ratio >= base.options.min_width || ratio > 1) { // If resizing would push below minimum width or image is a portrait
                                    thisSlide.height(browserheight);
                                    thisSlide.width(browserheight / ratio);
                                } else if (ratio <= 1) { // Else the image is landscape
                                    thisSlide.width(base.options.min_width);
                                    thisSlide.height(thisSlide.width() * ratio);
                                }
                            } else { // Otherwise, resize as normal
                                thisSlide.height(browserheight);
                                thisSlide.width(browserheight / ratio);
                            }
                        }
                    };

                    /*-----End Resize Functions-----*/

                    if (thisSlide.parents('li').hasClass('image-loading')) {
                        $('.image-loading').removeClass('image-loading');
                    }

                    // Horizontally Center
                    if (base.options.horizontal_center) {
                        $(this).css('left', (browserwidth - $(this).width()) / 2);
                    }

                    // Vertically Center
                    if (base.options.vertical_center) {
                        $(this).css('top', (browserheight - $(this).height()) / 2);
                    }

                });

                // Basic image drag and right click protection
                if (base.options.image_protect) {

                    $('img', base.el).bind("contextmenu mousedown", function () {
                        return false;
                    });

                }

                return false;

            });

        };


        /* Next Slide
		----------------------------*/
        base.nextSlide = function () {

            if (vars.in_animation || !api.options.slideshow) return false; // Abort if currently animating
            else vars.in_animation = true; // Otherwise set animation marker

            clearInterval(vars.slideshow_interval); // Stop slideshow

            var slides = base.options.slides, // Pull in slides array
                liveslide = base.$el.find('.activeslide'); // Find active slide
            $('.prevslide').removeClass('prevslide');
            liveslide.removeClass('activeslide').addClass('prevslide'); // Remove active class & update previous slide

            // Get the slide number of new slide
            vars.current_slide + 1 == base.options.slides.length ? vars.current_slide = 0 : vars.current_slide++;

            var nextslide = $(base.el + ' li:eq(' + vars.current_slide + ')'),
                prevslide = base.$el.find('.prevslide');

            // If hybrid mode is on drop quality for transition
            if (base.options.performance == 1) base.$el.removeClass('quality').addClass('speed');


            /*-----Load Image-----*/

            loadSlide = false;

            vars.current_slide == base.options.slides.length - 1 ? loadSlide = 0 : loadSlide = vars.current_slide + 1; // Determine next slide

            var targetList = base.el + ' li:eq(' + loadSlide + ')';
            if (!$(targetList).html()) {

                // If links should open in new window
                var linkTarget = base.options.new_window ? ' target="_blank"' : '';

                imageLink = (base.options.slides[loadSlide].url) ? "href='" + base.options.slides[loadSlide].url + "'" : ""; // If link exists, build it
                var img = $('<img src="' + base.options.slides[loadSlide].image + '"/>');

                img.appendTo(targetList).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading').css('visibility', 'hidden');

                img.load(function () {
                    base._origDim($(this));
                    base.resizeNow();
                }); // End Load
            };

            // Update thumbnails (if enabled)
            if (base.options.thumbnail_navigation == 1) {

                // Load previous thumbnail
                vars.current_slide - 1 < 0 ? prevThumb = base.options.slides.length - 1 : prevThumb = vars.current_slide - 1;
                $(vars.prev_thumb).html($("<img/>").attr("src", base.options.slides[prevThumb].image));

                // Load next thumbnail
                nextThumb = loadSlide;
                $(vars.next_thumb).html($("<img/>").attr("src", base.options.slides[nextThumb].image));

            }



            /*-----End Load Image-----*/


            // Call theme function for before slide transition
            if (typeof theme != 'undefined' && typeof theme.beforeAnimation == "function") theme.beforeAnimation('next');

            //Update slide markers
            if (base.options.slide_links) {
                $('.current-slide').removeClass('current-slide');
                $(vars.slide_list + '> li').eq(vars.current_slide + 1).addClass('current-slide');
            }

            nextslide.css('visibility', 'hidden').addClass('activeslide'); // Update active slide

            switch (base.options.transition) {
            case 0:
            case 'none': // No transition
                nextslide.css('visibility', 'visible');
                vars.in_animation = false;
                base.afterAnimation();
                break;
            case 1:
            case 'fade': // Fade
                nextslide.animate({
                    opacity: 0
                }, 0).css('visibility', 'visible').animate({
                    opacity: 1,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 2:
            case 'slideTop': // Slide Top
                nextslide.animate({
                    top: -base.$el.height()
                }, 0).css('visibility', 'visible').animate({
                    top: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 3:
            case 'slideRight': // Slide Right
                nextslide.animate({
                    left: base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 4:
            case 'slideBottom': // Slide Bottom
                nextslide.animate({
                    top: base.$el.height()
                }, 0).css('visibility', 'visible').animate({
                    top: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 5:
            case 'slideLeft': // Slide Left
                nextslide.animate({
                    left: -base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 6:
            case 'carouselRight': // Carousel Right
                nextslide.animate({
                    left: base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                liveslide.animate({
                    left: -base.$el.width(),
                    avoidTransforms: false
                }, base.options.transition_speed);
                break;
            case 7:
            case 'carouselLeft': // Carousel Left
                nextslide.animate({
                    left: -base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                liveslide.animate({
                    left: base.$el.width(),
                    avoidTransforms: false
                }, base.options.transition_speed);
                break;
            }
            return false;
        };


        /* Previous Slide
		----------------------------*/
        base.prevSlide = function () {

            if (vars.in_animation || !api.options.slideshow) return false; // Abort if currently animating
            else vars.in_animation = true; // Otherwise set animation marker

            clearInterval(vars.slideshow_interval); // Stop slideshow

            var slides = base.options.slides, // Pull in slides array
                liveslide = base.$el.find('.activeslide'); // Find active slide
            $('.prevslide').removeClass('prevslide');
            liveslide.removeClass('activeslide').addClass('prevslide'); // Remove active class & update previous slide

            // Get current slide number
            vars.current_slide == 0 ? vars.current_slide = base.options.slides.length - 1 : vars.current_slide--;

            var nextslide = $(base.el + ' li:eq(' + vars.current_slide + ')'),
                prevslide = base.$el.find('.prevslide');

            // If hybrid mode is on drop quality for transition
            if (base.options.performance == 1) base.$el.removeClass('quality').addClass('speed');


            /*-----Load Image-----*/

            loadSlide = vars.current_slide;

            var targetList = base.el + ' li:eq(' + loadSlide + ')';
            if (!$(targetList).html()) {
                // If links should open in new window
                var linkTarget = base.options.new_window ? ' target="_blank"' : '';
                imageLink = (base.options.slides[loadSlide].url) ? "href='" + base.options.slides[loadSlide].url + "'" : ""; // If link exists, build it
                var img = $('<img src="' + base.options.slides[loadSlide].image + '"/>');

                img.appendTo(targetList).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading').css('visibility', 'hidden');

                img.load(function () {
                    base._origDim($(this));
                    base.resizeNow();
                }); // End Load
            };

            // Update thumbnails (if enabled)
            if (base.options.thumbnail_navigation == 1) {

                // Load previous thumbnail
                //prevThumb = loadSlide;
                loadSlide == 0 ? prevThumb = base.options.slides.length - 1 : prevThumb = loadSlide - 1;
                $(vars.prev_thumb).html($("<img/>").attr("src", base.options.slides[prevThumb].image));

                // Load next thumbnail
                vars.current_slide == base.options.slides.length - 1 ? nextThumb = 0 : nextThumb = vars.current_slide + 1;
                $(vars.next_thumb).html($("<img/>").attr("src", base.options.slides[nextThumb].image));
            }

            /*-----End Load Image-----*/


            // Call theme function for before slide transition
            if (typeof theme != 'undefined' && typeof theme.beforeAnimation == "function") theme.beforeAnimation('prev');

            //Update slide markers
            if (base.options.slide_links) {
                $('.current-slide').removeClass('current-slide');
                $(vars.slide_list + '> li').eq(vars.current_slide + 1).addClass('current-slide');
            }

            nextslide.css('visibility', 'hidden').addClass('activeslide'); // Update active slide

            switch (base.options.transition) {
            case 0:
            case 'none': // No transition
                nextslide.css('visibility', 'visible');
                vars.in_animation = false;
                base.afterAnimation();
                break;
            case 1:
            case 'fade': // Fade
                nextslide.animate({
                    opacity: 0
                }, 0).css('visibility', 'visible').animate({
                    opacity: 1,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 2:
            case 'slideTop': // Slide Top (reverse)
                nextslide.animate({
                    top: base.$el.height()
                }, 0).css('visibility', 'visible').animate({
                    top: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 3:
            case 'slideRight': // Slide Right (reverse)
                nextslide.animate({
                    left: -base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 4:
            case 'slideBottom': // Slide Bottom (reverse)
                nextslide.animate({
                    top: -base.$el.height()
                }, 0).css('visibility', 'visible').animate({
                    top: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 5:
            case 'slideLeft': // Slide Left (reverse)
                nextslide.animate({
                    left: base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                break;
            case 6:
            case 'carouselRight': // Carousel Right (reverse)
                nextslide.animate({
                    left: -base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                liveslide.animate({
                    left: 0
                }, 0).animate({
                    left: base.$el.width(),
                    avoidTransforms: false
                }, base.options.transition_speed);
                break;
            case 7:
            case 'carouselLeft': // Carousel Left (reverse)
                nextslide.animate({
                    left: base.$el.width()
                }, 0).css('visibility', 'visible').animate({
                    left: 0,
                    avoidTransforms: false
                }, base.options.transition_speed, function () {
                    base.afterAnimation();
                });
                liveslide.animate({
                    left: 0
                }, 0).animate({
                    left: -base.$el.width(),
                    avoidTransforms: false
                }, base.options.transition_speed);
                break;
            }
            return false;
        };


        /* Play/Pause Toggle
		----------------------------*/
        base.playToggle = function () {

            if (vars.in_animation || !api.options.slideshow) return false; // Abort if currently animating

            if (vars.is_paused) {

                vars.is_paused = false;

                // Call theme function for play
                if (typeof theme != 'undefined' && typeof theme.playToggle == "function") theme.playToggle('play');

                // Resume slideshow
                vars.slideshow_interval = setInterval(base.nextSlide, base.options.slide_interval);

            } else {

                vars.is_paused = true;

                // Call theme function for pause
                if (typeof theme != 'undefined' && typeof theme.playToggle == "function") theme.playToggle('pause');

                // Stop slideshow
                clearInterval(vars.slideshow_interval);

            }

            return false;

        };


        /* Go to specific slide
		----------------------------*/
        base.goTo = function (targetSlide) {
            if (vars.in_animation || !api.options.slideshow) return false; // Abort if currently animating

            var totalSlides = base.options.slides.length;

            // If target outside range
            if (targetSlide < 0) {
                targetSlide = totalSlides;
            } else if (targetSlide > totalSlides) {
                targetSlide = 1;
            }
            targetSlide = totalSlides - targetSlide + 1;

            clearInterval(vars.slideshow_interval); // Stop slideshow, prevent buildup

            // Call theme function for goTo trigger
            if (typeof theme != 'undefined' && typeof theme.goTo == "function") theme.goTo();

            if (vars.current_slide == totalSlides - targetSlide) {
                if (!(vars.is_paused)) {
                    vars.slideshow_interval = setInterval(base.nextSlide, base.options.slide_interval);
                }
                return false;
            }

            // If ahead of current position
            if (totalSlides - targetSlide > vars.current_slide) {

                // Adjust for new next slide
                vars.current_slide = totalSlides - targetSlide - 1;
                vars.update_images = 'next';
                base._placeSlide(vars.update_images);

                //Otherwise it's before current position
            } else if (totalSlides - targetSlide < vars.current_slide) {

                // Adjust for new prev slide
                vars.current_slide = totalSlides - targetSlide + 1;
                vars.update_images = 'prev';
                base._placeSlide(vars.update_images);

            }

            // set active markers
            if (base.options.slide_links) {
                $(vars.slide_list + '> .current-slide').removeClass('current-slide');
                $(vars.slide_list + '> li').eq((totalSlides - targetSlide) + 1).addClass('current-slide');
            }

            if (base.options.thumb_links) {
                $(vars.thumb_list + '> .current-thumb').removeClass('current-thumb');
                $(vars.thumb_list + '> li').eq((totalSlides - targetSlide)).addClass('current-thumb');
            }

        };


        /* Place Slide
		----------------------------*/
        base._placeSlide = function (place) {

            // If links should open in new window
            var linkTarget = base.options.new_window ? ' target="_blank"' : '';

            loadSlide = false;

            if (place == 'next') {

                vars.current_slide == base.options.slides.length - 1 ? loadSlide = 0 : loadSlide = vars.current_slide + 1; // Determine next slide

                var targetList = base.el + ' li:eq(' + loadSlide + ')';

                if (!$(targetList).html()) {
                    // If links should open in new window
                    var linkTarget = base.options.new_window ? ' target="_blank"' : '';

                    imageLink = (base.options.slides[loadSlide].url) ? "href='" + base.options.slides[loadSlide].url + "'" : ""; // If link exists, build it
                    var img = $('<img src="' + base.options.slides[loadSlide].image + '"/>');

                    img.appendTo(targetList).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading').css('visibility', 'hidden');

                    img.load(function () {
                        base._origDim($(this));
                        base.resizeNow();
                    }); // End Load
                };

                base.nextSlide();

            } else if (place == 'prev') {

                vars.current_slide - 1 < 0 ? loadSlide = base.options.slides.length - 1 : loadSlide = vars.current_slide - 1; // Determine next slide

                var targetList = base.el + ' li:eq(' + loadSlide + ')';

                if (!$(targetList).html()) {
                    // If links should open in new window
                    var linkTarget = base.options.new_window ? ' target="_blank"' : '';

                    imageLink = (base.options.slides[loadSlide].url) ? "href='" + base.options.slides[loadSlide].url + "'" : ""; // If link exists, build it
                    var img = $('<img src="' + base.options.slides[loadSlide].image + '"/>');

                    img.appendTo(targetList).wrap('<a ' + imageLink + linkTarget + '></a>').parent().parent().addClass('image-loading').css('visibility', 'hidden');

                    img.load(function () {
                        base._origDim($(this));
                        base.resizeNow();
                    }); // End Load
                };
                base.prevSlide();
            }

        };


        /* Get Original Dimensions
		----------------------------*/
        base._origDim = function (targetSlide) {
            var oldDisplay = $('#supersized').css('display');
            $('#supersized').css('display', 'block');
            targetSlide.data('origWidth', targetSlide.width()).data('origHeight', targetSlide.height());
            $('#supersized').css('display', oldDisplay);
        };


        /* After Slide Animation
		----------------------------*/
        base.afterAnimation = function () {

            // If hybrid mode is on swap back to higher image quality
            if (base.options.performance == 1) {
                base.$el.removeClass('speed').addClass('quality');
            }

            // Update previous slide
            if (vars.update_images) {
                vars.current_slide - 1 < 0 ? setPrev = base.options.slides.length - 1 : setPrev = vars.current_slide - 1;
                vars.update_images = false;
                $('.prevslide').removeClass('prevslide');
                $(base.el + ' li:eq(' + setPrev + ')').addClass('prevslide');
            }

            vars.in_animation = false;

            // Resume slideshow
            if (!vars.is_paused && base.options.slideshow) {
                vars.slideshow_interval = setInterval(base.nextSlide, base.options.slide_interval);
                if (base.options.stop_loop && vars.current_slide == base.options.slides.length - 1) base.playToggle();
            }

            // Call theme function for after slide transition
            if (typeof theme != 'undefined' && typeof theme.afterAnimation == "function") theme.afterAnimation();

            return false;

        };

        base.getField = function (field) {
            return base.options.slides[vars.current_slide][field];
        };

        // Make it go!
        base.init();
    };


    /* Global Variables
	----------------------------*/
    $.supersized.vars = {

        // Elements
        thumb_tray: '#thumb-tray', // Thumbnail tray
        thumb_list: '#thumb-list', // Thumbnail list
        slide_list: '#slide-list', // Slide link list

        // Internal variables
        current_slide: 0, // Current slide number
        in_animation: false, // Prevents animations from stacking
        is_paused: false, // Tracks paused on/off
        hover_pause: false, // If slideshow is paused from hover
        slideshow_interval: false, // Stores slideshow timer
        update_images: false, // Trigger to update images after slide jump
        options: {} // Stores assembled options list

    };


    /* Default Options
	----------------------------*/
    $.supersized.defaultOptions = {

        // Functionality
        slideshow: 1, // Slideshow on/off
        autoplay: 1, // Slideshow starts playing automatically
        start_slide: 1, // Start slide (0 is random)
        stop_loop: 0, // Stops slideshow on last slide
        random: 0, // Randomize slide order (Ignores start slide)
        slide_interval: 5000, // Length between transitions
        transition: 1, // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
        transition_speed: 750, // Speed of transition
        new_window: 1, // Image links open in new window/tab
        pause_hover: 0, // Pause slideshow on hover
        keyboard_nav: 1, // Keyboard navigation on/off
        performance: 2, // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed //  (Only works for Firefox/IE, not Webkit)
        image_protect: 1, // Disables image dragging and right click with Javascript

        // Size & Position
        fit_always: 0, // Image will never exceed browser width or height (Ignores min. dimensions)
        fit_landscape: 0, // Landscape images will not exceed browser width
        fit_portrait: 0, // Portrait images will not exceed browser height
        min_width: 0, // Min width allowed (in pixels)
        min_height: 0, // Min height allowed (in pixels)
        horizontal_center: 1, // Horizontally center background
        vertical_center: 1, // Vertically center background


        // Components
        slide_links: 'num', // Individual links for each slide (Options: false, 'num', 'name', 'blank')
        thumb_links: 0, // Individual thumb links for each slide
        thumbnail_navigation: 0 // Thumbnail navigation

    };

    $.fn.supersized = function (options) {
        return this.each(function () {
            (new $.supersized(options));
        });
    };

})(jQuery);

/*

	Supersized - Fullscreen Slideshow jQuery Plugin
	Version : 3.2.7
	Theme 	: Shutter 1.1

	Site	: www.buildinternet.com/project/supersized
	Author	: Sam Dunn
	Company : One Mighty Roar (www.onemightyroar.com)
	License : MIT License / GPL License

*/
/*

	Supersized - Fullscreen Slideshow jQuery Plugin
	Version : 3.2.7
	Theme 	: Shutter 1.1

	Site	: www.buildinternet.com/project/supersized
	Author	: Sam Dunn
	Company : One Mighty Roar (www.onemightyroar.com)
	License : MIT License / GPL License

*/

var firstInit = true;

(function ($) {

    theme = {


        /* Initial Placement
		----------------------------*/
        _init: function () {

            $('#supersizedControls').css('zIndex', 99999);
            $('#supersized').animate({
                'opacity': 1
            }, 300);
            $('.slideProjects').children('a').delay(500).fadeTo(300, 1);
            $('.page-template-template-gallery-php .galleryContent').delay(650).fadeTo(300, 1, function () {
                $('.minimize').minimize($(this));
            });
            $('.page-template-template-slideshow-php .galleryContent').delay(0).fadeTo(0, 1, function () {
                $('.minimize').minimize($(this));
            });
            $('#slideList').delay(1000).fadeTo(300, 1);

            if (api.options.autoplay) {
                if (api.options.progress_bar) theme.progressBar();
            }

            if (firstInit) {

                // Center Slide Links
                if (api.options.slide_links) $(vars.slide_list).css('margin-left', -$(vars.slide_list).width() / 2);

                // Start progressbar if autoplay enabled


                /* Thumbnail Tray
			----------------------------*/
                // Hide tray off screen
                $(vars.thumb_tray).animate({
                    bottom: -$(vars.thumb_tray).height()
                }, 0);

                // Thumbnail Tray Toggle
                $(vars.tray_button).toggle(function () {
                    $(vars.thumb_tray).stop().animate({
                        bottom: 0,
                        avoidTransforms: true
                    }, 300);
                    if ($(vars.tray_arrow).attr('src')) $(vars.tray_arrow).attr("src", vars.image_path + "button-tray-down.png");
                    return false;
                }, function () {
                    $(vars.thumb_tray).stop().animate({
                        bottom: -$(vars.thumb_tray).height(),
                        avoidTransforms: true
                    }, 300);
                    if ($(vars.tray_arrow).attr('src')) $(vars.tray_arrow).attr("src", vars.image_path + "button-tray-up.png");
                    return false;
                });

                // Make thumb tray proper size
                $(vars.thumb_list).width($('> li', vars.thumb_list).length * $('> li', vars.thumb_list).outerWidth(true)); //Adjust to true width of thumb markers

                // Display total slides
                if ($(vars.slide_total).length) {
                    $(vars.slide_total).html(api.options.slides.length);
                }


                /* Thumbnail Tray Navigation
			----------------------------*/
                if (api.options.thumb_links) {
                    //Hide thumb arrows if not needed
                    if ($(vars.thumb_list).width() <= $(vars.thumb_tray).width()) {
                        $(vars.thumb_back + ',' + vars.thumb_forward).fadeOut(0);
                    }

                    // Thumb Intervals
                    vars.thumb_interval = Math.floor($(vars.thumb_tray).width() / $('> li', vars.thumb_list).outerWidth(true)) * $('> li', vars.thumb_list).outerWidth(true);
                    vars.thumb_page = 0;

                    // Cycle thumbs forward
                    $(vars.thumb_forward).click(function () {
                        if (vars.thumb_page - vars.thumb_interval <= -$(vars.thumb_list).width()) {
                            vars.thumb_page = 0;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        } else {
                            vars.thumb_page = vars.thumb_page - vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        }
                    });

                    // Cycle thumbs backwards
                    $(vars.thumb_back).click(function () {
                        if (vars.thumb_page + vars.thumb_interval > 0) {
                            vars.thumb_page = Math.floor($(vars.thumb_list).width() / vars.thumb_interval) * -vars.thumb_interval;
                            if ($(vars.thumb_list).width() <= -vars.thumb_page) vars.thumb_page = vars.thumb_page + vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        } else {
                            vars.thumb_page = vars.thumb_page + vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        }
                    });

                }


                /* Navigation Items
			----------------------------*/
                $(vars.next_slide).click(function () {
                    api.nextSlide();
                });

                $(vars.prev_slide).click(function () {
                    api.prevSlide();
                });

                // Full Opacity on Hover
                if (jQuery.support.opacity) {
                    $(vars.prev_slide + ',' + vars.next_slide).mouseover(function () {
                        $(this).stop().animate({
                            opacity: 1
                        }, 100);
                    }).mouseout(function () {
                        $(this).stop().animate({
                            opacity: 0.6
                        }, 100);
                    });
                }

                if (api.options.thumbnail_navigation) {
                    // Next thumbnail clicked
                    $(vars.next_thumb).click(function () {
                        api.nextSlide();
                    });
                    // Previous thumbnail clicked
                    $(vars.prev_thumb).click(function () {
                        api.prevSlide();
                    });
                }

                $(vars.play_button).click(function () {
                    api.playToggle();
                    return false;
                });


                /* Thumbnail Mouse Scrub
			----------------------------*/
                if (api.options.mouse_scrub) {
                    $(vars.thumb_tray).mousemove(function (e) {
                        var containerWidth = $(vars.thumb_tray).width(),
                            listWidth = $(vars.thumb_list).width();
                        if (listWidth > containerWidth) {
                            var mousePos = 1,
                                diff = e.pageX - mousePos;
                            if (diff > 10 || diff < -10) {
                                mousePos = e.pageX;
                                newX = (containerWidth - listWidth) * (e.pageX / containerWidth);
                                diff = parseInt(Math.abs(parseInt($(vars.thumb_list).css('left')) - newX)).toFixed(0);
                                $(vars.thumb_list).stop().animate({
                                    'left': newX
                                }, {
                                    duration: diff * 3,
                                    easing: 'easeOutExpo'
                                });
                            }
                        }
                    });
                }


                /* Window Resize
			----------------------------*/
                $(window).resize(function () {

                    // Delay progress bar on resize
                    if (api.options.progress_bar && !vars.in_animation) {
                        if (vars.slideshow_interval) clearInterval(vars.slideshow_interval);
                        if (api.options.slides.length - 1 > 0) clearInterval(vars.slideshow_interval);

                        $(vars.progress_bar).stop().animate({
                            height: 0
                        }, 100, 'easeOutQuad');

                        if (!vars.progressDelay && api.options.slideshow) {
                            // Delay slideshow from resuming so Chrome can refocus images
                            vars.progressDelay = setTimeout(function () {
                                if (!vars.is_paused) {
                                    theme.progressBar();
                                    vars.slideshow_interval = setInterval(api.nextSlide, api.options.slide_interval);
                                }
                                vars.progressDelay = false;
                            }, 1000);
                        }
                    }

                    // Thumb Links
                    if (api.options.thumb_links && vars.thumb_tray.length) {
                        // Update Thumb Interval & Page
                        vars.thumb_page = 0;
                        vars.thumb_interval = Math.floor($(vars.thumb_tray).width() / $('> li', vars.thumb_list).outerWidth(true)) * $('> li', vars.thumb_list).outerWidth(true);

                        // Adjust thumbnail markers
                        if ($(vars.thumb_list).width() > $(vars.thumb_tray).width()) {
                            $(vars.thumb_back + ',' + vars.thumb_forward).fadeIn('fast');
                            $(vars.thumb_list).stop().animate({
                                'left': 0
                            }, 200);
                        } else {
                            $(vars.thumb_back + ',' + vars.thumb_forward).fadeOut('fast');
                        }

                    }
                });

                firstInit = false;

            }


        },


        /* Go To Slide
		----------------------------*/
        goTo: function () {
            if (api.options.progress_bar && !vars.is_paused) {
                $(vars.progress_bar).stop().animate({
                    left: -$(window).width()
                }, 0);
                theme.progressBar();
            }
        },

        /* Play & Pause Toggle
		----------------------------*/
        playToggle: function (state) {


            if (state == 'play') {
                // If image, swap to pause
                $('#playPause').removeClass('paused');
                if (api.options.progress_bar && !vars.is_paused) theme.progressBar();
            } else if (state == 'pause') {
                // If image, swap to play
                $('#playPause').addClass('paused');
                if (api.options.progress_bar && vars.is_paused) $(vars.progress_bar).stop().animate({
                    height: 0
                }, 100, 'easeOutQuad');
            }

        },


        /* Before Slide Transition
		----------------------------*/
        beforeAnimation: function (direction) {
            if (api.options.progress_bar && !vars.is_paused)
                $(vars.progress_bar).stop().animate({
                    height: 0
                }, 200, 'easeOutQuad');

            /* Update Fields
		  	----------------------------*/
            // Update slide caption
            if ($(vars.slide_caption).length) {
                (api.getField('title')) ? $(vars.slide_caption).html(api.getField('title')) : $(vars.slide_caption).html('');
            }
            // Update slide number
            if (vars.slide_current.length) {
                $(vars.slide_current).html(vars.current_slide + 1);
            }


            // Highlight current thumbnail and adjust row position
            if (api.options.thumb_links) {

                $('.current-thumb').removeClass('current-thumb');
                $('li', vars.thumb_list).eq(vars.current_slide).addClass('current-thumb');

                // If thumb out of view
                if ($(vars.thumb_list).width() > $(vars.thumb_tray).width()) {
                    // If next slide direction
                    if (direction == 'next') {
                        if (vars.current_slide == 0) {
                            vars.thumb_page = 0;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        } else if ($('.current-thumb').offset().left - $(vars.thumb_tray).offset().left >= vars.thumb_interval) {
                            vars.thumb_page = vars.thumb_page - vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        }
                        // If previous slide direction
                    } else if (direction == 'prev') {
                        if (vars.current_slide == api.options.slides.length - 1) {
                            vars.thumb_page = Math.floor($(vars.thumb_list).width() / vars.thumb_interval) * -vars.thumb_interval;
                            if ($(vars.thumb_list).width() <= -vars.thumb_page) vars.thumb_page = vars.thumb_page + vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        } else if ($('.current-thumb').offset().left - $(vars.thumb_tray).offset().left < 0) {
                            if (vars.thumb_page + vars.thumb_interval > 0) return false;
                            vars.thumb_page = vars.thumb_page + vars.thumb_interval;
                            $(vars.thumb_list).stop().animate({
                                'left': vars.thumb_page
                            }, {
                                duration: 500,
                                easing: 'easeOutExpo'
                            });
                        }
                    }
                }


            }

        },


        /* After Slide Transition
		----------------------------*/
        afterAnimation: function () {
            if (api.options.progress_bar && !vars.is_paused) theme.progressBar(); //  Start progress bar
        },


        /* Progress Bar
		----------------------------*/
        progressBar: function () {
            $(vars.progress_bar).stop().animate({
                height: '100%'
            }, api.options.slide_interval, 'linear');
        }


    };


    /* Theme Specific Variables
	 ----------------------------*/
    $.supersized.themeVars = {

        // Internal Variables
        progress_delay: false, // Delay after resize before resuming slideshow
        thumb_page: false, // Thumbnail page
        thumb_interval: false, // Thumbnail interval
        image_path: 'img/', // Default image path

        // General Elements
        play_button: '#playPause', // Play/Pause button
        next_slide: '#nextslide', // Next slide button
        prev_slide: '#prevslide', // Prev slide button
        next_thumb: '#nextthumb', // Next slide thumb button
        prev_thumb: '#prevthumb', // Prev slide thumb button

        slide_caption: '#slidecaption', // Slide caption
        slide_current: '.slidenumber', // Current slide number
        slide_total: '.totalslides', // Total Slides
        slide_list: '#slideList', // Slide jump list

        thumb_tray: '#thumb-tray', // Thumbnail tray
        thumb_list: '#thumb-list', // Thumbnail list
        thumb_forward: '#thumb-forward', // Cycles forward through thumbnail list
        thumb_back: '#thumb-back', // Cycles backwards through thumbnail list
        tray_arrow: '#tray-arrow', // Thumbnail tray button arrow
        tray_button: '#tray-button', // Thumbnail tray button

        progress_bar: '#progressBar' // Progress bar

    };

    /* Theme Specific Options
	 ----------------------------*/
    $.supersized.themeOptions = {

        progress_bar: 1, // Timer for each slide
        mouse_scrub: 0 // Thumbnails move with mouse

    };


})(jQuery);

/*
 * jQuery Mobile Framework 1.1.0 db342b1f315c282692791aa870455901fdb46a55
 * http://jquerymobile.com
 *
 * Copyright 2011 (c) jQuery Project
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 */

/*
 * Stripped the touch swipe logic from jQuery Mobile and turned it into this plugin
 * Copyright 2012 (c) CodingJack - http://codecanyon.net/user/CodingJack
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/* USAGE

// listen both left and right signals, the String "left" or "right" will be passed as an argument to the callback
* $(element).touchSwipe(callback);

// second parameter is optional and will invoke "event.stopImmediatePropagation()"
// use this if you need to prevent other mouse events from firing on the same object when a swipe gesture is detected
* $(element).touchSwipe(callback, true);

// listen for only the left swipe event
* $(element).touchSwipeLeft(callback);

// listen for only the right swipe event
* $(element).touchSwipeRight(callback);

// unbind both left and right swipe events
* $(element).unbindSwipe();

// unbind only left swipe event
* $(element).unbindSwipeLeft();

// unbind only right swipe event
* $(element).unbindSwipeRight();


// SPECIAL NOTES
* all methods return "this" for chaining
* before a plugin event is added, "unbind" is called first to make sure events are never erroneously duplicated

*/

(function ($) {

    var touchStopEvent, touchMoveEvent, touchStartEvent,
        horizontalDistanceThreshold = 30,
        verticalDistanceThreshold = 75,
        scrollSupressionThreshold = 10,
        durationThreshold = 1000;

    if ("ontouchend" in document) {

        touchStopEvent = "touchend.cj_swp";
        touchMoveEvent = "touchmove.cj_swp";
        touchStartEvent = "touchstart.cj_swp";

    } else {

        touchStopEvent = "mouseup.cj_swp";
        touchMoveEvent = "mousemove.cj_swp";
        touchStartEvent = "mousedown.cj_swp";

    }

    $.fn.touchSwipe = function (cb, prevent) {

        if (prevent) this.data("stopPropagation", true);
        if (cb) return this.each(swipeBoth, [cb]);

    }

    $.fn.touchSwipeLeft = function (cb, prevent) {

        if (prevent) this.data("stopPropagation", true);
        if (cb) return this.each(swipeLeft, [cb]);

    }

    $.fn.touchSwipeRight = function (cb, prevent) {

        if (prevent) this.data("stopPropagation", true);
        if (cb) return this.each(swipeRight, [cb]);

    }

    function swipeBoth(cb) {

        $(this).touchSwipeLeft(cb).touchSwipeRight(cb);

    }

    function swipeLeft(cb) {

        var $this = $(this);

        if (!$this.data("swipeLeft")) $this.data("swipeLeft", cb);

        if (!$this.data("swipeRight")) addSwipe($this);

    }

    function swipeRight(cb) {

        var $this = $(this);

        if (!$this.data("swipeRight")) $this.data("swipeRight", cb);

        if (!$this.data("swipeLeft")) addSwipe($this);

    }

    $.fn.unbindSwipeLeft = function () {

        this.removeData("swipeLeft");

        if (!this.data("swipeRight")) this.unbindSwipe(true);

    }

    $.fn.unbindSwipeRight = function () {

        this.removeData("swipeRight");

        if (!this.data("swipeLeft")) this.unbindSwipe(true);

    }

    $.fn.unbindSwipe = function (changeData) {

        if (!changeData) this.removeData("swipeLeft swipeRight stopPropagation");

        return this.unbind(touchStartEvent + " " + touchMoveEvent + " " + touchStopEvent);

    }

    function addSwipe($this) {

        $this.unbindSwipe(true).bind(touchStartEvent, touchStart);

    }

    function touchStart(event) {

        var time = new Date().getTime(),
            data = event.originalEvent.touches ? event.originalEvent.touches[0] : event,
            $this = $(this).bind(touchMoveEvent, moveHandler).one(touchStopEvent, touchEnded),
            pageX = data.pageX,
            pageY = data.pageY,
            newPageX,
            newPageY,
            newTime;

        if ($this.data("stopPropagation")) event.stopImmediatePropagation();

        function touchEnded(event) {

            $this.unbind(touchMoveEvent);

            if (time && newTime) {

                if (newTime - time < durationThreshold && Math.abs(pageX - newPageX) > horizontalDistanceThreshold && Math.abs(pageY - newPageY) < verticalDistanceThreshold) {

                    if (pageX > newPageX) {

                        if ($this.data("swipeLeft")) $this.data("swipeLeft")("left");

                    } else {

                        if ($this.data("swipeRight")) $this.data("swipeRight")("right");

                    }

                }

            }

            time = newTime = null;

        }

        function moveHandler(event) {

            if (time) {

                data = event.originalEvent.touches ? event.originalEvent.touches[0] : event;
                newTime = new Date().getTime();
                newPageX = data.pageX;
                newPageY = data.pageY;

                if (Math.abs(pageX - newPageX) > scrollSupressionThreshold) event.preventDefault();

            }

        }

    }

})(jQuery);

// Generated by CoffeeScript 1.3.3

(function ($, window, document) {
    "use strict";

    var BROWSER_IS_IE7, BROWSER_SCROLLBAR_WIDTH, DOMSCROLL, DOWN, DRAG, MOUSEDOWN, MOUSEMOVE, MOUSEUP, MOUSEWHEEL, NanoScroll, PANEDOWN, RESIZE, SCROLL, SCROLLBAR, TOUCHMOVE, UP, WHEEL, defaults, getBrowserScrollbarWidth;
    defaults = {
        paneClass: 'pane',
        sliderClass: 'slider',
        sliderMinHeight: 20,
        contentClass: 'content',
        iOSNativeScrolling: false,
        preventPageScrolling: false,
        disableResize: false
    };
    SCROLLBAR = 'scrollbar';
    SCROLL = 'scroll';
    MOUSEDOWN = 'mousedown';
    MOUSEMOVE = 'mousemove';
    MOUSEWHEEL = 'mousewheel';
    MOUSEUP = 'mouseup';
    RESIZE = 'resize';
    DRAG = 'drag';
    UP = 'up';
    PANEDOWN = 'panedown';
    DOMSCROLL = 'DOMMouseScroll';
    DOWN = 'down';
    WHEEL = 'wheel';
    TOUCHMOVE = 'touchmove';
    BROWSER_IS_IE7 = window.navigator.appName === 'Microsoft Internet Explorer' && /msie 7./i.test(window.navigator.appVersion) && window.ActiveXObject;
    BROWSER_SCROLLBAR_WIDTH = null;
    getBrowserScrollbarWidth = function () {
        var outer, outerStyle, scrollbarWidth;
        outer = document.createElement('div');
        outerStyle = outer.style;
        outerStyle.position = 'absolute';
        outerStyle.width = '100px';
        outerStyle.height = '100px';
        outerStyle.overflow = SCROLL;
        outerStyle.top = '-9999px';
        document.body.appendChild(outer);
        scrollbarWidth = outer.offsetWidth - outer.clientWidth;
        document.body.removeChild(outer);
        return scrollbarWidth;
    };
    NanoScroll = (function () {

        function NanoScroll(el, options) {
            this.options = options;
            BROWSER_SCROLLBAR_WIDTH || (BROWSER_SCROLLBAR_WIDTH = getBrowserScrollbarWidth());
            this.el = $(el);
            this.doc = $(document);
            this.win = $(window);
            this.generate();
            this.createEvents();
            this.addEvents();
            this.reset();
        }

        NanoScroll.prototype.preventScrolling = function (e, direction) {
            switch (e.type) {
            case DOMSCROLL:
                if (direction === DOWN && e.originalEvent.detail > 0 || direction === UP && e.originalEvent.detail < 0) {
                    e.preventDefault();
                }
                break;
            case MOUSEWHEEL:
                if (!e.originalEvent) {
                    return;
                }
                if (!e.originalEvent.wheelDelta) {
                    return;
                }
                if (direction === DOWN && e.originalEvent.wheelDelta < 0 || direction === UP && e.originalEvent.wheelDelta > 0) {
                    e.preventDefault();
                }
            }
        };

        NanoScroll.prototype.createEvents = function () {
            var _this = this;
            this.events = {
                down: function (e) {
                    _this.isBeingDragged = true;
                    _this.offsetY = e.clientY - _this.slider.offset().top;
                    _this.pane.addClass('active');
                    _this.doc.bind(MOUSEMOVE, _this.events[DRAG]).bind(MOUSEUP, _this.events[UP]);
                    return false;
                },
                drag: function (e) {
                    _this.sliderY = e.clientY - _this.el.offset().top - _this.offsetY;
                    _this.scroll();
                    return false;
                },
                up: function (e) {
                    _this.isBeingDragged = false;
                    _this.pane.removeClass('active');
                    _this.doc.unbind(MOUSEMOVE, _this.events[DRAG]).unbind(MOUSEUP, _this.events[UP]);
                    return false;
                },
                resize: function (e) {
                    _this.reset();
                },
                panedown: function (e) {
                    _this.sliderY = e.offsetY - (_this.sliderHeight * 0.5);
                    _this.scroll();
                    _this.events.down(e);
                    return false;
                },
                scroll: function (e) {
                    var maxScrollTop, maxSliderTop, scrollTop, sliderTop;
                    if (_this.isBeingDragged) {
                        return;
                    }
                    maxScrollTop = _this.content[0].scrollHeight - _this.content[0].clientHeight;
                    scrollTop = _this.content[0].scrollTop;
                    maxSliderTop = _this.paneHeight - _this.sliderHeight;
                    sliderTop = scrollTop * maxSliderTop / maxScrollTop;
                    _this.slider.css({
                        top: sliderTop
                    });
                    if (e == null) {
                        return;
                    }
                    if (scrollTop >= maxScrollTop) {
                        if (_this.options.preventPageScrolling) {
                            _this.preventScrolling(e, DOWN);
                        }
                        _this.el.trigger('scrollend');
                    } else if (scrollTop === 0) {
                        if (_this.options.preventPageScrolling) {
                            _this.preventScrolling(e, UP);
                        }
                        _this.el.trigger('scrolltop');
                    }
                },
                wheel: function (e) {
                    if (e == null) {
                        return;
                    }
                    _this.sliderY += -e.wheelDeltaY || -e.delta;
                    _this.scroll();
                    return false;
                }
            };
        };

        NanoScroll.prototype.addEvents = function () {
            var events;
            events = this.events;
            if (!this.options.disableResize) {
                this.win.bind(RESIZE, events[RESIZE]);
            }
            this.slider.bind(MOUSEDOWN, events[DOWN]);
            this.pane.bind(MOUSEDOWN, events[PANEDOWN]).bind(MOUSEWHEEL, events[WHEEL]).bind(DOMSCROLL, events[WHEEL]);
            this.content.bind(MOUSEWHEEL, events[SCROLL]).bind(DOMSCROLL, events[SCROLL]).bind(TOUCHMOVE, events[SCROLL]);
        };

        NanoScroll.prototype.removeEvents = function () {
            var events;
            events = this.events;
            if (!this.options.disableResize) {
                this.win.unbind(RESIZE, events[RESIZE]);
            }
            this.slider.unbind(MOUSEDOWN, events[DOWN]);
            this.pane.unbind(MOUSEDOWN, events[PANEDOWN]).unbind(MOUSEWHEEL, events[WHEEL]).unbind(DOMSCROLL, events[WHEEL]);
            this.content.unbind(MOUSEWHEEL, events[SCROLL]).unbind(DOMSCROLL, events[SCROLL]).unbind(TOUCHMOVE, events[SCROLL]);
        };

        NanoScroll.prototype.generate = function () {
            var contentClass, cssRule, options, paneClass, sliderClass;
            options = this.options;
            paneClass = options.paneClass, sliderClass = options.sliderClass, contentClass = options.contentClass;
            this.el.append("<div class=\"" + paneClass + "\"><div class=\"" + sliderClass + "\" /></div>");
            this.content = $(this.el.children("." + contentClass)[0]);
            this.slider = this.el.find("." + sliderClass);
            this.pane = this.el.find("." + paneClass);
            if (BROWSER_SCROLLBAR_WIDTH) {
                cssRule = {
                    right: -BROWSER_SCROLLBAR_WIDTH
                };
                this.el.addClass('has-scrollbar');
            }
            if (options.iOSNativeScrolling) {
                if (cssRule == null) {
                    cssRule = {};
                }
                cssRule.WebkitOverflowScrolling = 'touch';
            }
            if (cssRule != null) {
                this.content.css(cssRule);
            }
            return this;
        };

        NanoScroll.prototype.elementsExist = function () {
            return this.el.find("." + this.options.paneClass).length;
        };

        NanoScroll.prototype.restore = function () {
            this.stopped = false;
            this.pane.show();
            return this.addEvents();
        };

        NanoScroll.prototype.reset = function () {
            var content, contentHeight, contentStyle, contentStyleOverflowY, maxSliderTop, paneBottom, paneHeight, paneOuterHeight, paneTop, sliderHeight, sliderMinHeight;
            if (!this.elementsExist()) {
                this.generate().stop();
            }
            if (this.stopped) {
                this.restore();
            }
            content = this.content[0];
            contentStyle = content.style;
            contentStyleOverflowY = contentStyle.overflowY;
            if (BROWSER_IS_IE7) {
                this.content.css({
                    height: this.content.height()
                });
            }
            contentHeight = content.scrollHeight + BROWSER_SCROLLBAR_WIDTH;
            paneHeight = this.pane.outerHeight();
            paneTop = parseInt(this.pane.css('top'), 10);
            paneBottom = parseInt(this.pane.css('bottom'), 10);
            paneOuterHeight = paneHeight + paneTop + paneBottom;
            sliderMinHeight = this.options.sliderMinHeight;
            sliderHeight = Math.round(paneOuterHeight / contentHeight * paneOuterHeight);
            sliderHeight = sliderHeight > this.options.sliderMinHeight ? sliderHeight : this.options.sliderMinHeight;
            if (contentStyleOverflowY === SCROLL && contentStyle.overflowX !== SCROLL) {
                sliderHeight += BROWSER_SCROLLBAR_WIDTH;
            }
            maxSliderTop = paneOuterHeight - sliderHeight;
            this.contentHeight = contentHeight;
            this.paneHeight = paneHeight;
            this.paneOuterHeight = paneOuterHeight;
            this.sliderHeight = sliderHeight;
            this.maxSliderTop = maxSliderTop;
            this.slider.height(sliderHeight);
            this.events.scroll();
            this.pane.show();
            if (this.paneOuterHeight >= content.scrollHeight && contentStyleOverflowY !== SCROLL) {
                this.pane.hide();
            } else if (this.el.height() === content.scrollHeight && contentStyleOverflowY === SCROLL) {
                this.slider.hide();
            } else {
                this.slider.show();
            }
            return this;
        };

        NanoScroll.prototype.scroll = function () {
            this.sliderY = Math.max(0, this.sliderY);
            this.sliderY = Math.min(this.maxSliderTop, this.sliderY);
            this.content.scrollTop((this.paneHeight - this.contentHeight + BROWSER_SCROLLBAR_WIDTH) * this.sliderY / this.maxSliderTop * -1);
            this.slider.css({
                top: this.sliderY
            });
            return this;
        };

        NanoScroll.prototype.scrollBottom = function (offsetY) {
            this.reset();
            this.content.scrollTop(this.contentHeight - this.content.height() - offsetY).trigger(MOUSEWHEEL);
            return this;
        };

        NanoScroll.prototype.scrollTop = function (offsetY) {
            this.reset();
            this.content.scrollTop(+offsetY).trigger(MOUSEWHEEL);
            return this;
        };

        NanoScroll.prototype.scrollTo = function (node) {
            var fraction, new_slider, offset;
            this.reset();
            offset = $(node).offset().top;
            if (offset > this.maxSliderTop) {
                fraction = offset / this.contentHeight;
                new_slider = this.maxSliderTop * fraction;
                this.sliderY = new_slider;
                this.scroll();
            }
            return this;
        };

        NanoScroll.prototype.stop = function () {
            this.stopped = true;
            this.removeEvents();
            this.pane.hide();
            return this;
        };

        return NanoScroll;

    })();
    $.fn.nanoScroller = function (settings) {
        var options, scroll, scrollBottom, scrollTo, scrollTop, stop;
        if (settings != null) {
            scrollBottom = settings.scrollBottom, scrollTop = settings.scrollTop, scrollTo = settings.scrollTo, scroll = settings.scroll, stop = settings.stop;
        }
        options = $.extend({}, defaults, settings);
        this.each(function () {
            var me, scrollbar;
            me = this;
            scrollbar = $.data(me, SCROLLBAR);
            if (!scrollbar) {
                scrollbar = new NanoScroll(me, options);
                $.data(me, SCROLLBAR, scrollbar);
            } else {
                $.extend(scrollbar.options, settings);
            }
            if (scrollBottom) {
                return scrollbar.scrollBottom(scrollBottom);
            }
            if (scrollTop) {
                return scrollbar.scrollTop(scrollTop);
            }
            if (scrollTo) {
                return scrollbar.scrollTo(scrollTo);
            }
            if (scroll === 'bottom') {
                return scrollbar.scrollBottom(0);
            }
            if (scroll === 'top') {
                return scrollbar.scrollTop(0);
            }
            if (scroll instanceof $) {
                return scrollbar.scrollTo(scroll);
            }
            if (stop) {
                return scrollbar.stop();
            }
            return scrollbar.reset();
        });
    };
})(jQuery, window, document);

/*
 * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/
 *
 * Uses the built in easing capabilities added In jQuery 1.1
 * to offer multiple easing options
 *
 * TERMS OF USE - jQuery Easing
 *
 * Open source under the BSD License.
 *
 * Copyright © 2008 George McGinley Smith
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * Neither the name of the author nor the names of contributors may be used to endorse
 * or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */

// t: current time, b: begInnIng value, c: change In value, d: duration
jQuery.easing['jswing'] = jQuery.easing['swing'];

jQuery.extend(jQuery.easing, {
    def: 'easeOutQuad',
    swing: function (x, t, b, c, d) {
        //alert(jQuery.easing.default);
        return jQuery.easing[jQuery.easing.def](x, t, b, c, d);
    },
    easeInQuad: function (x, t, b, c, d) {
        return c * (t /= d) * t + b;
    },
    easeOutQuad: function (x, t, b, c, d) {
        return -c * (t /= d) * (t - 2) + b;
    },
    easeInOutQuad: function (x, t, b, c, d) {
        if ((t /= d / 2) < 1) return c / 2 * t * t + b;
        return -c / 2 * ((--t) * (t - 2) - 1) + b;
    },
    easeInCubic: function (x, t, b, c, d) {
        return c * (t /= d) * t * t + b;
    },
    easeOutCubic: function (x, t, b, c, d) {
        return c * ((t = t / d - 1) * t * t + 1) + b;
    },
    easeInOutCubic: function (x, t, b, c, d) {
        if ((t /= d / 2) < 1) return c / 2 * t * t * t + b;
        return c / 2 * ((t -= 2) * t * t + 2) + b;
    },
    easeInQuart: function (x, t, b, c, d) {
        return c * (t /= d) * t * t * t + b;
    },
    easeOutQuart: function (x, t, b, c, d) {
        return -c * ((t = t / d - 1) * t * t * t - 1) + b;
    },
    easeInOutQuart: function (x, t, b, c, d) {
        if ((t /= d / 2) < 1) return c / 2 * t * t * t * t + b;
        return -c / 2 * ((t -= 2) * t * t * t - 2) + b;
    },
    easeInQuint: function (x, t, b, c, d) {
        return c * (t /= d) * t * t * t * t + b;
    },
    easeOutQuint: function (x, t, b, c, d) {
        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;
    },
    easeInOutQuint: function (x, t, b, c, d) {
        if ((t /= d / 2) < 1) return c / 2 * t * t * t * t * t + b;
        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;
    },
    easeInSine: function (x, t, b, c, d) {
        return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;
    },
    easeOutSine: function (x, t, b, c, d) {
        return c * Math.sin(t / d * (Math.PI / 2)) + b;
    },
    easeInOutSine: function (x, t, b, c, d) {
        return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;
    },
    easeInExpo: function (x, t, b, c, d) {
        return (t == 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;
    },
    easeOutExpo: function (x, t, b, c, d) {
        return (t == d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;
    },
    easeInOutExpo: function (x, t, b, c, d) {
        if (t == 0) return b;
        if (t == d) return b + c;
        if ((t /= d / 2) < 1) return c / 2 * Math.pow(2, 10 * (t - 1)) + b;
        return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;
    },
    easeInCirc: function (x, t, b, c, d) {
        return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;
    },
    easeOutCirc: function (x, t, b, c, d) {
        return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;
    },
    easeInOutCirc: function (x, t, b, c, d) {
        if ((t /= d / 2) < 1) return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;
        return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;
    },
    easeInElastic: function (x, t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d) == 1) return b + c;
        if (!p) p = d * .3;
        if (a < Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else var s = p / (2 * Math.PI) * Math.asin(c / a);
        return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
    },
    easeOutElastic: function (x, t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d) == 1) return b + c;
        if (!p) p = d * .3;
        if (a < Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else var s = p / (2 * Math.PI) * Math.asin(c / a);
        return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;
    },
    easeInOutElastic: function (x, t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d / 2) == 2) return b + c;
        if (!p) p = d * (.3 * 1.5);
        if (a < Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else var s = p / (2 * Math.PI) * Math.asin(c / a);
        if (t < 1) return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
        return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * .5 + c + b;
    },
    easeInBack: function (x, t, b, c, d, s) {
        if (s == undefined) s = 1.70158;
        return c * (t /= d) * t * ((s + 1) * t - s) + b;
    },
    easeOutBack: function (x, t, b, c, d, s) {
        if (s == undefined) s = 1.70158;
        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;
    },
    easeInOutBack: function (x, t, b, c, d, s) {
        if (s == undefined) s = 1.70158;
        if ((t /= d / 2) < 1) return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;
        return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;
    },
    easeInBounce: function (x, t, b, c, d) {
        return c - jQuery.easing.easeOutBounce(x, d - t, 0, c, d) + b;
    },
    easeOutBounce: function (x, t, b, c, d) {
        if ((t /= d) < (1 / 2.75)) {
            return c * (7.5625 * t * t) + b;
        } else if (t < (2 / 2.75)) {
            return c * (7.5625 * (t -= (1.5 / 2.75)) * t + .75) + b;
        } else if (t < (2.5 / 2.75)) {
            return c * (7.5625 * (t -= (2.25 / 2.75)) * t + .9375) + b;
        } else {
            return c * (7.5625 * (t -= (2.625 / 2.75)) * t + .984375) + b;
        }
    },
    easeInOutBounce: function (x, t, b, c, d) {
        if (t < d / 2) return jQuery.easing.easeInBounce(x, t * 2, 0, c, d) * .5 + b;
        return jQuery.easing.easeOutBounce(x, t * 2 - d, 0, c, d) * .5 + c * .5 + b;
    }
});

/*
 *
 * TERMS OF USE - EASING EQUATIONS
 *
 * Open source under the BSD License.
 *
 * Copyright © 2001 Robert Penner
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list
 * of conditions and the following disclaimer in the documentation and/or other materials
 * provided with the distribution.
 *
 * Neither the name of the author nor the names of contributors may be used to endorse
 * or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */
/**!
 * @preserve Color animation 20120928
 * http://www.bitstorm.org/jquery/color-animation/
 * Copyright 2011, 2012 Edwin Martin <edwin@bitstorm.org>
 * Released under the MIT and GPL licenses.
 */

(function ($) {
    /**
     * Check whether the browser supports RGBA color mode.
     *
     * Author Mehdi Kabab <http://pioupioum.fr>
     * @return {boolean} True if the browser support RGBA. False otherwise.
     */
    function isRGBACapable() {
        var $script = $('script:first'),
            color = $script.css('color'),
            result = false;
        if (/^rgba/.test(color)) {
            result = true;
        } else {
            try {
                result = (color != $script.css('color', 'rgba(0, 0, 0, 0.5)').css('color'));
                $script.css('color', color);
            } catch (e) {}
        }

        return result;
    }

    $.extend(true, $, {
        support: {
            'rgba': isRGBACapable()
        }
    });

    var properties = ['color', 'backgroundColor', 'borderBottomColor', 'borderLeftColor', 'borderRightColor', 'borderTopColor', 'outlineColor'];
    $.each(properties, function (i, property) {
        $.Tween.propHooks[property] = {
            get: function (tween) {
                return $(tween.elem).css(property);
            },
            set: function (tween) {
                var style = tween.elem.style;
                var p_begin = parseColor($(tween.elem).css(property));
                var p_end = parseColor(tween.end);
                tween.run = function (progress) {
                    style[property] = calculateColor(p_begin, p_end, progress);
                }
            }
        }
    });

    // borderColor doesn't fit in standard fx.step above.
    $.Tween.propHooks.borderColor = {
        set: function (tween) {
            var style = tween.elem.style;
            var p_begin = [];
            var borders = properties.slice(2, 6); // All four border properties
            $.each(borders, function (i, property) {
                p_begin[property] = parseColor($(tween.elem).css(property));
            });
            var p_end = parseColor(tween.end);
            tween.run = function (progress) {
                $.each(borders, function (i, property) {
                    style[property] = calculateColor(p_begin[property], p_end, progress);
                });
            }
        }
    }

    // Calculate an in-between color. Returns "#aabbcc"-like string.
    function calculateColor(begin, end, pos) {
        var color = 'rgb' + ($.support['rgba'] ? 'a' : '') + '(' + parseInt((begin[0] + pos * (end[0] - begin[0])), 10) + ',' + parseInt((begin[1] + pos * (end[1] - begin[1])), 10) + ',' + parseInt((begin[2] + pos * (end[2] - begin[2])), 10);
        if ($.support['rgba']) {
            color += ',' + (begin && end ? parseFloat(begin[3] + pos * (end[3] - begin[3])) : 1);
        }
        color += ')';
        return color;
    }

    // Parse an CSS-syntax color. Outputs an array [r, g, b]
    function parseColor(color) {
        var match, triplet;

        // Match #aabbcc
        if (match = /#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(color)) {
            triplet = [parseInt(match[1], 16), parseInt(match[2], 16), parseInt(match[3], 16), 1];

            // Match #abc
        } else if (match = /#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(color)) {
            triplet = [parseInt(match[1], 16) * 17, parseInt(match[2], 16) * 17, parseInt(match[3], 16) * 17, 1];

            // Match rgb(n, n, n)
        } else if (match = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)) {
            triplet = [parseInt(match[1]), parseInt(match[2]), parseInt(match[3]), 1];

        } else if (match = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(color)) {
            triplet = [parseInt(match[1], 10), parseInt(match[2], 10), parseInt(match[3], 10), parseFloat(match[4])];

            // No browser returns rgb(n%, n%, n%), so little reason to support this format.
        }
        return triplet;
    }
})(jQuery);
/*!
 * hoverFadeC0 v1.1
 * http://www.roslindesign.com
 *
 * Copyright 2011, Alex Urquhart-Taylor
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 */

(function ($) {
    $.fn.hoverFadeColor = function (settings) {
        var config = {
            'color': null,
            'fadeToSpeed': 300,
            'fadeFromSpeed': 300
        };

        if (settings)
            $.extend(config, settings);

        this.each(function () {
            var originalColor = $(this).css("color");
            var hovercolor = config.color;

            $(this).hover(function () {

                hoverElem = this;
                if (hovercolor == null && $.browser.msie && $.browser.version.substr(0, 1) < 9) {

                    setTimeout(function () {
                        if (hovercolor == null) {
                            hovercolor = $(hoverElem).css("color");
                        }

                        $(hoverElem).css('color', originalColor);

                        $(hoverElem).stop().animate({
                            color: hovercolor
                        }, config.fadeToSpeed);
                    }, 0);
                } else {
                    if (hovercolor == null) {
                        hovercolor = $(hoverElem).css("color");
                    }

                    $(hoverElem).css('color', originalColor);

                    $(hoverElem).stop().animate({
                        color: hovercolor
                    }, config.fadeToSpeed);
                }
            }, function () {
                if( $(hoverElem) === 'undefined' ) {

                } else {
                    $(hoverElem).stop().animate({
                        color: originalColor
                    }, config.fadeFromSpeed);
                }
            });
        });
        return this;
    };
})(jQuery);


(function ($) {
    var methods = {
        init: function (options) {
            var settings = {
                color: $(this).css("background-color"),
                reach: 20,
                speed: 1000,
                pause: 0,
                glow: true,
                repeat: true,
                onHover: false
            };
            $(this).css({
                "-moz-outline-radius": $(this).css("border-top-left-radius"),
                "-webkit-outline-radius": $(this).css("border-top-left-radius"),
                "outline-radius": $(this).css("border-top-left-radius")
            });

            if (options) {
                $.extend(settings, options);
            }
            settings.color = $("<div style='background:" + settings.color + "'></div>").css("background-color");
            if (settings.repeat !== true && !isNaN(settings.repeat) && settings.repeat > 0) {
                settings.repeat -= 1;
            }

            return this.each(function () {
                if (settings.onHover) {
                    $(this).bind("mouseover", function () {
                        pulse(settings, this, 0);
                    })
                        .bind("mouseout", function () {
                            $(this).pulsate("destroy");
                        });
                } else {
                    pulse(settings, this, 0);
                }
            });
        },
        destroy: function () {
            return this.each(function () {
                clearTimeout(this.timer);
                $(this).css("outline", 0);
            });
        }
    };

    var pulse = function (options, el, count) {
        var reach = options.reach,
            count = count > reach ? 0 : count,
            opacity = (reach - count) / reach,
            colorarr = options.color.split(","),
            color = "rgba(" + colorarr[0].split("(")[1] + "," + colorarr[1] + "," + colorarr[2].split(")")[0] + "," + opacity + ")",
            cssObj = {
                "outline": "2px solid " + color
            };
        if (options.glow) {
            cssObj["box-shadow"] = "0px 0px " + parseInt((count / 1.5)) + "px " + color;
            if ($.browser.webkit) {
                cssObj["outline-offset"] = count + "px";
                cssObj["outline-radius"] = "100 px";
            }
        } else {
            cssObj["outline-offset"] = count + "px";
        }
        $(el).css(cssObj);

        var innerfunc = function () {
            if (count >= reach && !options.repeat) {
                $(el).pulse("destroy");
                return false;
            } else if (count >= reach && options.repeat !== true && !isNaN(options.repeat) && options.repeat > 0) {
                options.repeat = options.repeat - 1;
            } else if (options.pause && count >= reach) {
                pause(options, el, count + 1);
                return false;
            }
            pulse(options, el, count + 1);
        };

        el.timer = setTimeout(innerfunc, options.speed / reach);
    };

    var pause = function (options, el, count) {
        innerfunc = function () {
            pulse(options, el, count);
        };
        setTimeout(innerfunc, options.pause);
    };

    $.fn.pulsate = function (method) {
        // Method calling logic
        if (methods[method]) {
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        } else if (typeof method === 'object' || !method) {
            return methods.init.apply(this, arguments);
        } else {
            $.error('Method ' + method + ' does not exist on jQuery.pulsate');
        }

    };
})(jQuery);
